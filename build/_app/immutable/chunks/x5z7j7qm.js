import{c as qr,g as Iu,_ as Ou,a as Ru}from"./CX5sgC6p.js";const V0=!1;function Ja(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(r=Ja(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function $0(){for(var e,t,r=0,n="",i=arguments.length;r<i;r++)(e=arguments[r])&&(t=Ja(e))&&(n&&(n+=" "),n+=t);return n}var Qa={},wn={};wn.byteLength=Pu;wn.toByteArray=Cu;wn.fromByteArray=$u;var Pt=[],ht=[],Uu=typeof Uint8Array<"u"?Uint8Array:Array,qi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Tr=0,Fu=qi.length;Tr<Fu;++Tr)Pt[Tr]=qi[Tr],ht[qi.charCodeAt(Tr)]=Tr;ht[45]=62;ht[95]=63;function eo(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");r===-1&&(r=t);var n=r===t?0:4-r%4;return[r,n]}function Pu(e){var t=eo(e),r=t[0],n=t[1];return(r+n)*3/4-n}function ku(e,t,r){return(t+r)*3/4-r}function Cu(e){var t,r=eo(e),n=r[0],i=r[1],o=new Uu(ku(e,n,i)),d=0,c=i>0?n-4:n,w;for(w=0;w<c;w+=4)t=ht[e.charCodeAt(w)]<<18|ht[e.charCodeAt(w+1)]<<12|ht[e.charCodeAt(w+2)]<<6|ht[e.charCodeAt(w+3)],o[d++]=t>>16&255,o[d++]=t>>8&255,o[d++]=t&255;return i===2&&(t=ht[e.charCodeAt(w)]<<2|ht[e.charCodeAt(w+1)]>>4,o[d++]=t&255),i===1&&(t=ht[e.charCodeAt(w)]<<10|ht[e.charCodeAt(w+1)]<<4|ht[e.charCodeAt(w+2)]>>2,o[d++]=t>>8&255,o[d++]=t&255),o}function Mu(e){return Pt[e>>18&63]+Pt[e>>12&63]+Pt[e>>6&63]+Pt[e&63]}function Vu(e,t,r){for(var n,i=[],o=t;o<r;o+=3)n=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(e[o+2]&255),i.push(Mu(n));return i.join("")}function $u(e){for(var t,r=e.length,n=r%3,i=[],o=16383,d=0,c=r-n;d<c;d+=o)i.push(Vu(e,d,d+o>c?c:d+o));return n===1?(t=e[r-1],i.push(Pt[t>>2]+Pt[t<<4&63]+"==")):n===2&&(t=(e[r-2]<<8)+e[r-1],i.push(Pt[t>>10]+Pt[t>>4&63]+Pt[t<<2&63]+"=")),i.join("")}var mn={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */mn.read=function(e,t,r,n,i){var o,d,c=i*8-n-1,w=(1<<c)-1,E=w>>1,A=-7,I=r?i-1:0,S=r?-1:1,N=e[t+I];for(I+=S,o=N&(1<<-A)-1,N>>=-A,A+=c;A>0;o=o*256+e[t+I],I+=S,A-=8);for(d=o&(1<<-A)-1,o>>=-A,A+=n;A>0;d=d*256+e[t+I],I+=S,A-=8);if(o===0)o=1-E;else{if(o===w)return d?NaN:(N?-1:1)*(1/0);d=d+Math.pow(2,n),o=o-E}return(N?-1:1)*d*Math.pow(2,o-n)};mn.write=function(e,t,r,n,i,o){var d,c,w,E=o*8-i-1,A=(1<<E)-1,I=A>>1,S=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,N=n?0:o-1,b=n?1:-1,j=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(c=isNaN(t)?1:0,d=A):(d=Math.floor(Math.log(t)/Math.LN2),t*(w=Math.pow(2,-d))<1&&(d--,w*=2),d+I>=1?t+=S/w:t+=S*Math.pow(2,1-I),t*w>=2&&(d++,w/=2),d+I>=A?(c=0,d=A):d+I>=1?(c=(t*w-1)*Math.pow(2,i),d=d+I):(c=t*Math.pow(2,I-1)*Math.pow(2,i),d=0));i>=8;e[r+N]=c&255,N+=b,c/=256,i-=8);for(d=d<<i|c,E+=i;E>0;e[r+N]=d&255,N+=b,d/=256,E-=8);e[r+N-b]|=j*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(e){const t=wn,r=mn,n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=c,e.SlowBuffer=K,e.INSPECT_MAX_BYTES=50;const i=2147483647;e.kMaxLength=i,c.TYPED_ARRAY_SUPPORT=o(),!c.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{const y=new Uint8Array(1),f={foo:function(){return 42}};return Object.setPrototypeOf(f,Uint8Array.prototype),Object.setPrototypeOf(y,f),y.foo()===42}catch{return!1}}Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}});function d(y){if(y>i)throw new RangeError('The value "'+y+'" is invalid for option "size"');const f=new Uint8Array(y);return Object.setPrototypeOf(f,c.prototype),f}function c(y,f,l){if(typeof y=="number"){if(typeof f=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return I(y)}return w(y,f,l)}c.poolSize=8192;function w(y,f,l){if(typeof y=="string")return S(y,f);if(ArrayBuffer.isView(y))return b(y);if(y==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof y);if(L(y,ArrayBuffer)||y&&L(y.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(L(y,SharedArrayBuffer)||y&&L(y.buffer,SharedArrayBuffer)))return j(y,f,l);if(typeof y=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const B=y.valueOf&&y.valueOf();if(B!=null&&B!==y)return c.from(B,f,l);const k=V(y);if(k)return k;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof y[Symbol.toPrimitive]=="function")return c.from(y[Symbol.toPrimitive]("string"),f,l);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof y)}c.from=function(y,f,l){return w(y,f,l)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array);function E(y){if(typeof y!="number")throw new TypeError('"size" argument must be of type number');if(y<0)throw new RangeError('The value "'+y+'" is invalid for option "size"')}function A(y,f,l){return E(y),y<=0?d(y):f!==void 0?typeof l=="string"?d(y).fill(f,l):d(y).fill(f):d(y)}c.alloc=function(y,f,l){return A(y,f,l)};function I(y){return E(y),d(y<0?0:W(y)|0)}c.allocUnsafe=function(y){return I(y)},c.allocUnsafeSlow=function(y){return I(y)};function S(y,f){if((typeof f!="string"||f==="")&&(f="utf8"),!c.isEncoding(f))throw new TypeError("Unknown encoding: "+f);const l=$(y,f)|0;let B=d(l);const k=B.write(y,f);return k!==l&&(B=B.slice(0,k)),B}function N(y){const f=y.length<0?0:W(y.length)|0,l=d(f);for(let B=0;B<f;B+=1)l[B]=y[B]&255;return l}function b(y){if(L(y,Uint8Array)){const f=new Uint8Array(y);return j(f.buffer,f.byteOffset,f.byteLength)}return N(y)}function j(y,f,l){if(f<0||y.byteLength<f)throw new RangeError('"offset" is outside of buffer bounds');if(y.byteLength<f+(l||0))throw new RangeError('"length" is outside of buffer bounds');let B;return f===void 0&&l===void 0?B=new Uint8Array(y):l===void 0?B=new Uint8Array(y,f):B=new Uint8Array(y,f,l),Object.setPrototypeOf(B,c.prototype),B}function V(y){if(c.isBuffer(y)){const f=W(y.length)|0,l=d(f);return l.length===0||y.copy(l,0,0,f),l}if(y.length!==void 0)return typeof y.length!="number"||Y(y.length)?d(0):N(y);if(y.type==="Buffer"&&Array.isArray(y.data))return N(y.data)}function W(y){if(y>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return y|0}function K(y){return+y!=y&&(y=0),c.alloc(+y)}c.isBuffer=function(f){return f!=null&&f._isBuffer===!0&&f!==c.prototype},c.compare=function(f,l){if(L(f,Uint8Array)&&(f=c.from(f,f.offset,f.byteLength)),L(l,Uint8Array)&&(l=c.from(l,l.offset,l.byteLength)),!c.isBuffer(f)||!c.isBuffer(l))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(f===l)return 0;let B=f.length,k=l.length;for(let D=0,H=Math.min(B,k);D<H;++D)if(f[D]!==l[D]){B=f[D],k=l[D];break}return B<k?-1:k<B?1:0},c.isEncoding=function(f){switch(String(f).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(f,l){if(!Array.isArray(f))throw new TypeError('"list" argument must be an Array of Buffers');if(f.length===0)return c.alloc(0);let B;if(l===void 0)for(l=0,B=0;B<f.length;++B)l+=f[B].length;const k=c.allocUnsafe(l);let D=0;for(B=0;B<f.length;++B){let H=f[B];if(L(H,Uint8Array))D+H.length>k.length?(c.isBuffer(H)||(H=c.from(H)),H.copy(k,D)):Uint8Array.prototype.set.call(k,H,D);else if(c.isBuffer(H))H.copy(k,D);else throw new TypeError('"list" argument must be an Array of Buffers');D+=H.length}return k};function $(y,f){if(c.isBuffer(y))return y.length;if(ArrayBuffer.isView(y)||L(y,ArrayBuffer))return y.byteLength;if(typeof y!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof y);const l=y.length,B=arguments.length>2&&arguments[2]===!0;if(!B&&l===0)return 0;let k=!1;for(;;)switch(f){case"ascii":case"latin1":case"binary":return l;case"utf8":case"utf-8":return a(y).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return l*2;case"hex":return l>>>1;case"base64":return T(y).length;default:if(k)return B?-1:a(y).length;f=(""+f).toLowerCase(),k=!0}}c.byteLength=$;function ie(y,f,l){let B=!1;if((f===void 0||f<0)&&(f=0),f>this.length||((l===void 0||l>this.length)&&(l=this.length),l<=0)||(l>>>=0,f>>>=0,l<=f))return"";for(y||(y="utf8");;)switch(y){case"hex":return ee(this,f,l);case"utf8":case"utf-8":return P(this,f,l);case"ascii":return G(this,f,l);case"latin1":case"binary":return J(this,f,l);case"base64":return R(this,f,l);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ge(this,f,l);default:if(B)throw new TypeError("Unknown encoding: "+y);y=(y+"").toLowerCase(),B=!0}}c.prototype._isBuffer=!0;function C(y,f,l){const B=y[f];y[f]=y[l],y[l]=B}c.prototype.swap16=function(){const f=this.length;if(f%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let l=0;l<f;l+=2)C(this,l,l+1);return this},c.prototype.swap32=function(){const f=this.length;if(f%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let l=0;l<f;l+=4)C(this,l,l+3),C(this,l+1,l+2);return this},c.prototype.swap64=function(){const f=this.length;if(f%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let l=0;l<f;l+=8)C(this,l,l+7),C(this,l+1,l+6),C(this,l+2,l+5),C(this,l+3,l+4);return this},c.prototype.toString=function(){const f=this.length;return f===0?"":arguments.length===0?P(this,0,f):ie.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(f){if(!c.isBuffer(f))throw new TypeError("Argument must be a Buffer");return this===f?!0:c.compare(this,f)===0},c.prototype.inspect=function(){let f="";const l=e.INSPECT_MAX_BYTES;return f=this.toString("hex",0,l).replace(/(.{2})/g,"$1 ").trim(),this.length>l&&(f+=" ... "),"<Buffer "+f+">"},n&&(c.prototype[n]=c.prototype.inspect),c.prototype.compare=function(f,l,B,k,D){if(L(f,Uint8Array)&&(f=c.from(f,f.offset,f.byteLength)),!c.isBuffer(f))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof f);if(l===void 0&&(l=0),B===void 0&&(B=f?f.length:0),k===void 0&&(k=0),D===void 0&&(D=this.length),l<0||B>f.length||k<0||D>this.length)throw new RangeError("out of range index");if(k>=D&&l>=B)return 0;if(k>=D)return-1;if(l>=B)return 1;if(l>>>=0,B>>>=0,k>>>=0,D>>>=0,this===f)return 0;let H=D-k,_e=B-l;const Te=Math.min(H,_e),xe=this.slice(k,D),Ee=f.slice(l,B);for(let Oe=0;Oe<Te;++Oe)if(xe[Oe]!==Ee[Oe]){H=xe[Oe],_e=Ee[Oe];break}return H<_e?-1:_e<H?1:0};function Z(y,f,l,B,k){if(y.length===0)return-1;if(typeof l=="string"?(B=l,l=0):l>2147483647?l=2147483647:l<-2147483648&&(l=-2147483648),l=+l,Y(l)&&(l=k?0:y.length-1),l<0&&(l=y.length+l),l>=y.length){if(k)return-1;l=y.length-1}else if(l<0)if(k)l=0;else return-1;if(typeof f=="string"&&(f=c.from(f,B)),c.isBuffer(f))return f.length===0?-1:q(y,f,l,B,k);if(typeof f=="number")return f=f&255,typeof Uint8Array.prototype.indexOf=="function"?k?Uint8Array.prototype.indexOf.call(y,f,l):Uint8Array.prototype.lastIndexOf.call(y,f,l):q(y,[f],l,B,k);throw new TypeError("val must be string, number or Buffer")}function q(y,f,l,B,k){let D=1,H=y.length,_e=f.length;if(B!==void 0&&(B=String(B).toLowerCase(),B==="ucs2"||B==="ucs-2"||B==="utf16le"||B==="utf-16le")){if(y.length<2||f.length<2)return-1;D=2,H/=2,_e/=2,l/=2}function Te(Ee,Oe){return D===1?Ee[Oe]:Ee.readUInt16BE(Oe*D)}let xe;if(k){let Ee=-1;for(xe=l;xe<H;xe++)if(Te(y,xe)===Te(f,Ee===-1?0:xe-Ee)){if(Ee===-1&&(Ee=xe),xe-Ee+1===_e)return Ee*D}else Ee!==-1&&(xe-=xe-Ee),Ee=-1}else for(l+_e>H&&(l=H-_e),xe=l;xe>=0;xe--){let Ee=!0;for(let Oe=0;Oe<_e;Oe++)if(Te(y,xe+Oe)!==Te(f,Oe)){Ee=!1;break}if(Ee)return xe}return-1}c.prototype.includes=function(f,l,B){return this.indexOf(f,l,B)!==-1},c.prototype.indexOf=function(f,l,B){return Z(this,f,l,B,!0)},c.prototype.lastIndexOf=function(f,l,B){return Z(this,f,l,B,!1)};function Q(y,f,l,B){l=Number(l)||0;const k=y.length-l;B?(B=Number(B),B>k&&(B=k)):B=k;const D=f.length;B>D/2&&(B=D/2);let H;for(H=0;H<B;++H){const _e=parseInt(f.substr(H*2,2),16);if(Y(_e))return H;y[l+H]=_e}return H}function re(y,f,l,B){return O(a(f,y.length-l),y,l,B)}function X(y,f,l,B){return O(u(f),y,l,B)}function de(y,f,l,B){return O(T(f),y,l,B)}function fe(y,f,l,B){return O(g(f,y.length-l),y,l,B)}c.prototype.write=function(f,l,B,k){if(l===void 0)k="utf8",B=this.length,l=0;else if(B===void 0&&typeof l=="string")k=l,B=this.length,l=0;else if(isFinite(l))l=l>>>0,isFinite(B)?(B=B>>>0,k===void 0&&(k="utf8")):(k=B,B=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const D=this.length-l;if((B===void 0||B>D)&&(B=D),f.length>0&&(B<0||l<0)||l>this.length)throw new RangeError("Attempt to write outside buffer bounds");k||(k="utf8");let H=!1;for(;;)switch(k){case"hex":return Q(this,f,l,B);case"utf8":case"utf-8":return re(this,f,l,B);case"ascii":case"latin1":case"binary":return X(this,f,l,B);case"base64":return de(this,f,l,B);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return fe(this,f,l,B);default:if(H)throw new TypeError("Unknown encoding: "+k);k=(""+k).toLowerCase(),H=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function R(y,f,l){return f===0&&l===y.length?t.fromByteArray(y):t.fromByteArray(y.slice(f,l))}function P(y,f,l){l=Math.min(y.length,l);const B=[];let k=f;for(;k<l;){const D=y[k];let H=null,_e=D>239?4:D>223?3:D>191?2:1;if(k+_e<=l){let Te,xe,Ee,Oe;switch(_e){case 1:D<128&&(H=D);break;case 2:Te=y[k+1],(Te&192)===128&&(Oe=(D&31)<<6|Te&63,Oe>127&&(H=Oe));break;case 3:Te=y[k+1],xe=y[k+2],(Te&192)===128&&(xe&192)===128&&(Oe=(D&15)<<12|(Te&63)<<6|xe&63,Oe>2047&&(Oe<55296||Oe>57343)&&(H=Oe));break;case 4:Te=y[k+1],xe=y[k+2],Ee=y[k+3],(Te&192)===128&&(xe&192)===128&&(Ee&192)===128&&(Oe=(D&15)<<18|(Te&63)<<12|(xe&63)<<6|Ee&63,Oe>65535&&Oe<1114112&&(H=Oe))}}H===null?(H=65533,_e=1):H>65535&&(H-=65536,B.push(H>>>10&1023|55296),H=56320|H&1023),B.push(H),k+=_e}return M(B)}const z=4096;function M(y){const f=y.length;if(f<=z)return String.fromCharCode.apply(String,y);let l="",B=0;for(;B<f;)l+=String.fromCharCode.apply(String,y.slice(B,B+=z));return l}function G(y,f,l){let B="";l=Math.min(y.length,l);for(let k=f;k<l;++k)B+=String.fromCharCode(y[k]&127);return B}function J(y,f,l){let B="";l=Math.min(y.length,l);for(let k=f;k<l;++k)B+=String.fromCharCode(y[k]);return B}function ee(y,f,l){const B=y.length;(!f||f<0)&&(f=0),(!l||l<0||l>B)&&(l=B);let k="";for(let D=f;D<l;++D)k+=oe[y[D]];return k}function ge(y,f,l){const B=y.slice(f,l);let k="";for(let D=0;D<B.length-1;D+=2)k+=String.fromCharCode(B[D]+B[D+1]*256);return k}c.prototype.slice=function(f,l){const B=this.length;f=~~f,l=l===void 0?B:~~l,f<0?(f+=B,f<0&&(f=0)):f>B&&(f=B),l<0?(l+=B,l<0&&(l=0)):l>B&&(l=B),l<f&&(l=f);const k=this.subarray(f,l);return Object.setPrototypeOf(k,c.prototype),k};function ae(y,f,l){if(y%1!==0||y<0)throw new RangeError("offset is not uint");if(y+f>l)throw new RangeError("Trying to access beyond buffer length")}c.prototype.readUintLE=c.prototype.readUIntLE=function(f,l,B){f=f>>>0,l=l>>>0,B||ae(f,l,this.length);let k=this[f],D=1,H=0;for(;++H<l&&(D*=256);)k+=this[f+H]*D;return k},c.prototype.readUintBE=c.prototype.readUIntBE=function(f,l,B){f=f>>>0,l=l>>>0,B||ae(f,l,this.length);let k=this[f+--l],D=1;for(;l>0&&(D*=256);)k+=this[f+--l]*D;return k},c.prototype.readUint8=c.prototype.readUInt8=function(f,l){return f=f>>>0,l||ae(f,1,this.length),this[f]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(f,l){return f=f>>>0,l||ae(f,2,this.length),this[f]|this[f+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(f,l){return f=f>>>0,l||ae(f,2,this.length),this[f]<<8|this[f+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(f,l){return f=f>>>0,l||ae(f,4,this.length),(this[f]|this[f+1]<<8|this[f+2]<<16)+this[f+3]*16777216},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(f,l){return f=f>>>0,l||ae(f,4,this.length),this[f]*16777216+(this[f+1]<<16|this[f+2]<<8|this[f+3])},c.prototype.readBigUInt64LE=pe(function(f){f=f>>>0,x(f,"offset");const l=this[f],B=this[f+7];(l===void 0||B===void 0)&&v(f,this.length-8);const k=l+this[++f]*2**8+this[++f]*2**16+this[++f]*2**24,D=this[++f]+this[++f]*2**8+this[++f]*2**16+B*2**24;return BigInt(k)+(BigInt(D)<<BigInt(32))}),c.prototype.readBigUInt64BE=pe(function(f){f=f>>>0,x(f,"offset");const l=this[f],B=this[f+7];(l===void 0||B===void 0)&&v(f,this.length-8);const k=l*2**24+this[++f]*2**16+this[++f]*2**8+this[++f],D=this[++f]*2**24+this[++f]*2**16+this[++f]*2**8+B;return(BigInt(k)<<BigInt(32))+BigInt(D)}),c.prototype.readIntLE=function(f,l,B){f=f>>>0,l=l>>>0,B||ae(f,l,this.length);let k=this[f],D=1,H=0;for(;++H<l&&(D*=256);)k+=this[f+H]*D;return D*=128,k>=D&&(k-=Math.pow(2,8*l)),k},c.prototype.readIntBE=function(f,l,B){f=f>>>0,l=l>>>0,B||ae(f,l,this.length);let k=l,D=1,H=this[f+--k];for(;k>0&&(D*=256);)H+=this[f+--k]*D;return D*=128,H>=D&&(H-=Math.pow(2,8*l)),H},c.prototype.readInt8=function(f,l){return f=f>>>0,l||ae(f,1,this.length),this[f]&128?(255-this[f]+1)*-1:this[f]},c.prototype.readInt16LE=function(f,l){f=f>>>0,l||ae(f,2,this.length);const B=this[f]|this[f+1]<<8;return B&32768?B|4294901760:B},c.prototype.readInt16BE=function(f,l){f=f>>>0,l||ae(f,2,this.length);const B=this[f+1]|this[f]<<8;return B&32768?B|4294901760:B},c.prototype.readInt32LE=function(f,l){return f=f>>>0,l||ae(f,4,this.length),this[f]|this[f+1]<<8|this[f+2]<<16|this[f+3]<<24},c.prototype.readInt32BE=function(f,l){return f=f>>>0,l||ae(f,4,this.length),this[f]<<24|this[f+1]<<16|this[f+2]<<8|this[f+3]},c.prototype.readBigInt64LE=pe(function(f){f=f>>>0,x(f,"offset");const l=this[f],B=this[f+7];(l===void 0||B===void 0)&&v(f,this.length-8);const k=this[f+4]+this[f+5]*2**8+this[f+6]*2**16+(B<<24);return(BigInt(k)<<BigInt(32))+BigInt(l+this[++f]*2**8+this[++f]*2**16+this[++f]*2**24)}),c.prototype.readBigInt64BE=pe(function(f){f=f>>>0,x(f,"offset");const l=this[f],B=this[f+7];(l===void 0||B===void 0)&&v(f,this.length-8);const k=(l<<24)+this[++f]*2**16+this[++f]*2**8+this[++f];return(BigInt(k)<<BigInt(32))+BigInt(this[++f]*2**24+this[++f]*2**16+this[++f]*2**8+B)}),c.prototype.readFloatLE=function(f,l){return f=f>>>0,l||ae(f,4,this.length),r.read(this,f,!0,23,4)},c.prototype.readFloatBE=function(f,l){return f=f>>>0,l||ae(f,4,this.length),r.read(this,f,!1,23,4)},c.prototype.readDoubleLE=function(f,l){return f=f>>>0,l||ae(f,8,this.length),r.read(this,f,!0,52,8)},c.prototype.readDoubleBE=function(f,l){return f=f>>>0,l||ae(f,8,this.length),r.read(this,f,!1,52,8)};function le(y,f,l,B,k,D){if(!c.isBuffer(y))throw new TypeError('"buffer" argument must be a Buffer instance');if(f>k||f<D)throw new RangeError('"value" argument is out of bounds');if(l+B>y.length)throw new RangeError("Index out of range")}c.prototype.writeUintLE=c.prototype.writeUIntLE=function(f,l,B,k){if(f=+f,l=l>>>0,B=B>>>0,!k){const _e=Math.pow(2,8*B)-1;le(this,f,l,B,_e,0)}let D=1,H=0;for(this[l]=f&255;++H<B&&(D*=256);)this[l+H]=f/D&255;return l+B},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(f,l,B,k){if(f=+f,l=l>>>0,B=B>>>0,!k){const _e=Math.pow(2,8*B)-1;le(this,f,l,B,_e,0)}let D=B-1,H=1;for(this[l+D]=f&255;--D>=0&&(H*=256);)this[l+D]=f/H&255;return l+B},c.prototype.writeUint8=c.prototype.writeUInt8=function(f,l,B){return f=+f,l=l>>>0,B||le(this,f,l,1,255,0),this[l]=f&255,l+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(f,l,B){return f=+f,l=l>>>0,B||le(this,f,l,2,65535,0),this[l]=f&255,this[l+1]=f>>>8,l+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(f,l,B){return f=+f,l=l>>>0,B||le(this,f,l,2,65535,0),this[l]=f>>>8,this[l+1]=f&255,l+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(f,l,B){return f=+f,l=l>>>0,B||le(this,f,l,4,4294967295,0),this[l+3]=f>>>24,this[l+2]=f>>>16,this[l+1]=f>>>8,this[l]=f&255,l+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(f,l,B){return f=+f,l=l>>>0,B||le(this,f,l,4,4294967295,0),this[l]=f>>>24,this[l+1]=f>>>16,this[l+2]=f>>>8,this[l+3]=f&255,l+4};function te(y,f,l,B,k){h(f,B,k,y,l,7);let D=Number(f&BigInt(4294967295));y[l++]=D,D=D>>8,y[l++]=D,D=D>>8,y[l++]=D,D=D>>8,y[l++]=D;let H=Number(f>>BigInt(32)&BigInt(4294967295));return y[l++]=H,H=H>>8,y[l++]=H,H=H>>8,y[l++]=H,H=H>>8,y[l++]=H,l}function _(y,f,l,B,k){h(f,B,k,y,l,7);let D=Number(f&BigInt(4294967295));y[l+7]=D,D=D>>8,y[l+6]=D,D=D>>8,y[l+5]=D,D=D>>8,y[l+4]=D;let H=Number(f>>BigInt(32)&BigInt(4294967295));return y[l+3]=H,H=H>>8,y[l+2]=H,H=H>>8,y[l+1]=H,H=H>>8,y[l]=H,l+8}c.prototype.writeBigUInt64LE=pe(function(f,l=0){return te(this,f,l,BigInt(0),BigInt("0xffffffffffffffff"))}),c.prototype.writeBigUInt64BE=pe(function(f,l=0){return _(this,f,l,BigInt(0),BigInt("0xffffffffffffffff"))}),c.prototype.writeIntLE=function(f,l,B,k){if(f=+f,l=l>>>0,!k){const Te=Math.pow(2,8*B-1);le(this,f,l,B,Te-1,-Te)}let D=0,H=1,_e=0;for(this[l]=f&255;++D<B&&(H*=256);)f<0&&_e===0&&this[l+D-1]!==0&&(_e=1),this[l+D]=(f/H>>0)-_e&255;return l+B},c.prototype.writeIntBE=function(f,l,B,k){if(f=+f,l=l>>>0,!k){const Te=Math.pow(2,8*B-1);le(this,f,l,B,Te-1,-Te)}let D=B-1,H=1,_e=0;for(this[l+D]=f&255;--D>=0&&(H*=256);)f<0&&_e===0&&this[l+D+1]!==0&&(_e=1),this[l+D]=(f/H>>0)-_e&255;return l+B},c.prototype.writeInt8=function(f,l,B){return f=+f,l=l>>>0,B||le(this,f,l,1,127,-128),f<0&&(f=255+f+1),this[l]=f&255,l+1},c.prototype.writeInt16LE=function(f,l,B){return f=+f,l=l>>>0,B||le(this,f,l,2,32767,-32768),this[l]=f&255,this[l+1]=f>>>8,l+2},c.prototype.writeInt16BE=function(f,l,B){return f=+f,l=l>>>0,B||le(this,f,l,2,32767,-32768),this[l]=f>>>8,this[l+1]=f&255,l+2},c.prototype.writeInt32LE=function(f,l,B){return f=+f,l=l>>>0,B||le(this,f,l,4,2147483647,-2147483648),this[l]=f&255,this[l+1]=f>>>8,this[l+2]=f>>>16,this[l+3]=f>>>24,l+4},c.prototype.writeInt32BE=function(f,l,B){return f=+f,l=l>>>0,B||le(this,f,l,4,2147483647,-2147483648),f<0&&(f=4294967295+f+1),this[l]=f>>>24,this[l+1]=f>>>16,this[l+2]=f>>>8,this[l+3]=f&255,l+4},c.prototype.writeBigInt64LE=pe(function(f,l=0){return te(this,f,l,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),c.prototype.writeBigInt64BE=pe(function(f,l=0){return _(this,f,l,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function se(y,f,l,B,k,D){if(l+B>y.length)throw new RangeError("Index out of range");if(l<0)throw new RangeError("Index out of range")}function ue(y,f,l,B,k){return f=+f,l=l>>>0,k||se(y,f,l,4),r.write(y,f,l,B,23,4),l+4}c.prototype.writeFloatLE=function(f,l,B){return ue(this,f,l,!0,B)},c.prototype.writeFloatBE=function(f,l,B){return ue(this,f,l,!1,B)};function he(y,f,l,B,k){return f=+f,l=l>>>0,k||se(y,f,l,8),r.write(y,f,l,B,52,8),l+8}c.prototype.writeDoubleLE=function(f,l,B){return he(this,f,l,!0,B)},c.prototype.writeDoubleBE=function(f,l,B){return he(this,f,l,!1,B)},c.prototype.copy=function(f,l,B,k){if(!c.isBuffer(f))throw new TypeError("argument should be a Buffer");if(B||(B=0),!k&&k!==0&&(k=this.length),l>=f.length&&(l=f.length),l||(l=0),k>0&&k<B&&(k=B),k===B||f.length===0||this.length===0)return 0;if(l<0)throw new RangeError("targetStart out of bounds");if(B<0||B>=this.length)throw new RangeError("Index out of range");if(k<0)throw new RangeError("sourceEnd out of bounds");k>this.length&&(k=this.length),f.length-l<k-B&&(k=f.length-l+B);const D=k-B;return this===f&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(l,B,k):Uint8Array.prototype.set.call(f,this.subarray(B,k),l),D},c.prototype.fill=function(f,l,B,k){if(typeof f=="string"){if(typeof l=="string"?(k=l,l=0,B=this.length):typeof B=="string"&&(k=B,B=this.length),k!==void 0&&typeof k!="string")throw new TypeError("encoding must be a string");if(typeof k=="string"&&!c.isEncoding(k))throw new TypeError("Unknown encoding: "+k);if(f.length===1){const H=f.charCodeAt(0);(k==="utf8"&&H<128||k==="latin1")&&(f=H)}}else typeof f=="number"?f=f&255:typeof f=="boolean"&&(f=Number(f));if(l<0||this.length<l||this.length<B)throw new RangeError("Out of range index");if(B<=l)return this;l=l>>>0,B=B===void 0?this.length:B>>>0,f||(f=0);let D;if(typeof f=="number")for(D=l;D<B;++D)this[D]=f;else{const H=c.isBuffer(f)?f:c.from(f,k),_e=H.length;if(_e===0)throw new TypeError('The value "'+f+'" is invalid for argument "value"');for(D=0;D<B-l;++D)this[D+l]=H[D%_e]}return this};const ne={};function ce(y,f,l){ne[y]=class extends l{constructor(){super(),Object.defineProperty(this,"message",{value:f.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${y}]`,this.stack,delete this.name}get code(){return y}set code(k){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:k,writable:!0})}toString(){return`${this.name} [${y}]: ${this.message}`}}}ce("ERR_BUFFER_OUT_OF_BOUNDS",function(y){return y?`${y} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),ce("ERR_INVALID_ARG_TYPE",function(y,f){return`The "${y}" argument must be of type number. Received type ${typeof f}`},TypeError),ce("ERR_OUT_OF_RANGE",function(y,f,l){let B=`The value of "${y}" is out of range.`,k=l;return Number.isInteger(l)&&Math.abs(l)>2**32?k=m(String(l)):typeof l=="bigint"&&(k=String(l),(l>BigInt(2)**BigInt(32)||l<-(BigInt(2)**BigInt(32)))&&(k=m(k)),k+="n"),B+=` It must be ${f}. Received ${k}`,B},RangeError);function m(y){let f="",l=y.length;const B=y[0]==="-"?1:0;for(;l>=B+4;l-=3)f=`_${y.slice(l-3,l)}${f}`;return`${y.slice(0,l)}${f}`}function s(y,f,l){x(f,"offset"),(y[f]===void 0||y[f+l]===void 0)&&v(f,y.length-(l+1))}function h(y,f,l,B,k,D){if(y>l||y<f){const H=typeof f=="bigint"?"n":"";let _e;throw f===0||f===BigInt(0)?_e=`>= 0${H} and < 2${H} ** ${(D+1)*8}${H}`:_e=`>= -(2${H} ** ${(D+1)*8-1}${H}) and < 2 ** ${(D+1)*8-1}${H}`,new ne.ERR_OUT_OF_RANGE("value",_e,y)}s(B,k,D)}function x(y,f){if(typeof y!="number")throw new ne.ERR_INVALID_ARG_TYPE(f,"number",y)}function v(y,f,l){throw Math.floor(y)!==y?(x(y,l),new ne.ERR_OUT_OF_RANGE("offset","an integer",y)):f<0?new ne.ERR_BUFFER_OUT_OF_BOUNDS:new ne.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${f}`,y)}const U=/[^+/0-9A-Za-z-_]/g;function p(y){if(y=y.split("=")[0],y=y.trim().replace(U,""),y.length<2)return"";for(;y.length%4!==0;)y=y+"=";return y}function a(y,f){f=f||1/0;let l;const B=y.length;let k=null;const D=[];for(let H=0;H<B;++H){if(l=y.charCodeAt(H),l>55295&&l<57344){if(!k){if(l>56319){(f-=3)>-1&&D.push(239,191,189);continue}else if(H+1===B){(f-=3)>-1&&D.push(239,191,189);continue}k=l;continue}if(l<56320){(f-=3)>-1&&D.push(239,191,189),k=l;continue}l=(k-55296<<10|l-56320)+65536}else k&&(f-=3)>-1&&D.push(239,191,189);if(k=null,l<128){if((f-=1)<0)break;D.push(l)}else if(l<2048){if((f-=2)<0)break;D.push(l>>6|192,l&63|128)}else if(l<65536){if((f-=3)<0)break;D.push(l>>12|224,l>>6&63|128,l&63|128)}else if(l<1114112){if((f-=4)<0)break;D.push(l>>18|240,l>>12&63|128,l>>6&63|128,l&63|128)}else throw new Error("Invalid code point")}return D}function u(y){const f=[];for(let l=0;l<y.length;++l)f.push(y.charCodeAt(l)&255);return f}function g(y,f){let l,B,k;const D=[];for(let H=0;H<y.length&&!((f-=2)<0);++H)l=y.charCodeAt(H),B=l>>8,k=l%256,D.push(k),D.push(B);return D}function T(y){return t.toByteArray(p(y))}function O(y,f,l,B){let k;for(k=0;k<B&&!(k+l>=f.length||k>=y.length);++k)f[k+l]=y[k];return k}function L(y,f){return y instanceof f||y!=null&&y.constructor!=null&&y.constructor.name!=null&&y.constructor.name===f.name}function Y(y){return y!==y}const oe=function(){const y="0123456789abcdef",f=new Array(256);for(let l=0;l<16;++l){const B=l*16;for(let k=0;k<16;++k)f[B+k]=y[l]+y[k]}return f}();function pe(y){return typeof BigInt>"u"?me:y}function me(){throw new Error("BigInt not supported")}})(Qa);function ta(e){const t=ju(e),r=new ArrayBuffer(t.length),n=new DataView(r);for(let i=0;i<r.byteLength;i++)n.setUint8(i,t.charCodeAt(i));return r}const qu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function ju(e){e.length%4===0&&(e=e.replace(/==?$/,""));let t="",r=0,n=0;for(let i=0;i<e.length;i++)r<<=6,r|=qu.indexOf(e[i]),n+=6,n===24&&(t+=String.fromCharCode((r&16711680)>>16),t+=String.fromCharCode((r&65280)>>8),t+=String.fromCharCode(r&255),r=n=0);return n===12?(r>>=4,t+=String.fromCharCode(r)):n===18&&(r>>=2,t+=String.fromCharCode((r&65280)>>8),t+=String.fromCharCode(r&255)),t}const Gu=-1,Lu=-2,Hu=-3,Du=-4,Ku=-5,zu=-6;function j0(e,t){if(typeof e=="number")return i(e,!0);if(!Array.isArray(e)||e.length===0)throw new Error("Invalid input");const r=e,n=Array(r.length);function i(o,d=!1){if(o===Gu)return;if(o===Hu)return NaN;if(o===Du)return 1/0;if(o===Ku)return-1/0;if(o===zu)return-0;if(d)throw new Error("Invalid input");if(o in n)return n[o];const c=r[o];if(!c||typeof c!="object")n[o]=c;else if(Array.isArray(c))if(typeof c[0]=="string"){const w=c[0],E=t?.[w];if(E)return n[o]=E(i(c[1]));switch(w){case"Date":n[o]=new Date(c[1]);break;case"Set":const A=new Set;n[o]=A;for(let N=1;N<c.length;N+=1)A.add(i(c[N]));break;case"Map":const I=new Map;n[o]=I;for(let N=1;N<c.length;N+=2)I.set(i(c[N]),i(c[N+1]));break;case"RegExp":n[o]=new RegExp(c[1],c[2]);break;case"Object":n[o]=Object(c[1]);break;case"BigInt":n[o]=BigInt(c[1]);break;case"null":const S=Object.create(null);n[o]=S;for(let N=1;N<c.length;N+=2)S[c[N]]=i(c[N+1]);break;case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":{const N=globalThis[w],b=c[1],j=ta(b),V=new N(j);n[o]=V;break}case"ArrayBuffer":{const N=c[1],b=ta(N);n[o]=b;break}default:throw new Error(`Unknown type ${w}`)}}else{const w=new Array(c.length);n[o]=w;for(let E=0;E<c.length;E+=1){const A=c[E];A!==Lu&&(w[E]=i(A))}}else{const w={};n[o]=w;for(const E in c){const A=c[E];w[E]=i(A)}}return n[o]}return i(0)}var ls;(function(e){e[e.SysFatal=1]="SysFatal",e[e.SysTransient=2]="SysTransient",e[e.DestinationInvalid=3]="DestinationInvalid",e[e.CanisterReject=4]="CanisterReject",e[e.CanisterError=5]="CanisterError"})(ls||(ls={}));const oi="abcdefghijklmnopqrstuvwxyz234567",jr=Object.create(null);for(let e=0;e<oi.length;e++)jr[oi[e]]=e;jr[0]=jr.o;jr[1]=jr.i;function Wu(e){let t=0,r=0,n="";function i(o){return t<0?r|=o>>-t:r=o<<t&248,t>3?(t-=8,1):(t<4&&(n+=oi[r>>3],t+=5),0)}for(let o=0;o<e.length;)o+=i(e[o]);return n+(t<0?oi[r>>3]:"")}function Yu(e){let t=0,r=0;const n=new Uint8Array(e.length*4/3|0);let i=0;function o(d){let c=jr[d.toLowerCase()];if(c===void 0)throw new Error(`Invalid character: ${JSON.stringify(d)}`);c<<=3,r|=c>>>t,t+=5,t>=8&&(n[i++]=r,t-=8,t>0?r=c<<5-t&255:r=0)}for(const d of e)o(d);return n.slice(0,i)}const Zu=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]);function Xu(e){const t=new Uint8Array(e);let r=-1;for(let n=0;n<t.length;n++){const o=(t[n]^r)&255;r=Zu[o]^r>>>8}return(r^-1)>>>0}function Ju(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function to(e,...t){if(!Ju(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function ra(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Qu(e,t){to(e);const r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}const vr=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function ji(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Nt(e,t){return e<<32-t|e>>>t}function ef(e){if(typeof e!="string")throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array(new TextEncoder().encode(e))}function ro(e){return typeof e=="string"&&(e=ef(e)),to(e),e}class tf{clone(){return this._cloneInto()}}function Fs(e){const t=n=>e().update(ro(n)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function no(e=32){if(vr&&typeof vr.getRandomValues=="function")return vr.getRandomValues(new Uint8Array(e));if(vr&&typeof vr.randomBytes=="function")return vr.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")}function rf(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);const i=BigInt(32),o=BigInt(4294967295),d=Number(r>>i&o),c=Number(r&o),w=n?4:0,E=n?0:4;e.setUint32(t+w,d,n),e.setUint32(t+E,c,n)}function nf(e,t,r){return e&t^~e&r}function sf(e,t,r){return e&t^e&r^t&r}class io extends tf{constructor(t,r,n,i){super(),this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=ji(this.buffer)}update(t){ra(this);const{view:r,buffer:n,blockLen:i}=this;t=ro(t);const o=t.length;for(let d=0;d<o;){const c=Math.min(i-this.pos,o-d);if(c===i){const w=ji(t);for(;i<=o-d;d+=i)this.process(w,d);continue}n.set(t.subarray(d,d+c),this.pos),this.pos+=c,d+=c,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){ra(this),Qu(t,this),this.finished=!0;const{buffer:r,view:n,blockLen:i,isLE:o}=this;let{pos:d}=this;r[d++]=128,this.buffer.subarray(d).fill(0),this.padOffset>i-d&&(this.process(n,0),d=0);for(let I=d;I<i;I++)r[I]=0;rf(n,i-8,BigInt(this.length*8),o),this.process(n,0);const c=ji(t),w=this.outputLen;if(w%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const E=w/4,A=this.get();if(E>A.length)throw new Error("_sha2: outputLen bigger than state");for(let I=0;I<E;I++)c.setUint32(4*I,A[I],o)}digest(){const{buffer:t,outputLen:r}=this;this.digestInto(t);const n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:r,buffer:n,length:i,finished:o,destroyed:d,pos:c}=this;return t.length=i,t.pos=c,t.finished=o,t.destroyed=d,i%r&&t.buffer.set(n),t}}const af=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Dt=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Kt=new Uint32Array(64);class so extends io{constructor(){super(64,32,8,!1),this.A=Dt[0]|0,this.B=Dt[1]|0,this.C=Dt[2]|0,this.D=Dt[3]|0,this.E=Dt[4]|0,this.F=Dt[5]|0,this.G=Dt[6]|0,this.H=Dt[7]|0}get(){const{A:t,B:r,C:n,D:i,E:o,F:d,G:c,H:w}=this;return[t,r,n,i,o,d,c,w]}set(t,r,n,i,o,d,c,w){this.A=t|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=o|0,this.F=d|0,this.G=c|0,this.H=w|0}process(t,r){for(let I=0;I<16;I++,r+=4)Kt[I]=t.getUint32(r,!1);for(let I=16;I<64;I++){const S=Kt[I-15],N=Kt[I-2],b=Nt(S,7)^Nt(S,18)^S>>>3,j=Nt(N,17)^Nt(N,19)^N>>>10;Kt[I]=j+Kt[I-7]+b+Kt[I-16]|0}let{A:n,B:i,C:o,D:d,E:c,F:w,G:E,H:A}=this;for(let I=0;I<64;I++){const S=Nt(c,6)^Nt(c,11)^Nt(c,25),N=A+S+nf(c,w,E)+af[I]+Kt[I]|0,j=(Nt(n,2)^Nt(n,13)^Nt(n,22))+sf(n,i,o)|0;A=E,E=w,w=c,c=d+N|0,d=o,o=i,i=n,n=N+j|0}n=n+this.A|0,i=i+this.B|0,o=o+this.C|0,d=d+this.D|0,c=c+this.E|0,w=w+this.F|0,E=E+this.G|0,A=A+this.H|0,this.set(n,i,o,d,c,w,E,A)}roundClean(){Kt.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class of extends so{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const Ps=Fs(()=>new so),cf=Fs(()=>new of);function uf(e){return cf.create().update(new Uint8Array(e)).digest()}const Zr="__principal__",ff=2,na=4,lf="aaaaa-aa",df=e=>{var t;return new Uint8Array(((t=e.match(/.{1,2}/g))!==null&&t!==void 0?t:[]).map(r=>parseInt(r,16)))},hf=e=>e.reduce((t,r)=>t+r.toString(16).padStart(2,"0"),"");let ve=class Cn{constructor(t){this._arr=t,this._isPrincipal=!0}static anonymous(){return new this(new Uint8Array([na]))}static managementCanister(){return this.fromHex(lf)}static selfAuthenticating(t){const r=uf(t);return new this(new Uint8Array([...r,ff]))}static from(t){if(typeof t=="string")return Cn.fromText(t);if(Object.getPrototypeOf(t)===Uint8Array.prototype)return new Cn(t);if(typeof t=="object"&&t!==null&&t._isPrincipal===!0)return new Cn(t._arr);throw new Error(`Impossible to convert ${JSON.stringify(t)} to Principal.`)}static fromHex(t){return new this(df(t))}static fromText(t){let r=t;if(t.includes(Zr)){const d=JSON.parse(t);Zr in d&&(r=d[Zr])}const n=r.toLowerCase().replace(/-/g,"");let i=Yu(n);i=i.slice(4,i.length);const o=new this(i);if(o.toText()!==r)throw new Error(`Principal "${o.toText()}" does not have a valid checksum (original value "${r}" may not be a valid Principal ID).`);return o}static fromUint8Array(t){return new this(t)}isAnonymous(){return this._arr.byteLength===1&&this._arr[0]===na}toUint8Array(){return this._arr}toHex(){return hf(this._arr).toUpperCase()}toText(){const t=new ArrayBuffer(4);new DataView(t).setUint32(0,Xu(this._arr));const n=new Uint8Array(t),i=Uint8Array.from(this._arr),o=new Uint8Array([...n,...i]),c=Wu(o).match(/.{1,5}/g);if(!c)throw new Error;return c.join("-")}toString(){return this.toText()}toJSON(){return{[Zr]:this.toText()}}compareTo(t){for(let r=0;r<Math.min(this._arr.length,t._arr.length);r++){if(this._arr[r]<t._arr[r])return"lt";if(this._arr[r]>t._arr[r])return"gt"}return this._arr.length<t._arr.length?"lt":this._arr.length>t._arr.length?"gt":"eq"}ltEq(t){const r=this.compareTo(t);return r=="lt"||r=="eq"}gtEq(t){const r=this.compareTo(t);return r=="gt"||r=="eq"}};const pf=Object.freeze(Object.defineProperty({__proto__:null,JSON_KEY_PRINCIPAL:Zr,Principal:ve},Symbol.toStringTag,{value:"Module"}));function Bt(...e){const t=new Uint8Array(e.reduce((n,i)=>n+i.byteLength,0));let r=0;for(const n of e)t.set(new Uint8Array(n),r),r+=n.byteLength;return t.buffer}function et(e){return[...new Uint8Array(e)].map(t=>t.toString(16).padStart(2,"0")).join("")}const yf=new RegExp(/^[0-9a-fA-F]+$/);function Lt(e){if(!yf.test(e))throw new Error("Invalid hexadecimal string.");const t=[...e].reduce((r,n,i)=>(r[i/2|0]=(r[i/2|0]||"")+n,r),[]).map(r=>Number.parseInt(r,16));return new Uint8Array(t).buffer}function ao(e,t){if(e.byteLength!==t.byteLength)return e.byteLength-t.byteLength;const r=new Uint8Array(e),n=new Uint8Array(t);for(let i=0;i<r.length;i++)if(r[i]!==n[i])return r[i]-n[i];return 0}function vi(e,t){return ao(e,t)===0}function sn(e){return new DataView(e.buffer,e.byteOffset,e.byteLength).buffer}function ks(e){return e instanceof Uint8Array?sn(e):e instanceof ArrayBuffer?e:Array.isArray(e)?sn(new Uint8Array(e)):"buffer"in e?ks(e.buffer):sn(new Uint8Array(e))}class De extends Error{constructor(t){super(t),this.message=t,this.name="AgentError",this.__proto__=De.prototype,Object.setPrototypeOf(this,De.prototype)}}function Re(...e){const t=new Uint8Array(e.reduce((n,i)=>n+i.byteLength,0));let r=0;for(const n of e)t.set(new Uint8Array(n),r),r+=n.byteLength;return t}let Dr=class{constructor(t,r=t?.byteLength||0){this._buffer=ci(t||new ArrayBuffer(0)),this._view=new Uint8Array(this._buffer,0,r)}get buffer(){return ci(this._view.slice())}get byteLength(){return this._view.byteLength}read(t){const r=this._view.subarray(0,t);return this._view=this._view.subarray(t),r.slice().buffer}readUint8(){const t=this._view[0];return this._view=this._view.subarray(1),t}write(t){const r=new Uint8Array(t),n=this._view.byteLength;this._view.byteOffset+this._view.byteLength+r.byteLength>=this._buffer.byteLength?this.alloc(r.byteLength):this._view=new Uint8Array(this._buffer,this._view.byteOffset,this._view.byteLength+r.byteLength),this._view.set(r,n)}get end(){return this._view.byteLength===0}alloc(t){const r=new ArrayBuffer((this._buffer.byteLength+t)*1.2|0),n=new Uint8Array(r,0,this._view.byteLength+t);n.set(this._view),this._buffer=r,this._view=n}};function Gi(e){return new DataView(e.buffer,e.byteOffset,e.byteLength).buffer}function ci(e){return e instanceof Uint8Array?Gi(e):e instanceof ArrayBuffer?e:Array.isArray(e)?Gi(new Uint8Array(e)):"buffer"in e?ci(e.buffer):Gi(new Uint8Array(e))}function gf(e){const r=new TextEncoder().encode(e);let n=0;for(const i of r)n=(n*223+i)%2**32;return n}function kt(e){if(/^_\d+_$/.test(e)||/^_0x[0-9a-fA-F]+_$/.test(e)){const t=+e.slice(1,-1);if(Number.isSafeInteger(t)&&t>=0&&t<2**32)return t}return gf(e)}function oo(){throw new Error("unexpected end of buffer")}function mr(e,t){return e.byteLength<t&&oo(),e.read(t)}function br(e){const t=e.readUint8();return t===void 0&&oo(),t}function $e(e){if(typeof e=="number"&&(e=BigInt(e)),e<BigInt(0))throw new Error("Cannot leb encode negative values.");const t=(e===BigInt(0)?0:Math.ceil(Math.log2(Number(e))))+1,r=new Dr(new ArrayBuffer(t),0);for(;;){const n=Number(e&BigInt(127));if(e/=BigInt(128),e===BigInt(0)){r.write(new Uint8Array([n]));break}else r.write(new Uint8Array([n|128]))}return r.buffer}function Ye(e){let t=BigInt(1),r=BigInt(0),n;do n=br(e),r+=BigInt(n&127).valueOf()*t,t*=BigInt(128);while(n>=128);return r}function Ke(e){typeof e=="number"&&(e=BigInt(e));const t=e<BigInt(0);t&&(e=-e-BigInt(1));const r=(e===BigInt(0)?0:Math.ceil(Math.log2(Number(e))))+1,n=new Dr(new ArrayBuffer(r),0);for(;;){const o=i(e);if(e/=BigInt(128),t&&e===BigInt(0)&&o&64||!t&&e===BigInt(0)&&!(o&64)){n.write(new Uint8Array([o]));break}else n.write(new Uint8Array([o|128]))}function i(o){const d=o%BigInt(128);return Number(t?BigInt(128)-d-BigInt(1):d)}return n.buffer}function Zt(e){const t=new Uint8Array(e.buffer);let r=0;for(;r<t.byteLength;r++)if(t[r]<128){if(!(t[r]&64))return Ye(e);break}const n=new Uint8Array(mr(e,r+1));let i=BigInt(0);for(let o=n.byteLength-1;o>=0;o--)i=i*BigInt(128)+BigInt(128-(n[o]&127)-1);return-i-BigInt(1)}function wf(e,t){if(BigInt(e)<BigInt(0))throw new Error("Cannot write negative values.");return co(e,t)}function co(e,t){e=BigInt(e);const r=new Dr(new ArrayBuffer(Math.min(1,t)),0);let n=0,i=BigInt(256),o=BigInt(0),d=Number(e%i);for(r.write(new Uint8Array([d]));++n<t;)e<0&&o===BigInt(0)&&d!==0&&(o=BigInt(1)),d=Number((e/i-o)%BigInt(256)),r.write(new Uint8Array([d])),i*=BigInt(256);return r.buffer}function uo(e,t){let r=BigInt(br(e)),n=BigInt(1),i=0;for(;++i<t;){n*=BigInt(256);const o=BigInt(br(e));r=r+n*o}return r}function mf(e,t){let r=uo(e,t);const n=BigInt(2)**(BigInt(8)*BigInt(t-1)+BigInt(7));return r>=n&&(r-=n*BigInt(2)),r}function ds(e){const t=BigInt(e);if(e<0)throw new RangeError("Input must be non-negative");return BigInt(1)<<t}const Mn="DIDL",ia=400;function fn(e,t,r){return e.map((n,i)=>r(n,t[i]))}class bf{constructor(){this._typs=[],this._idx=new Map}has(t){return this._idx.has(t.name)}add(t,r){const n=this._typs.length;this._idx.set(t.name,n),this._typs.push(r)}merge(t,r){const n=this._idx.get(t.name),i=this._idx.get(r);if(n===void 0)throw new Error("Missing type index for "+t);if(i===void 0)throw new Error("Missing type index for "+r);this._typs[n]=this._typs[i],this._typs.splice(i,1),this._idx.delete(r)}encode(){const t=$e(this._typs.length),r=Re(...this._typs);return Re(t,r)}indexOf(t){if(!this._idx.has(t))throw new Error("Missing type index for "+t);return Ke(this._idx.get(t)||0)}}class _f{visitType(t,r){throw new Error("Not implemented")}visitPrimitive(t,r){return this.visitType(t,r)}visitEmpty(t,r){return this.visitPrimitive(t,r)}visitBool(t,r){return this.visitPrimitive(t,r)}visitNull(t,r){return this.visitPrimitive(t,r)}visitReserved(t,r){return this.visitPrimitive(t,r)}visitText(t,r){return this.visitPrimitive(t,r)}visitNumber(t,r){return this.visitPrimitive(t,r)}visitInt(t,r){return this.visitNumber(t,r)}visitNat(t,r){return this.visitNumber(t,r)}visitFloat(t,r){return this.visitPrimitive(t,r)}visitFixedInt(t,r){return this.visitNumber(t,r)}visitFixedNat(t,r){return this.visitNumber(t,r)}visitPrincipal(t,r){return this.visitPrimitive(t,r)}visitConstruct(t,r){return this.visitType(t,r)}visitVec(t,r,n){return this.visitConstruct(t,n)}visitOpt(t,r,n){return this.visitConstruct(t,n)}visitRecord(t,r,n){return this.visitConstruct(t,n)}visitTuple(t,r,n){const i=r.map((o,d)=>[`_${d}_`,o]);return this.visitRecord(t,i,n)}visitVariant(t,r,n){return this.visitConstruct(t,n)}visitRec(t,r,n){return this.visitConstruct(r,n)}visitFunc(t,r){return this.visitConstruct(t,r)}visitService(t,r){return this.visitConstruct(t,r)}}class Bi{display(){return this.name}valueToString(t){return je(t)}buildTypeTable(t){t.has(this)||this._buildTypeTableImpl(t)}}class wt extends Bi{checkType(t){if(this.name!==t.name)throw new Error(`type mismatch: type on the wire ${t.name}, expect type ${this.name}`);return t}_buildTypeTableImpl(t){}}class fr extends Bi{checkType(t){if(t instanceof lr){const r=t.getType();if(typeof r>"u")throw new Error("type mismatch with uninitialized type");return r}throw new Error(`type mismatch: type on the wire ${t.name}, expect type ${this.name}`)}encodeType(t){return t.indexOf(this.name)}}class fo extends wt{accept(t,r){return t.visitEmpty(this,r)}covariant(t){throw new Error(`Invalid ${this.display()} argument: ${je(t)}`)}encodeValue(){throw new Error("Empty cannot appear as a function argument")}valueToString(){throw new Error("Empty cannot appear as a value")}encodeType(){return Ke(-17)}decodeValue(){throw new Error("Empty cannot appear as an output")}get name(){return"empty"}}class lo extends Bi{checkType(t){throw new Error("Method not implemented for unknown.")}accept(t,r){throw t.visitType(this,r)}covariant(t){throw new Error(`Invalid ${this.display()} argument: ${je(t)}`)}encodeValue(){throw new Error("Unknown cannot appear as a function argument")}valueToString(){throw new Error("Unknown cannot appear as a value")}encodeType(){throw new Error("Unknown cannot be serialized")}decodeValue(t,r){let n=r.decodeValue(t,r);Object(n)!==n&&(n=Object(n));let i;return r instanceof lr?i=()=>r.getType():i=()=>r,Object.defineProperty(n,"type",{value:i,writable:!0,enumerable:!1,configurable:!0}),n}_buildTypeTableImpl(){throw new Error("Unknown cannot be serialized")}get name(){return"Unknown"}}class ho extends wt{accept(t,r){return t.visitBool(this,r)}covariant(t){if(typeof t=="boolean")return!0;throw new Error(`Invalid ${this.display()} argument: ${je(t)}`)}encodeValue(t){return new Uint8Array([t?1:0])}encodeType(){return Ke(-2)}decodeValue(t,r){switch(this.checkType(r),br(t)){case 0:return!1;case 1:return!0;default:throw new Error("Boolean value out of range")}}get name(){return"bool"}}class po extends wt{accept(t,r){return t.visitNull(this,r)}covariant(t){if(t===null)return!0;throw new Error(`Invalid ${this.display()} argument: ${je(t)}`)}encodeValue(){return new ArrayBuffer(0)}encodeType(){return Ke(-1)}decodeValue(t,r){return this.checkType(r),null}get name(){return"null"}}class ui extends wt{accept(t,r){return t.visitReserved(this,r)}covariant(t){return!0}encodeValue(){return new ArrayBuffer(0)}encodeType(){return Ke(-16)}decodeValue(t,r){return r.name!==this.name&&r.decodeValue(t,r),null}get name(){return"reserved"}}class yo extends wt{accept(t,r){return t.visitText(this,r)}covariant(t){if(typeof t=="string")return!0;throw new Error(`Invalid ${this.display()} argument: ${je(t)}`)}encodeValue(t){const r=new TextEncoder().encode(t),n=$e(r.byteLength);return Re(n,r)}encodeType(){return Ke(-15)}decodeValue(t,r){this.checkType(r);const n=Ye(t),i=mr(t,Number(n));return new TextDecoder("utf8",{fatal:!0}).decode(i)}get name(){return"text"}valueToString(t){return'"'+t+'"'}}class go extends wt{accept(t,r){return t.visitInt(this,r)}covariant(t){if(typeof t=="bigint"||Number.isInteger(t))return!0;throw new Error(`Invalid ${this.display()} argument: ${je(t)}`)}encodeValue(t){return Ke(t)}encodeType(){return Ke(-4)}decodeValue(t,r){return this.checkType(r),Zt(t)}get name(){return"int"}valueToString(t){return t.toString()}}class wo extends wt{accept(t,r){return t.visitNat(this,r)}covariant(t){if(typeof t=="bigint"&&t>=BigInt(0)||Number.isInteger(t)&&t>=0)return!0;throw new Error(`Invalid ${this.display()} argument: ${je(t)}`)}encodeValue(t){return $e(t)}encodeType(){return Ke(-3)}decodeValue(t,r){return this.checkType(r),Ye(t)}get name(){return"nat"}valueToString(t){return t.toString()}}class Cs extends wt{constructor(t){if(super(),this._bits=t,t!==32&&t!==64)throw new Error("not a valid float type")}accept(t,r){return t.visitFloat(this,r)}covariant(t){if(typeof t=="number"||t instanceof Number)return!0;throw new Error(`Invalid ${this.display()} argument: ${je(t)}`)}encodeValue(t){const r=new ArrayBuffer(this._bits/8),n=new DataView(r);return this._bits===32?n.setFloat32(0,t,!0):n.setFloat64(0,t,!0),r}encodeType(){const t=this._bits===32?-13:-14;return Ke(t)}decodeValue(t,r){this.checkType(r);const n=mr(t,this._bits/8),i=new DataView(n);return this._bits===32?i.getFloat32(0,!0):i.getFloat64(0,!0)}get name(){return"float"+this._bits}valueToString(t){return t.toString()}}class _r extends wt{constructor(t){super(),this._bits=t}accept(t,r){return t.visitFixedInt(this,r)}covariant(t){const r=ds(this._bits-1)*BigInt(-1),n=ds(this._bits-1)-BigInt(1);let i=!1;if(typeof t=="bigint")i=t>=r&&t<=n;else if(Number.isInteger(t)){const o=BigInt(t);i=o>=r&&o<=n}else i=!1;if(i)return!0;throw new Error(`Invalid ${this.display()} argument: ${je(t)}`)}encodeValue(t){return co(t,this._bits/8)}encodeType(){const t=Math.log2(this._bits)-3;return Ke(-9-t)}decodeValue(t,r){this.checkType(r);const n=mf(t,this._bits/8);return this._bits<=32?Number(n):n}get name(){return`int${this._bits}`}valueToString(t){return t.toString()}}class or extends wt{constructor(t){super(),this._bits=t}accept(t,r){return t.visitFixedNat(this,r)}covariant(t){const r=ds(this._bits);let n=!1;if(typeof t=="bigint"&&t>=BigInt(0)?n=t<r:Number.isInteger(t)&&t>=0?n=BigInt(t)<r:n=!1,n)return!0;throw new Error(`Invalid ${this.display()} argument: ${je(t)}`)}encodeValue(t){return wf(t,this._bits/8)}encodeType(){const t=Math.log2(this._bits)-3;return Ke(-5-t)}decodeValue(t,r){this.checkType(r);const n=uo(t,this._bits/8);return this._bits<=32?Number(n):n}get name(){return`nat${this._bits}`}valueToString(t){return t.toString()}}class Ai extends fr{constructor(t){super(),this._type=t,this._blobOptimization=!1,t instanceof or&&t._bits===8&&(this._blobOptimization=!0)}accept(t,r){return t.visitVec(this,this._type,r)}covariant(t){const r=this._type instanceof or?this._type._bits:this._type instanceof _r?this._type._bits:0;if(ArrayBuffer.isView(t)&&r==t.BYTES_PER_ELEMENT*8||Array.isArray(t)&&t.every((n,i)=>{try{return this._type.covariant(n)}catch(o){throw new Error(`Invalid ${this.display()} argument: 

index ${i} -> ${o.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${je(t)}`)}encodeValue(t){const r=$e(t.length);if(this._blobOptimization)return Re(r,new Uint8Array(t));if(ArrayBuffer.isView(t))return Re(r,new Uint8Array(t.buffer));const n=new Dr(new ArrayBuffer(r.byteLength+t.length),0);n.write(r);for(const i of t){const o=this._type.encodeValue(i);n.write(new Uint8Array(o))}return n.buffer}_buildTypeTableImpl(t){this._type.buildTypeTable(t);const r=Ke(-19),n=this._type.encodeType(t);t.add(this,Re(r,n))}decodeValue(t,r){const n=this.checkType(r);if(!(n instanceof Ai))throw new Error("Not a vector type");const i=Number(Ye(t));if(this._type instanceof or){if(this._type._bits==8)return new Uint8Array(t.read(i));if(this._type._bits==16)return new Uint16Array(t.read(i*2));if(this._type._bits==32)return new Uint32Array(t.read(i*4));if(this._type._bits==64)return new BigUint64Array(t.read(i*8))}if(this._type instanceof _r){if(this._type._bits==8)return new Int8Array(t.read(i));if(this._type._bits==16)return new Int16Array(t.read(i*2));if(this._type._bits==32)return new Int32Array(t.read(i*4));if(this._type._bits==64)return new BigInt64Array(t.read(i*8))}const o=[];for(let d=0;d<i;d++)o.push(this._type.decodeValue(t,n._type));return o}get name(){return`vec ${this._type.name}`}display(){return`vec ${this._type.display()}`}valueToString(t){return"vec {"+t.map(n=>this._type.valueToString(n)).join("; ")+"}"}}class Gr extends fr{constructor(t){super(),this._type=t}accept(t,r){return t.visitOpt(this,this._type,r)}covariant(t){try{if(Array.isArray(t)&&(t.length===0||t.length===1&&this._type.covariant(t[0])))return!0}catch(r){throw new Error(`Invalid ${this.display()} argument: ${je(t)} 

-> ${r.message}`)}throw new Error(`Invalid ${this.display()} argument: ${je(t)}`)}encodeValue(t){return t.length===0?new Uint8Array([0]):Re(new Uint8Array([1]),this._type.encodeValue(t[0]))}_buildTypeTableImpl(t){this._type.buildTypeTable(t);const r=Ke(-18),n=this._type.encodeType(t);t.add(this,Re(r,n))}decodeValue(t,r){const n=this.checkType(r);if(!(n instanceof Gr))throw new Error("Not an option type");switch(br(t)){case 0:return[];case 1:return[this._type.decodeValue(t,n._type)];default:throw new Error("Not an option value")}}get name(){return`opt ${this._type.name}`}display(){return`opt ${this._type.display()}`}valueToString(t){return t.length===0?"null":`opt ${this._type.valueToString(t[0])}`}}class bn extends fr{constructor(t={}){super(),this._fields=Object.entries(t).sort((r,n)=>kt(r[0])-kt(n[0]))}accept(t,r){return t.visitRecord(this,this._fields,r)}tryAsTuple(){const t=[];for(let r=0;r<this._fields.length;r++){const[n,i]=this._fields[r];if(n!==`_${r}_`)return null;t.push(i)}return t}covariant(t){if(typeof t=="object"&&this._fields.every(([r,n])=>{if(!t.hasOwnProperty(r))throw new Error(`Record is missing key "${r}".`);try{return n.covariant(t[r])}catch(i){throw new Error(`Invalid ${this.display()} argument: 

field ${r} -> ${i.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${je(t)}`)}encodeValue(t){const r=this._fields.map(([i])=>t[i]),n=fn(this._fields,r,([,i],o)=>i.encodeValue(o));return Re(...n)}_buildTypeTableImpl(t){this._fields.forEach(([o,d])=>d.buildTypeTable(t));const r=Ke(-20),n=$e(this._fields.length),i=this._fields.map(([o,d])=>Re($e(kt(o)),d.encodeType(t)));t.add(this,Re(r,n,Re(...i)))}decodeValue(t,r){const n=this.checkType(r);if(!(n instanceof bn))throw new Error("Not a record type");const i={};let o=0,d=0;for(;d<n._fields.length;){const[c,w]=n._fields[d];if(o>=this._fields.length){w.decodeValue(t,w),d++;continue}const[E,A]=this._fields[o],I=kt(this._fields[o][0]),S=kt(c);if(I===S)i[E]=A.decodeValue(t,w),o++,d++;else if(S>I)if(A instanceof Gr||A instanceof ui)i[E]=[],o++;else throw new Error("Cannot find required field "+E);else w.decodeValue(t,w),d++}for(const[c,w]of this._fields.slice(o))if(w instanceof Gr||w instanceof ui)i[c]=[];else throw new Error("Cannot find required field "+c);return i}get name(){return`record {${this._fields.map(([r,n])=>r+":"+n.name).join("; ")}}`}display(){return`record {${this._fields.map(([r,n])=>r+":"+n.display()).join("; ")}}`}valueToString(t){const r=this._fields.map(([i])=>t[i]);return`record {${fn(this._fields,r,([i,o],d)=>i+"="+o.valueToString(d)).join("; ")}}`}}class Ni extends bn{constructor(t){const r={};t.forEach((n,i)=>r["_"+i+"_"]=n),super(r),this._components=t}accept(t,r){return t.visitTuple(this,this._components,r)}covariant(t){if(Array.isArray(t)&&t.length>=this._fields.length&&this._components.every((r,n)=>{try{return r.covariant(t[n])}catch(i){throw new Error(`Invalid ${this.display()} argument: 

index ${n} -> ${i.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${je(t)}`)}encodeValue(t){const r=fn(this._components,t,(n,i)=>n.encodeValue(i));return Re(...r)}decodeValue(t,r){const n=this.checkType(r);if(!(n instanceof Ni))throw new Error("not a tuple type");if(n._components.length<this._components.length)throw new Error("tuple mismatch");const i=[];for(const[o,d]of n._components.entries())o>=this._components.length?d.decodeValue(t,d):i.push(this._components[o].decodeValue(t,d));return i}display(){return`record {${this._components.map(r=>r.display()).join("; ")}}`}valueToString(t){return`record {${fn(this._components,t,(n,i)=>n.valueToString(i)).join("; ")}}`}}class Si extends fr{constructor(t={}){super(),this._fields=Object.entries(t).sort((r,n)=>kt(r[0])-kt(n[0]))}accept(t,r){return t.visitVariant(this,this._fields,r)}covariant(t){if(typeof t=="object"&&Object.entries(t).length===1&&this._fields.every(([r,n])=>{try{return!t.hasOwnProperty(r)||n.covariant(t[r])}catch(i){throw new Error(`Invalid ${this.display()} argument: 

variant ${r} -> ${i.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${je(t)}`)}encodeValue(t){for(let r=0;r<this._fields.length;r++){const[n,i]=this._fields[r];if(t.hasOwnProperty(n)){const o=$e(r),d=i.encodeValue(t[n]);return Re(o,d)}}throw Error("Variant has no data: "+t)}_buildTypeTableImpl(t){this._fields.forEach(([,o])=>{o.buildTypeTable(t)});const r=Ke(-21),n=$e(this._fields.length),i=this._fields.map(([o,d])=>Re($e(kt(o)),d.encodeType(t)));t.add(this,Re(r,n,...i))}decodeValue(t,r){const n=this.checkType(r);if(!(n instanceof Si))throw new Error("Not a variant type");const i=Number(Ye(t));if(i>=n._fields.length)throw Error("Invalid variant index: "+i);const[o,d]=n._fields[i];for(const[c,w]of this._fields)if(kt(o)===kt(c)){const E=w.decodeValue(t,d);return{[c]:E}}throw new Error("Cannot find field hash "+o)}get name(){return`variant {${this._fields.map(([r,n])=>r+":"+n.name).join("; ")}}`}display(){return`variant {${this._fields.map(([r,n])=>r+(n.name==="null"?"":`:${n.display()}`)).join("; ")}}`}valueToString(t){for(const[r,n]of this._fields)if(t.hasOwnProperty(r)){const i=n.valueToString(t[r]);return i==="null"?`variant {${r}}`:`variant {${r}=${i}}`}throw new Error("Variant has no data: "+t)}}class lr extends fr{constructor(){super(...arguments),this._id=lr._counter++,this._type=void 0}accept(t,r){if(!this._type)throw Error("Recursive type uninitialized.");return t.visitRec(this,this._type,r)}fill(t){this._type=t}getType(){return this._type}covariant(t){if(this._type&&this._type.covariant(t))return!0;throw new Error(`Invalid ${this.display()} argument: ${je(t)}`)}encodeValue(t){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.encodeValue(t)}_buildTypeTableImpl(t){if(!this._type)throw Error("Recursive type uninitialized.");t.add(this,new Uint8Array([])),this._type.buildTypeTable(t),t.merge(this,this._type.name)}decodeValue(t,r){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.decodeValue(t,r)}get name(){return`rec_${this._id}`}display(){if(!this._type)throw Error("Recursive type uninitialized.");return`${this.name}.${this._type.name}`}valueToString(t){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.valueToString(t)}}lr._counter=0;function Ms(e){if(br(e)!==1)throw new Error("Cannot decode principal");const r=Number(Ye(e));return ve.fromUint8Array(new Uint8Array(mr(e,r)))}class mo extends wt{accept(t,r){return t.visitPrincipal(this,r)}covariant(t){if(t&&t._isPrincipal)return!0;throw new Error(`Invalid ${this.display()} argument: ${je(t)}`)}encodeValue(t){const r=t.toUint8Array(),n=$e(r.byteLength);return Re(new Uint8Array([1]),n,r)}encodeType(){return Ke(-24)}decodeValue(t,r){return this.checkType(r),Ms(t)}get name(){return"principal"}valueToString(t){return`${this.name} "${t.toText()}"`}}class Vs extends fr{constructor(t,r,n=[]){super(),this.argTypes=t,this.retTypes=r,this.annotations=n}static argsToString(t,r){if(t.length!==r.length)throw new Error("arity mismatch");return"("+t.map((n,i)=>n.valueToString(r[i])).join(", ")+")"}accept(t,r){return t.visitFunc(this,r)}covariant(t){if(Array.isArray(t)&&t.length===2&&t[0]&&t[0]._isPrincipal&&typeof t[1]=="string")return!0;throw new Error(`Invalid ${this.display()} argument: ${je(t)}`)}encodeValue([t,r]){const n=t.toUint8Array(),i=$e(n.byteLength),o=Re(new Uint8Array([1]),i,n),d=new TextEncoder().encode(r),c=$e(d.byteLength);return Re(new Uint8Array([1]),o,c,d)}_buildTypeTableImpl(t){this.argTypes.forEach(E=>E.buildTypeTable(t)),this.retTypes.forEach(E=>E.buildTypeTable(t));const r=Ke(-22),n=$e(this.argTypes.length),i=Re(...this.argTypes.map(E=>E.encodeType(t))),o=$e(this.retTypes.length),d=Re(...this.retTypes.map(E=>E.encodeType(t))),c=$e(this.annotations.length),w=Re(...this.annotations.map(E=>this.encodeAnnotation(E)));t.add(this,Re(r,n,i,o,d,c,w))}decodeValue(t){if(br(t)!==1)throw new Error("Cannot decode function reference");const n=Ms(t),i=Number(Ye(t)),o=mr(t,i),c=new TextDecoder("utf8",{fatal:!0}).decode(o);return[n,c]}get name(){const t=this.argTypes.map(i=>i.name).join(", "),r=this.retTypes.map(i=>i.name).join(", "),n=" "+this.annotations.join(" ");return`(${t}) -> (${r})${n}`}valueToString([t,r]){return`func "${t.toText()}".${r}`}display(){const t=this.argTypes.map(i=>i.display()).join(", "),r=this.retTypes.map(i=>i.display()).join(", "),n=" "+this.annotations.join(" ");return`(${t})  (${r})${n}`}encodeAnnotation(t){if(t==="query")return new Uint8Array([1]);if(t==="oneway")return new Uint8Array([2]);if(t==="composite_query")return new Uint8Array([3]);throw new Error("Illegal function annotation")}}class bo extends fr{constructor(t){super(),this._fields=Object.entries(t).sort((r,n)=>r[0]<n[0]?-1:r[0]>n[0]?1:0)}accept(t,r){return t.visitService(this,r)}covariant(t){if(t&&t._isPrincipal)return!0;throw new Error(`Invalid ${this.display()} argument: ${je(t)}`)}encodeValue(t){const r=t.toUint8Array(),n=$e(r.length);return Re(new Uint8Array([1]),n,r)}_buildTypeTableImpl(t){this._fields.forEach(([o,d])=>d.buildTypeTable(t));const r=Ke(-23),n=$e(this._fields.length),i=this._fields.map(([o,d])=>{const c=new TextEncoder().encode(o),w=$e(c.length);return Re(w,c,d.encodeType(t))});t.add(this,Re(r,n,...i))}decodeValue(t){return Ms(t)}get name(){return`service {${this._fields.map(([r,n])=>r+":"+n.name).join("; ")}}`}valueToString(t){return`service "${t.toText()}"`}}function je(e){const t=JSON.stringify(e,(r,n)=>typeof n=="bigint"?`BigInt(${n})`:n);return t&&t.length>ia?t.substring(0,ia-3)+"...":t}function hs(e,t){if(t.length<e.length)throw Error("Wrong number of message arguments");const r=new bf;e.forEach(w=>w.buildTypeTable(r));const n=new TextEncoder().encode(Mn),i=r.encode(),o=$e(t.length),d=Re(...e.map(w=>w.encodeType(r))),c=Re(...fn(e,t,(w,E)=>{try{w.covariant(E)}catch(A){throw new Error(A.message+`

`)}return w.encodeValue(E)}));return Re(n,i,o,d,c)}function _o(e,t){const r=new Dr(t);if(t.byteLength<Mn.length)throw new Error("Message length smaller than magic number");const n=mr(r,Mn.length),i=new TextDecoder().decode(n);if(i!==Mn)throw new Error("Wrong magic number: "+JSON.stringify(i));function o(N){const b=[],j=Number(Ye(N));for(let K=0;K<j;K++){const $=Number(Zt(N));switch($){case-18:case-19:{const ie=Number(Zt(N));b.push([$,ie]);break}case-20:case-21:{const ie=[];let C=Number(Ye(N)),Z;for(;C--;){const q=Number(Ye(N));if(q>=Math.pow(2,32))throw new Error("field id out of 32-bit range");if(typeof Z=="number"&&Z>=q)throw new Error("field id collision or not sorted");Z=q;const Q=Number(Zt(N));ie.push([q,Q])}b.push([$,ie]);break}case-22:{const ie=[];let C=Number(Ye(N));for(;C--;)ie.push(Number(Zt(N)));const Z=[];let q=Number(Ye(N));for(;q--;)Z.push(Number(Zt(N)));const Q=[];let re=Number(Ye(N));for(;re--;)switch(Number(Ye(N))){case 1:{Q.push("query");break}case 2:{Q.push("oneway");break}case 3:{Q.push("composite_query");break}default:throw new Error("unknown annotation")}b.push([$,[ie,Z,Q]]);break}case-23:{let ie=Number(Ye(N));const C=[];for(;ie--;){const Z=Number(Ye(N)),q=new TextDecoder().decode(mr(N,Z)),Q=Zt(N);C.push([q,Q])}b.push([$,C]);break}default:throw new Error("Illegal op_code: "+$)}}const V=[],W=Number(Ye(N));for(let K=0;K<W;K++)V.push(Number(Zt(N)));return[b,V]}const[d,c]=o(r);if(c.length<e.length)throw new Error("Wrong number of return values");const w=d.map(N=>Ho());function E(N){if(N<-24)throw new Error("future value not supported");if(N<0)switch(N){case-1:return vo;case-2:return To;case-3:return No;case-4:return Ao;case-5:return Po;case-6:return ko;case-7:return Co;case-8:return Mo;case-9:return Oo;case-10:return Ro;case-11:return Uo;case-12:return Fo;case-13:return So;case-14:return Io;case-15:return Bo;case-16:return xo;case-17:return Eo;case-24:return Vo;default:throw new Error("Illegal op_code: "+N)}if(N>=d.length)throw new Error("type index out of range");return w[N]}function A(N){switch(N[0]){case-19:{const b=E(N[1]);return qo(b)}case-18:{const b=E(N[1]);return jo(b)}case-20:{const b={};for(const[W,K]of N[1]){const $=`_${W}_`;b[$]=E(K)}const j=Go(b),V=j.tryAsTuple();return Array.isArray(V)?$o(...V):j}case-21:{const b={};for(const[j,V]of N[1]){const W=`_${j}_`;b[W]=E(V)}return Lo(b)}case-22:{const[b,j,V]=N[1];return Do(b.map(W=>E(W)),j.map(W=>E(W)),V)}case-23:{const b={},j=N[1];for(const[V,W]of j){let K=E(W);if(K instanceof lr&&(K=K.getType()),!(K instanceof Vs))throw new Error("Illegal service definition: services can only contain functions");b[V]=K}return Ko(b)}default:throw new Error("Illegal op_code: "+N[0])}}d.forEach((N,b)=>{if(N[0]===-22){const j=A(N);w[b].fill(j)}}),d.forEach((N,b)=>{if(N[0]!==-22){const j=A(N);w[b].fill(j)}});const I=c.map(N=>E(N)),S=e.map((N,b)=>N.decodeValue(r,I[b]));for(let N=e.length;N<I.length;N++)I[N].decodeValue(r,I[N]);if(r.byteLength>0)throw new Error("decode: Left-over bytes");return S}const Eo=new fo,xo=new ui,Ef=new lo,To=new ho,vo=new po,Bo=new yo,Ao=new go,No=new wo,So=new Cs(32),Io=new Cs(64),Oo=new _r(8),Ro=new _r(16),Uo=new _r(32),Fo=new _r(64),Po=new or(8),ko=new or(16),Co=new or(32),Mo=new or(64),Vo=new mo;function $o(...e){return new Ni(e)}function qo(e){return new Ai(e)}function jo(e){return new Gr(e)}function Go(e){return new bn(e)}function Lo(e){return new Si(e)}function Ho(){return new lr}function Do(e,t,r=[]){return new Vs(e,t,r)}function Ko(e){return new bo(e)}const xf=Object.freeze(Object.defineProperty({__proto__:null,Bool:To,BoolClass:ho,ConstructType:fr,Empty:Eo,EmptyClass:fo,FixedIntClass:_r,FixedNatClass:or,Float32:So,Float64:Io,FloatClass:Cs,Func:Do,FuncClass:Vs,Int:Ao,Int16:Ro,Int32:Uo,Int64:Fo,Int8:Oo,IntClass:go,Nat:No,Nat16:ko,Nat32:Co,Nat64:Mo,Nat8:Po,NatClass:wo,Null:vo,NullClass:po,Opt:jo,OptClass:Gr,PrimitiveType:wt,Principal:Vo,PrincipalClass:mo,Rec:Ho,RecClass:lr,Record:Go,RecordClass:bn,Reserved:xo,ReservedClass:ui,Service:Ko,ServiceClass:bo,Text:Bo,TextClass:yo,Tuple:$o,TupleClass:Ni,Type:Bi,Unknown:Ef,UnknownClass:lo,Variant:Lo,VariantClass:Si,Vec:qo,VecClass:Ai,Visitor:_f,decode:_o,encode:hs},Symbol.toStringTag,{value:"Module"}));var zo={},_n={};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(e){var t=wn,r=mn,n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=c,e.SlowBuffer=K,e.INSPECT_MAX_BYTES=50;var i=2147483647;e.kMaxLength=i,c.TYPED_ARRAY_SUPPORT=o(),!c.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{var p=new Uint8Array(1),a={foo:function(){return 42}};return Object.setPrototypeOf(a,Uint8Array.prototype),Object.setPrototypeOf(p,a),p.foo()===42}catch{return!1}}Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}});function d(p){if(p>i)throw new RangeError('The value "'+p+'" is invalid for option "size"');var a=new Uint8Array(p);return Object.setPrototypeOf(a,c.prototype),a}function c(p,a,u){if(typeof p=="number"){if(typeof a=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return I(p)}return w(p,a,u)}c.poolSize=8192;function w(p,a,u){if(typeof p=="string")return S(p,a);if(ArrayBuffer.isView(p))return b(p);if(p==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof p);if(x(p,ArrayBuffer)||p&&x(p.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(x(p,SharedArrayBuffer)||p&&x(p.buffer,SharedArrayBuffer)))return j(p,a,u);if(typeof p=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var g=p.valueOf&&p.valueOf();if(g!=null&&g!==p)return c.from(g,a,u);var T=V(p);if(T)return T;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof p[Symbol.toPrimitive]=="function")return c.from(p[Symbol.toPrimitive]("string"),a,u);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof p)}c.from=function(p,a,u){return w(p,a,u)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array);function E(p){if(typeof p!="number")throw new TypeError('"size" argument must be of type number');if(p<0)throw new RangeError('The value "'+p+'" is invalid for option "size"')}function A(p,a,u){return E(p),p<=0?d(p):a!==void 0?typeof u=="string"?d(p).fill(a,u):d(p).fill(a):d(p)}c.alloc=function(p,a,u){return A(p,a,u)};function I(p){return E(p),d(p<0?0:W(p)|0)}c.allocUnsafe=function(p){return I(p)},c.allocUnsafeSlow=function(p){return I(p)};function S(p,a){if((typeof a!="string"||a==="")&&(a="utf8"),!c.isEncoding(a))throw new TypeError("Unknown encoding: "+a);var u=$(p,a)|0,g=d(u),T=g.write(p,a);return T!==u&&(g=g.slice(0,T)),g}function N(p){for(var a=p.length<0?0:W(p.length)|0,u=d(a),g=0;g<a;g+=1)u[g]=p[g]&255;return u}function b(p){if(x(p,Uint8Array)){var a=new Uint8Array(p);return j(a.buffer,a.byteOffset,a.byteLength)}return N(p)}function j(p,a,u){if(a<0||p.byteLength<a)throw new RangeError('"offset" is outside of buffer bounds');if(p.byteLength<a+(u||0))throw new RangeError('"length" is outside of buffer bounds');var g;return a===void 0&&u===void 0?g=new Uint8Array(p):u===void 0?g=new Uint8Array(p,a):g=new Uint8Array(p,a,u),Object.setPrototypeOf(g,c.prototype),g}function V(p){if(c.isBuffer(p)){var a=W(p.length)|0,u=d(a);return u.length===0||p.copy(u,0,0,a),u}if(p.length!==void 0)return typeof p.length!="number"||v(p.length)?d(0):N(p);if(p.type==="Buffer"&&Array.isArray(p.data))return N(p.data)}function W(p){if(p>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return p|0}function K(p){return+p!=p&&(p=0),c.alloc(+p)}c.isBuffer=function(a){return a!=null&&a._isBuffer===!0&&a!==c.prototype},c.compare=function(a,u){if(x(a,Uint8Array)&&(a=c.from(a,a.offset,a.byteLength)),x(u,Uint8Array)&&(u=c.from(u,u.offset,u.byteLength)),!c.isBuffer(a)||!c.isBuffer(u))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(a===u)return 0;for(var g=a.length,T=u.length,O=0,L=Math.min(g,T);O<L;++O)if(a[O]!==u[O]){g=a[O],T=u[O];break}return g<T?-1:T<g?1:0},c.isEncoding=function(a){switch(String(a).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(a,u){if(!Array.isArray(a))throw new TypeError('"list" argument must be an Array of Buffers');if(a.length===0)return c.alloc(0);var g;if(u===void 0)for(u=0,g=0;g<a.length;++g)u+=a[g].length;var T=c.allocUnsafe(u),O=0;for(g=0;g<a.length;++g){var L=a[g];if(x(L,Uint8Array))O+L.length>T.length?c.from(L).copy(T,O):Uint8Array.prototype.set.call(T,L,O);else if(c.isBuffer(L))L.copy(T,O);else throw new TypeError('"list" argument must be an Array of Buffers');O+=L.length}return T};function $(p,a){if(c.isBuffer(p))return p.length;if(ArrayBuffer.isView(p)||x(p,ArrayBuffer))return p.byteLength;if(typeof p!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof p);var u=p.length,g=arguments.length>2&&arguments[2]===!0;if(!g&&u===0)return 0;for(var T=!1;;)switch(a){case"ascii":case"latin1":case"binary":return u;case"utf8":case"utf-8":return ne(p).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return u*2;case"hex":return u>>>1;case"base64":return s(p).length;default:if(T)return g?-1:ne(p).length;a=(""+a).toLowerCase(),T=!0}}c.byteLength=$;function ie(p,a,u){var g=!1;if((a===void 0||a<0)&&(a=0),a>this.length||((u===void 0||u>this.length)&&(u=this.length),u<=0)||(u>>>=0,a>>>=0,u<=a))return"";for(p||(p="utf8");;)switch(p){case"hex":return ee(this,a,u);case"utf8":case"utf-8":return P(this,a,u);case"ascii":return G(this,a,u);case"latin1":case"binary":return J(this,a,u);case"base64":return R(this,a,u);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ge(this,a,u);default:if(g)throw new TypeError("Unknown encoding: "+p);p=(p+"").toLowerCase(),g=!0}}c.prototype._isBuffer=!0;function C(p,a,u){var g=p[a];p[a]=p[u],p[u]=g}c.prototype.swap16=function(){var a=this.length;if(a%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var u=0;u<a;u+=2)C(this,u,u+1);return this},c.prototype.swap32=function(){var a=this.length;if(a%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var u=0;u<a;u+=4)C(this,u,u+3),C(this,u+1,u+2);return this},c.prototype.swap64=function(){var a=this.length;if(a%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var u=0;u<a;u+=8)C(this,u,u+7),C(this,u+1,u+6),C(this,u+2,u+5),C(this,u+3,u+4);return this},c.prototype.toString=function(){var a=this.length;return a===0?"":arguments.length===0?P(this,0,a):ie.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(a){if(!c.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a?!0:c.compare(this,a)===0},c.prototype.inspect=function(){var a="",u=e.INSPECT_MAX_BYTES;return a=this.toString("hex",0,u).replace(/(.{2})/g,"$1 ").trim(),this.length>u&&(a+=" ... "),"<Buffer "+a+">"},n&&(c.prototype[n]=c.prototype.inspect),c.prototype.compare=function(a,u,g,T,O){if(x(a,Uint8Array)&&(a=c.from(a,a.offset,a.byteLength)),!c.isBuffer(a))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof a);if(u===void 0&&(u=0),g===void 0&&(g=a?a.length:0),T===void 0&&(T=0),O===void 0&&(O=this.length),u<0||g>a.length||T<0||O>this.length)throw new RangeError("out of range index");if(T>=O&&u>=g)return 0;if(T>=O)return-1;if(u>=g)return 1;if(u>>>=0,g>>>=0,T>>>=0,O>>>=0,this===a)return 0;for(var L=O-T,Y=g-u,oe=Math.min(L,Y),pe=this.slice(T,O),me=a.slice(u,g),y=0;y<oe;++y)if(pe[y]!==me[y]){L=pe[y],Y=me[y];break}return L<Y?-1:Y<L?1:0};function Z(p,a,u,g,T){if(p.length===0)return-1;if(typeof u=="string"?(g=u,u=0):u>2147483647?u=2147483647:u<-2147483648&&(u=-2147483648),u=+u,v(u)&&(u=T?0:p.length-1),u<0&&(u=p.length+u),u>=p.length){if(T)return-1;u=p.length-1}else if(u<0)if(T)u=0;else return-1;if(typeof a=="string"&&(a=c.from(a,g)),c.isBuffer(a))return a.length===0?-1:q(p,a,u,g,T);if(typeof a=="number")return a=a&255,typeof Uint8Array.prototype.indexOf=="function"?T?Uint8Array.prototype.indexOf.call(p,a,u):Uint8Array.prototype.lastIndexOf.call(p,a,u):q(p,[a],u,g,T);throw new TypeError("val must be string, number or Buffer")}function q(p,a,u,g,T){var O=1,L=p.length,Y=a.length;if(g!==void 0&&(g=String(g).toLowerCase(),g==="ucs2"||g==="ucs-2"||g==="utf16le"||g==="utf-16le")){if(p.length<2||a.length<2)return-1;O=2,L/=2,Y/=2,u/=2}function oe(l,B){return O===1?l[B]:l.readUInt16BE(B*O)}var pe;if(T){var me=-1;for(pe=u;pe<L;pe++)if(oe(p,pe)===oe(a,me===-1?0:pe-me)){if(me===-1&&(me=pe),pe-me+1===Y)return me*O}else me!==-1&&(pe-=pe-me),me=-1}else for(u+Y>L&&(u=L-Y),pe=u;pe>=0;pe--){for(var y=!0,f=0;f<Y;f++)if(oe(p,pe+f)!==oe(a,f)){y=!1;break}if(y)return pe}return-1}c.prototype.includes=function(a,u,g){return this.indexOf(a,u,g)!==-1},c.prototype.indexOf=function(a,u,g){return Z(this,a,u,g,!0)},c.prototype.lastIndexOf=function(a,u,g){return Z(this,a,u,g,!1)};function Q(p,a,u,g){u=Number(u)||0;var T=p.length-u;g?(g=Number(g),g>T&&(g=T)):g=T;var O=a.length;g>O/2&&(g=O/2);for(var L=0;L<g;++L){var Y=parseInt(a.substr(L*2,2),16);if(v(Y))return L;p[u+L]=Y}return L}function re(p,a,u,g){return h(ne(a,p.length-u),p,u,g)}function X(p,a,u,g){return h(ce(a),p,u,g)}function de(p,a,u,g){return h(s(a),p,u,g)}function fe(p,a,u,g){return h(m(a,p.length-u),p,u,g)}c.prototype.write=function(a,u,g,T){if(u===void 0)T="utf8",g=this.length,u=0;else if(g===void 0&&typeof u=="string")T=u,g=this.length,u=0;else if(isFinite(u))u=u>>>0,isFinite(g)?(g=g>>>0,T===void 0&&(T="utf8")):(T=g,g=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var O=this.length-u;if((g===void 0||g>O)&&(g=O),a.length>0&&(g<0||u<0)||u>this.length)throw new RangeError("Attempt to write outside buffer bounds");T||(T="utf8");for(var L=!1;;)switch(T){case"hex":return Q(this,a,u,g);case"utf8":case"utf-8":return re(this,a,u,g);case"ascii":case"latin1":case"binary":return X(this,a,u,g);case"base64":return de(this,a,u,g);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return fe(this,a,u,g);default:if(L)throw new TypeError("Unknown encoding: "+T);T=(""+T).toLowerCase(),L=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function R(p,a,u){return a===0&&u===p.length?t.fromByteArray(p):t.fromByteArray(p.slice(a,u))}function P(p,a,u){u=Math.min(p.length,u);for(var g=[],T=a;T<u;){var O=p[T],L=null,Y=O>239?4:O>223?3:O>191?2:1;if(T+Y<=u){var oe,pe,me,y;switch(Y){case 1:O<128&&(L=O);break;case 2:oe=p[T+1],(oe&192)===128&&(y=(O&31)<<6|oe&63,y>127&&(L=y));break;case 3:oe=p[T+1],pe=p[T+2],(oe&192)===128&&(pe&192)===128&&(y=(O&15)<<12|(oe&63)<<6|pe&63,y>2047&&(y<55296||y>57343)&&(L=y));break;case 4:oe=p[T+1],pe=p[T+2],me=p[T+3],(oe&192)===128&&(pe&192)===128&&(me&192)===128&&(y=(O&15)<<18|(oe&63)<<12|(pe&63)<<6|me&63,y>65535&&y<1114112&&(L=y))}}L===null?(L=65533,Y=1):L>65535&&(L-=65536,g.push(L>>>10&1023|55296),L=56320|L&1023),g.push(L),T+=Y}return M(g)}var z=4096;function M(p){var a=p.length;if(a<=z)return String.fromCharCode.apply(String,p);for(var u="",g=0;g<a;)u+=String.fromCharCode.apply(String,p.slice(g,g+=z));return u}function G(p,a,u){var g="";u=Math.min(p.length,u);for(var T=a;T<u;++T)g+=String.fromCharCode(p[T]&127);return g}function J(p,a,u){var g="";u=Math.min(p.length,u);for(var T=a;T<u;++T)g+=String.fromCharCode(p[T]);return g}function ee(p,a,u){var g=p.length;(!a||a<0)&&(a=0),(!u||u<0||u>g)&&(u=g);for(var T="",O=a;O<u;++O)T+=U[p[O]];return T}function ge(p,a,u){for(var g=p.slice(a,u),T="",O=0;O<g.length-1;O+=2)T+=String.fromCharCode(g[O]+g[O+1]*256);return T}c.prototype.slice=function(a,u){var g=this.length;a=~~a,u=u===void 0?g:~~u,a<0?(a+=g,a<0&&(a=0)):a>g&&(a=g),u<0?(u+=g,u<0&&(u=0)):u>g&&(u=g),u<a&&(u=a);var T=this.subarray(a,u);return Object.setPrototypeOf(T,c.prototype),T};function ae(p,a,u){if(p%1!==0||p<0)throw new RangeError("offset is not uint");if(p+a>u)throw new RangeError("Trying to access beyond buffer length")}c.prototype.readUintLE=c.prototype.readUIntLE=function(a,u,g){a=a>>>0,u=u>>>0,g||ae(a,u,this.length);for(var T=this[a],O=1,L=0;++L<u&&(O*=256);)T+=this[a+L]*O;return T},c.prototype.readUintBE=c.prototype.readUIntBE=function(a,u,g){a=a>>>0,u=u>>>0,g||ae(a,u,this.length);for(var T=this[a+--u],O=1;u>0&&(O*=256);)T+=this[a+--u]*O;return T},c.prototype.readUint8=c.prototype.readUInt8=function(a,u){return a=a>>>0,u||ae(a,1,this.length),this[a]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(a,u){return a=a>>>0,u||ae(a,2,this.length),this[a]|this[a+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(a,u){return a=a>>>0,u||ae(a,2,this.length),this[a]<<8|this[a+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(a,u){return a=a>>>0,u||ae(a,4,this.length),(this[a]|this[a+1]<<8|this[a+2]<<16)+this[a+3]*16777216},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(a,u){return a=a>>>0,u||ae(a,4,this.length),this[a]*16777216+(this[a+1]<<16|this[a+2]<<8|this[a+3])},c.prototype.readIntLE=function(a,u,g){a=a>>>0,u=u>>>0,g||ae(a,u,this.length);for(var T=this[a],O=1,L=0;++L<u&&(O*=256);)T+=this[a+L]*O;return O*=128,T>=O&&(T-=Math.pow(2,8*u)),T},c.prototype.readIntBE=function(a,u,g){a=a>>>0,u=u>>>0,g||ae(a,u,this.length);for(var T=u,O=1,L=this[a+--T];T>0&&(O*=256);)L+=this[a+--T]*O;return O*=128,L>=O&&(L-=Math.pow(2,8*u)),L},c.prototype.readInt8=function(a,u){return a=a>>>0,u||ae(a,1,this.length),this[a]&128?(255-this[a]+1)*-1:this[a]},c.prototype.readInt16LE=function(a,u){a=a>>>0,u||ae(a,2,this.length);var g=this[a]|this[a+1]<<8;return g&32768?g|4294901760:g},c.prototype.readInt16BE=function(a,u){a=a>>>0,u||ae(a,2,this.length);var g=this[a+1]|this[a]<<8;return g&32768?g|4294901760:g},c.prototype.readInt32LE=function(a,u){return a=a>>>0,u||ae(a,4,this.length),this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24},c.prototype.readInt32BE=function(a,u){return a=a>>>0,u||ae(a,4,this.length),this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]},c.prototype.readFloatLE=function(a,u){return a=a>>>0,u||ae(a,4,this.length),r.read(this,a,!0,23,4)},c.prototype.readFloatBE=function(a,u){return a=a>>>0,u||ae(a,4,this.length),r.read(this,a,!1,23,4)},c.prototype.readDoubleLE=function(a,u){return a=a>>>0,u||ae(a,8,this.length),r.read(this,a,!0,52,8)},c.prototype.readDoubleBE=function(a,u){return a=a>>>0,u||ae(a,8,this.length),r.read(this,a,!1,52,8)};function le(p,a,u,g,T,O){if(!c.isBuffer(p))throw new TypeError('"buffer" argument must be a Buffer instance');if(a>T||a<O)throw new RangeError('"value" argument is out of bounds');if(u+g>p.length)throw new RangeError("Index out of range")}c.prototype.writeUintLE=c.prototype.writeUIntLE=function(a,u,g,T){if(a=+a,u=u>>>0,g=g>>>0,!T){var O=Math.pow(2,8*g)-1;le(this,a,u,g,O,0)}var L=1,Y=0;for(this[u]=a&255;++Y<g&&(L*=256);)this[u+Y]=a/L&255;return u+g},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(a,u,g,T){if(a=+a,u=u>>>0,g=g>>>0,!T){var O=Math.pow(2,8*g)-1;le(this,a,u,g,O,0)}var L=g-1,Y=1;for(this[u+L]=a&255;--L>=0&&(Y*=256);)this[u+L]=a/Y&255;return u+g},c.prototype.writeUint8=c.prototype.writeUInt8=function(a,u,g){return a=+a,u=u>>>0,g||le(this,a,u,1,255,0),this[u]=a&255,u+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(a,u,g){return a=+a,u=u>>>0,g||le(this,a,u,2,65535,0),this[u]=a&255,this[u+1]=a>>>8,u+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(a,u,g){return a=+a,u=u>>>0,g||le(this,a,u,2,65535,0),this[u]=a>>>8,this[u+1]=a&255,u+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(a,u,g){return a=+a,u=u>>>0,g||le(this,a,u,4,4294967295,0),this[u+3]=a>>>24,this[u+2]=a>>>16,this[u+1]=a>>>8,this[u]=a&255,u+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(a,u,g){return a=+a,u=u>>>0,g||le(this,a,u,4,4294967295,0),this[u]=a>>>24,this[u+1]=a>>>16,this[u+2]=a>>>8,this[u+3]=a&255,u+4},c.prototype.writeIntLE=function(a,u,g,T){if(a=+a,u=u>>>0,!T){var O=Math.pow(2,8*g-1);le(this,a,u,g,O-1,-O)}var L=0,Y=1,oe=0;for(this[u]=a&255;++L<g&&(Y*=256);)a<0&&oe===0&&this[u+L-1]!==0&&(oe=1),this[u+L]=(a/Y>>0)-oe&255;return u+g},c.prototype.writeIntBE=function(a,u,g,T){if(a=+a,u=u>>>0,!T){var O=Math.pow(2,8*g-1);le(this,a,u,g,O-1,-O)}var L=g-1,Y=1,oe=0;for(this[u+L]=a&255;--L>=0&&(Y*=256);)a<0&&oe===0&&this[u+L+1]!==0&&(oe=1),this[u+L]=(a/Y>>0)-oe&255;return u+g},c.prototype.writeInt8=function(a,u,g){return a=+a,u=u>>>0,g||le(this,a,u,1,127,-128),a<0&&(a=255+a+1),this[u]=a&255,u+1},c.prototype.writeInt16LE=function(a,u,g){return a=+a,u=u>>>0,g||le(this,a,u,2,32767,-32768),this[u]=a&255,this[u+1]=a>>>8,u+2},c.prototype.writeInt16BE=function(a,u,g){return a=+a,u=u>>>0,g||le(this,a,u,2,32767,-32768),this[u]=a>>>8,this[u+1]=a&255,u+2},c.prototype.writeInt32LE=function(a,u,g){return a=+a,u=u>>>0,g||le(this,a,u,4,2147483647,-2147483648),this[u]=a&255,this[u+1]=a>>>8,this[u+2]=a>>>16,this[u+3]=a>>>24,u+4},c.prototype.writeInt32BE=function(a,u,g){return a=+a,u=u>>>0,g||le(this,a,u,4,2147483647,-2147483648),a<0&&(a=4294967295+a+1),this[u]=a>>>24,this[u+1]=a>>>16,this[u+2]=a>>>8,this[u+3]=a&255,u+4};function te(p,a,u,g,T,O){if(u+g>p.length)throw new RangeError("Index out of range");if(u<0)throw new RangeError("Index out of range")}function _(p,a,u,g,T){return a=+a,u=u>>>0,T||te(p,a,u,4),r.write(p,a,u,g,23,4),u+4}c.prototype.writeFloatLE=function(a,u,g){return _(this,a,u,!0,g)},c.prototype.writeFloatBE=function(a,u,g){return _(this,a,u,!1,g)};function se(p,a,u,g,T){return a=+a,u=u>>>0,T||te(p,a,u,8),r.write(p,a,u,g,52,8),u+8}c.prototype.writeDoubleLE=function(a,u,g){return se(this,a,u,!0,g)},c.prototype.writeDoubleBE=function(a,u,g){return se(this,a,u,!1,g)},c.prototype.copy=function(a,u,g,T){if(!c.isBuffer(a))throw new TypeError("argument should be a Buffer");if(g||(g=0),!T&&T!==0&&(T=this.length),u>=a.length&&(u=a.length),u||(u=0),T>0&&T<g&&(T=g),T===g||a.length===0||this.length===0)return 0;if(u<0)throw new RangeError("targetStart out of bounds");if(g<0||g>=this.length)throw new RangeError("Index out of range");if(T<0)throw new RangeError("sourceEnd out of bounds");T>this.length&&(T=this.length),a.length-u<T-g&&(T=a.length-u+g);var O=T-g;return this===a&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(u,g,T):Uint8Array.prototype.set.call(a,this.subarray(g,T),u),O},c.prototype.fill=function(a,u,g,T){if(typeof a=="string"){if(typeof u=="string"?(T=u,u=0,g=this.length):typeof g=="string"&&(T=g,g=this.length),T!==void 0&&typeof T!="string")throw new TypeError("encoding must be a string");if(typeof T=="string"&&!c.isEncoding(T))throw new TypeError("Unknown encoding: "+T);if(a.length===1){var O=a.charCodeAt(0);(T==="utf8"&&O<128||T==="latin1")&&(a=O)}}else typeof a=="number"?a=a&255:typeof a=="boolean"&&(a=Number(a));if(u<0||this.length<u||this.length<g)throw new RangeError("Out of range index");if(g<=u)return this;u=u>>>0,g=g===void 0?this.length:g>>>0,a||(a=0);var L;if(typeof a=="number")for(L=u;L<g;++L)this[L]=a;else{var Y=c.isBuffer(a)?a:c.from(a,T),oe=Y.length;if(oe===0)throw new TypeError('The value "'+a+'" is invalid for argument "value"');for(L=0;L<g-u;++L)this[L+u]=Y[L%oe]}return this};var ue=/[^+/0-9A-Za-z-_]/g;function he(p){if(p=p.split("=")[0],p=p.trim().replace(ue,""),p.length<2)return"";for(;p.length%4!==0;)p=p+"=";return p}function ne(p,a){a=a||1/0;for(var u,g=p.length,T=null,O=[],L=0;L<g;++L){if(u=p.charCodeAt(L),u>55295&&u<57344){if(!T){if(u>56319){(a-=3)>-1&&O.push(239,191,189);continue}else if(L+1===g){(a-=3)>-1&&O.push(239,191,189);continue}T=u;continue}if(u<56320){(a-=3)>-1&&O.push(239,191,189),T=u;continue}u=(T-55296<<10|u-56320)+65536}else T&&(a-=3)>-1&&O.push(239,191,189);if(T=null,u<128){if((a-=1)<0)break;O.push(u)}else if(u<2048){if((a-=2)<0)break;O.push(u>>6|192,u&63|128)}else if(u<65536){if((a-=3)<0)break;O.push(u>>12|224,u>>6&63|128,u&63|128)}else if(u<1114112){if((a-=4)<0)break;O.push(u>>18|240,u>>12&63|128,u>>6&63|128,u&63|128)}else throw new Error("Invalid code point")}return O}function ce(p){for(var a=[],u=0;u<p.length;++u)a.push(p.charCodeAt(u)&255);return a}function m(p,a){for(var u,g,T,O=[],L=0;L<p.length&&!((a-=2)<0);++L)u=p.charCodeAt(L),g=u>>8,T=u%256,O.push(T),O.push(g);return O}function s(p){return t.toByteArray(he(p))}function h(p,a,u,g){for(var T=0;T<g&&!(T+u>=a.length||T>=p.length);++T)a[T+u]=p[T];return T}function x(p,a){return p instanceof a||p!=null&&p.constructor!=null&&p.constructor.name!=null&&p.constructor.name===a.name}function v(p){return p!==p}var U=function(){for(var p="0123456789abcdef",a=new Array(256),u=0;u<16;++u)for(var g=u*16,T=0;T<16;++T)a[g+T]=p[u]+p[T];return a}()})(_n);var Wo={exports:{}};(function(e){(function(t){var r,n=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,o=Math.floor,d="[BigNumber Error] ",c=d+"Number primitive has more than 15 significant digits: ",w=1e14,E=14,A=9007199254740991,I=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],S=1e7,N=1e9;function b(Z){var q,Q,re,X=_.prototype={constructor:_,toString:null,valueOf:null},de=new _(1),fe=20,R=4,P=-7,z=21,M=-1e7,G=1e7,J=!1,ee=1,ge=0,ae={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},le="0123456789abcdefghijklmnopqrstuvwxyz",te=!0;function _(m,s){var h,x,v,U,p,a,u,g,T=this;if(!(T instanceof _))return new _(m,s);if(s==null){if(m&&m._isBigNumber===!0){T.s=m.s,!m.c||m.e>G?T.c=T.e=null:m.e<M?T.c=[T.e=0]:(T.e=m.e,T.c=m.c.slice());return}if((a=typeof m=="number")&&m*0==0){if(T.s=1/m<0?(m=-m,-1):1,m===~~m){for(U=0,p=m;p>=10;p/=10,U++);U>G?T.c=T.e=null:(T.e=U,T.c=[m]);return}g=String(m)}else{if(!n.test(g=String(m)))return re(T,g,a);T.s=g.charCodeAt(0)==45?(g=g.slice(1),-1):1}(U=g.indexOf("."))>-1&&(g=g.replace(".","")),(p=g.search(/e/i))>0?(U<0&&(U=p),U+=+g.slice(p+1),g=g.substring(0,p)):U<0&&(U=g.length)}else{if(K(s,2,le.length,"Base"),s==10&&te)return T=new _(m),ne(T,fe+T.e+1,R);if(g=String(m),a=typeof m=="number"){if(m*0!=0)return re(T,g,a,s);if(T.s=1/m<0?(g=g.slice(1),-1):1,_.DEBUG&&g.replace(/^0\.0*|\./,"").length>15)throw Error(c+m)}else T.s=g.charCodeAt(0)===45?(g=g.slice(1),-1):1;for(h=le.slice(0,s),U=p=0,u=g.length;p<u;p++)if(h.indexOf(x=g.charAt(p))<0){if(x=="."){if(p>U){U=u;continue}}else if(!v&&(g==g.toUpperCase()&&(g=g.toLowerCase())||g==g.toLowerCase()&&(g=g.toUpperCase()))){v=!0,p=-1,U=0;continue}return re(T,String(m),a,s)}a=!1,g=Q(g,s,10,T.s),(U=g.indexOf("."))>-1?g=g.replace(".",""):U=g.length}for(p=0;g.charCodeAt(p)===48;p++);for(u=g.length;g.charCodeAt(--u)===48;);if(g=g.slice(p,++u)){if(u-=p,a&&_.DEBUG&&u>15&&(m>A||m!==o(m)))throw Error(c+T.s*m);if((U=U-p-1)>G)T.c=T.e=null;else if(U<M)T.c=[T.e=0];else{if(T.e=U,T.c=[],p=(U+1)%E,U<0&&(p+=E),p<u){for(p&&T.c.push(+g.slice(0,p)),u-=E;p<u;)T.c.push(+g.slice(p,p+=E));p=E-(g=g.slice(p)).length}else p-=u;for(;p--;g+="0");T.c.push(+g)}}else T.c=[T.e=0]}_.clone=b,_.ROUND_UP=0,_.ROUND_DOWN=1,_.ROUND_CEIL=2,_.ROUND_FLOOR=3,_.ROUND_HALF_UP=4,_.ROUND_HALF_DOWN=5,_.ROUND_HALF_EVEN=6,_.ROUND_HALF_CEIL=7,_.ROUND_HALF_FLOOR=8,_.EUCLID=9,_.config=_.set=function(m){var s,h;if(m!=null)if(typeof m=="object"){if(m.hasOwnProperty(s="DECIMAL_PLACES")&&(h=m[s],K(h,0,N,s),fe=h),m.hasOwnProperty(s="ROUNDING_MODE")&&(h=m[s],K(h,0,8,s),R=h),m.hasOwnProperty(s="EXPONENTIAL_AT")&&(h=m[s],h&&h.pop?(K(h[0],-1e9,0,s),K(h[1],0,N,s),P=h[0],z=h[1]):(K(h,-1e9,N,s),P=-(z=h<0?-h:h))),m.hasOwnProperty(s="RANGE"))if(h=m[s],h&&h.pop)K(h[0],-1e9,-1,s),K(h[1],1,N,s),M=h[0],G=h[1];else if(K(h,-1e9,N,s),h)M=-(G=h<0?-h:h);else throw Error(d+s+" cannot be zero: "+h);if(m.hasOwnProperty(s="CRYPTO"))if(h=m[s],h===!!h)if(h)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))J=h;else throw J=!h,Error(d+"crypto unavailable");else J=h;else throw Error(d+s+" not true or false: "+h);if(m.hasOwnProperty(s="MODULO_MODE")&&(h=m[s],K(h,0,9,s),ee=h),m.hasOwnProperty(s="POW_PRECISION")&&(h=m[s],K(h,0,N,s),ge=h),m.hasOwnProperty(s="FORMAT"))if(h=m[s],typeof h=="object")ae=h;else throw Error(d+s+" not an object: "+h);if(m.hasOwnProperty(s="ALPHABET"))if(h=m[s],typeof h=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(h))te=h.slice(0,10)=="0123456789",le=h;else throw Error(d+s+" invalid: "+h)}else throw Error(d+"Object expected: "+m);return{DECIMAL_PLACES:fe,ROUNDING_MODE:R,EXPONENTIAL_AT:[P,z],RANGE:[M,G],CRYPTO:J,MODULO_MODE:ee,POW_PRECISION:ge,FORMAT:ae,ALPHABET:le}},_.isBigNumber=function(m){if(!m||m._isBigNumber!==!0)return!1;if(!_.DEBUG)return!0;var s,h,x=m.c,v=m.e,U=m.s;e:if({}.toString.call(x)=="[object Array]"){if((U===1||U===-1)&&v>=-1e9&&v<=N&&v===o(v)){if(x[0]===0){if(v===0&&x.length===1)return!0;break e}if(s=(v+1)%E,s<1&&(s+=E),String(x[0]).length==s){for(s=0;s<x.length;s++)if(h=x[s],h<0||h>=w||h!==o(h))break e;if(h!==0)return!0}}}else if(x===null&&v===null&&(U===null||U===1||U===-1))return!0;throw Error(d+"Invalid BigNumber: "+m)},_.maximum=_.max=function(){return ue(arguments,-1)},_.minimum=_.min=function(){return ue(arguments,1)},_.random=function(){var m=9007199254740992,s=Math.random()*m&2097151?function(){return o(Math.random()*m)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(h){var x,v,U,p,a,u=0,g=[],T=new _(de);if(h==null?h=fe:K(h,0,N),p=i(h/E),J)if(crypto.getRandomValues){for(x=crypto.getRandomValues(new Uint32Array(p*=2));u<p;)a=x[u]*131072+(x[u+1]>>>11),a>=9e15?(v=crypto.getRandomValues(new Uint32Array(2)),x[u]=v[0],x[u+1]=v[1]):(g.push(a%1e14),u+=2);u=p/2}else if(crypto.randomBytes){for(x=crypto.randomBytes(p*=7);u<p;)a=(x[u]&31)*281474976710656+x[u+1]*1099511627776+x[u+2]*4294967296+x[u+3]*16777216+(x[u+4]<<16)+(x[u+5]<<8)+x[u+6],a>=9e15?crypto.randomBytes(7).copy(x,u):(g.push(a%1e14),u+=7);u=p/7}else throw J=!1,Error(d+"crypto unavailable");if(!J)for(;u<p;)a=s(),a<9e15&&(g[u++]=a%1e14);for(p=g[--u],h%=E,p&&h&&(a=I[E-h],g[u]=o(p/a)*a);g[u]===0;g.pop(),u--);if(u<0)g=[U=0];else{for(U=-1;g[0]===0;g.splice(0,1),U-=E);for(u=1,a=g[0];a>=10;a/=10,u++);u<E&&(U-=E-u)}return T.e=U,T.c=g,T}}(),_.sum=function(){for(var m=1,s=arguments,h=new _(s[0]);m<s.length;)h=h.plus(s[m++]);return h},Q=function(){var m="0123456789";function s(h,x,v,U){for(var p,a=[0],u,g=0,T=h.length;g<T;){for(u=a.length;u--;a[u]*=x);for(a[0]+=U.indexOf(h.charAt(g++)),p=0;p<a.length;p++)a[p]>v-1&&(a[p+1]==null&&(a[p+1]=0),a[p+1]+=a[p]/v|0,a[p]%=v)}return a.reverse()}return function(h,x,v,U,p){var a,u,g,T,O,L,Y,oe,pe=h.indexOf("."),me=fe,y=R;for(pe>=0&&(T=ge,ge=0,h=h.replace(".",""),oe=new _(x),L=oe.pow(h.length-pe),ge=T,oe.c=s(C(V(L.c),L.e,"0"),10,v,m),oe.e=oe.c.length),Y=s(h,x,v,p?(a=le,m):(a=m,le)),g=T=Y.length;Y[--T]==0;Y.pop());if(!Y[0])return a.charAt(0);if(pe<0?--g:(L.c=Y,L.e=g,L.s=U,L=q(L,oe,me,y,v),Y=L.c,O=L.r,g=L.e),u=g+me+1,pe=Y[u],T=v/2,O=O||u<0||Y[u+1]!=null,O=y<4?(pe!=null||O)&&(y==0||y==(L.s<0?3:2)):pe>T||pe==T&&(y==4||O||y==6&&Y[u-1]&1||y==(L.s<0?8:7)),u<1||!Y[0])h=O?C(a.charAt(1),-me,a.charAt(0)):a.charAt(0);else{if(Y.length=u,O)for(--v;++Y[--u]>v;)Y[u]=0,u||(++g,Y=[1].concat(Y));for(T=Y.length;!Y[--T];);for(pe=0,h="";pe<=T;h+=a.charAt(Y[pe++]));h=C(h,g,a.charAt(0))}return h}}(),q=function(){function m(x,v,U){var p,a,u,g,T=0,O=x.length,L=v%S,Y=v/S|0;for(x=x.slice();O--;)u=x[O]%S,g=x[O]/S|0,p=Y*u+g*L,a=L*u+p%S*S+T,T=(a/U|0)+(p/S|0)+Y*g,x[O]=a%U;return T&&(x=[T].concat(x)),x}function s(x,v,U,p){var a,u;if(U!=p)u=U>p?1:-1;else for(a=u=0;a<U;a++)if(x[a]!=v[a]){u=x[a]>v[a]?1:-1;break}return u}function h(x,v,U,p){for(var a=0;U--;)x[U]-=a,a=x[U]<v[U]?1:0,x[U]=a*p+x[U]-v[U];for(;!x[0]&&x.length>1;x.splice(0,1));}return function(x,v,U,p,a){var u,g,T,O,L,Y,oe,pe,me,y,f,l,B,k,D,H,_e,Te=x.s==v.s?1:-1,xe=x.c,Ee=v.c;if(!xe||!xe[0]||!Ee||!Ee[0])return new _(!x.s||!v.s||(xe?Ee&&xe[0]==Ee[0]:!Ee)?NaN:xe&&xe[0]==0||!Ee?Te*0:Te/0);for(pe=new _(Te),me=pe.c=[],g=x.e-v.e,Te=U+g+1,a||(a=w,g=j(x.e/E)-j(v.e/E),Te=Te/E|0),T=0;Ee[T]==(xe[T]||0);T++);if(Ee[T]>(xe[T]||0)&&g--,Te<0)me.push(1),O=!0;else{for(k=xe.length,H=Ee.length,T=0,Te+=2,L=o(a/(Ee[0]+1)),L>1&&(Ee=m(Ee,L,a),xe=m(xe,L,a),H=Ee.length,k=xe.length),B=H,y=xe.slice(0,H),f=y.length;f<H;y[f++]=0);_e=Ee.slice(),_e=[0].concat(_e),D=Ee[0],Ee[1]>=a/2&&D++;do{if(L=0,u=s(Ee,y,H,f),u<0){if(l=y[0],H!=f&&(l=l*a+(y[1]||0)),L=o(l/D),L>1)for(L>=a&&(L=a-1),Y=m(Ee,L,a),oe=Y.length,f=y.length;s(Y,y,oe,f)==1;)L--,h(Y,H<oe?_e:Ee,oe,a),oe=Y.length,u=1;else L==0&&(u=L=1),Y=Ee.slice(),oe=Y.length;if(oe<f&&(Y=[0].concat(Y)),h(y,Y,f,a),f=y.length,u==-1)for(;s(Ee,y,H,f)<1;)L++,h(y,H<f?_e:Ee,f,a),f=y.length}else u===0&&(L++,y=[0]);me[T++]=L,y[0]?y[f++]=xe[B]||0:(y=[xe[B]],f=1)}while((B++<k||y[0]!=null)&&Te--);O=y[0]!=null,me[0]||me.splice(0,1)}if(a==w){for(T=1,Te=me[0];Te>=10;Te/=10,T++);ne(pe,U+(pe.e=T+g*E-1)+1,p,O)}else pe.e=g,pe.r=+O;return pe}}();function se(m,s,h,x){var v,U,p,a,u;if(h==null?h=R:K(h,0,8),!m.c)return m.toString();if(v=m.c[0],p=m.e,s==null)u=V(m.c),u=x==1||x==2&&(p<=P||p>=z)?ie(u,p):C(u,p,"0");else if(m=ne(new _(m),s,h),U=m.e,u=V(m.c),a=u.length,x==1||x==2&&(s<=U||U<=P)){for(;a<s;u+="0",a++);u=ie(u,U)}else if(s-=p,u=C(u,U,"0"),U+1>a){if(--s>0)for(u+=".";s--;u+="0");}else if(s+=U-a,s>0)for(U+1==a&&(u+=".");s--;u+="0");return m.s<0&&v?"-"+u:u}function ue(m,s){for(var h,x,v=1,U=new _(m[0]);v<m.length;v++)x=new _(m[v]),(!x.s||(h=W(U,x))===s||h===0&&U.s===s)&&(U=x);return U}function he(m,s,h){for(var x=1,v=s.length;!s[--v];s.pop());for(v=s[0];v>=10;v/=10,x++);return(h=x+h*E-1)>G?m.c=m.e=null:h<M?m.c=[m.e=0]:(m.e=h,m.c=s),m}re=function(){var m=/^(-?)0([xbo])(?=\w[\w.]*$)/i,s=/^([^.]+)\.$/,h=/^\.([^.]+)$/,x=/^-?(Infinity|NaN)$/,v=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(U,p,a,u){var g,T=a?p:p.replace(v,"");if(x.test(T))U.s=isNaN(T)?null:T<0?-1:1;else{if(!a&&(T=T.replace(m,function(O,L,Y){return g=(Y=Y.toLowerCase())=="x"?16:Y=="b"?2:8,!u||u==g?L:O}),u&&(g=u,T=T.replace(s,"$1").replace(h,"0.$1")),p!=T))return new _(T,g);if(_.DEBUG)throw Error(d+"Not a"+(u?" base "+u:"")+" number: "+p);U.s=null}U.c=U.e=null}}();function ne(m,s,h,x){var v,U,p,a,u,g,T,O=m.c,L=I;if(O){e:{for(v=1,a=O[0];a>=10;a/=10,v++);if(U=s-v,U<0)U+=E,p=s,u=O[g=0],T=o(u/L[v-p-1]%10);else if(g=i((U+1)/E),g>=O.length)if(x){for(;O.length<=g;O.push(0));u=T=0,v=1,U%=E,p=U-E+1}else break e;else{for(u=a=O[g],v=1;a>=10;a/=10,v++);U%=E,p=U-E+v,T=p<0?0:o(u/L[v-p-1]%10)}if(x=x||s<0||O[g+1]!=null||(p<0?u:u%L[v-p-1]),x=h<4?(T||x)&&(h==0||h==(m.s<0?3:2)):T>5||T==5&&(h==4||x||h==6&&(U>0?p>0?u/L[v-p]:0:O[g-1])%10&1||h==(m.s<0?8:7)),s<1||!O[0])return O.length=0,x?(s-=m.e+1,O[0]=L[(E-s%E)%E],m.e=-s||0):O[0]=m.e=0,m;if(U==0?(O.length=g,a=1,g--):(O.length=g+1,a=L[E-U],O[g]=p>0?o(u/L[v-p]%L[p])*a:0),x)for(;;)if(g==0){for(U=1,p=O[0];p>=10;p/=10,U++);for(p=O[0]+=a,a=1;p>=10;p/=10,a++);U!=a&&(m.e++,O[0]==w&&(O[0]=1));break}else{if(O[g]+=a,O[g]!=w)break;O[g--]=0,a=1}for(U=O.length;O[--U]===0;O.pop());}m.e>G?m.c=m.e=null:m.e<M&&(m.c=[m.e=0])}return m}function ce(m){var s,h=m.e;return h===null?m.toString():(s=V(m.c),s=h<=P||h>=z?ie(s,h):C(s,h,"0"),m.s<0?"-"+s:s)}return X.absoluteValue=X.abs=function(){var m=new _(this);return m.s<0&&(m.s=1),m},X.comparedTo=function(m,s){return W(this,new _(m,s))},X.decimalPlaces=X.dp=function(m,s){var h,x,v,U=this;if(m!=null)return K(m,0,N),s==null?s=R:K(s,0,8),ne(new _(U),m+U.e+1,s);if(!(h=U.c))return null;if(x=((v=h.length-1)-j(this.e/E))*E,v=h[v])for(;v%10==0;v/=10,x--);return x<0&&(x=0),x},X.dividedBy=X.div=function(m,s){return q(this,new _(m,s),fe,R)},X.dividedToIntegerBy=X.idiv=function(m,s){return q(this,new _(m,s),0,1)},X.exponentiatedBy=X.pow=function(m,s){var h,x,v,U,p,a,u,g,T,O=this;if(m=new _(m),m.c&&!m.isInteger())throw Error(d+"Exponent not an integer: "+ce(m));if(s!=null&&(s=new _(s)),a=m.e>14,!O.c||!O.c[0]||O.c[0]==1&&!O.e&&O.c.length==1||!m.c||!m.c[0])return T=new _(Math.pow(+ce(O),a?m.s*(2-$(m)):+ce(m))),s?T.mod(s):T;if(u=m.s<0,s){if(s.c?!s.c[0]:!s.s)return new _(NaN);x=!u&&O.isInteger()&&s.isInteger(),x&&(O=O.mod(s))}else{if(m.e>9&&(O.e>0||O.e<-1||(O.e==0?O.c[0]>1||a&&O.c[1]>=24e7:O.c[0]<8e13||a&&O.c[0]<=9999975e7)))return U=O.s<0&&$(m)?-0:0,O.e>-1&&(U=1/U),new _(u?1/U:U);ge&&(U=i(ge/E+2))}for(a?(h=new _(.5),u&&(m.s=1),g=$(m)):(v=Math.abs(+ce(m)),g=v%2),T=new _(de);;){if(g){if(T=T.times(O),!T.c)break;U?T.c.length>U&&(T.c.length=U):x&&(T=T.mod(s))}if(v){if(v=o(v/2),v===0)break;g=v%2}else if(m=m.times(h),ne(m,m.e+1,1),m.e>14)g=$(m);else{if(v=+ce(m),v===0)break;g=v%2}O=O.times(O),U?O.c&&O.c.length>U&&(O.c.length=U):x&&(O=O.mod(s))}return x?T:(u&&(T=de.div(T)),s?T.mod(s):U?ne(T,ge,R,p):T)},X.integerValue=function(m){var s=new _(this);return m==null?m=R:K(m,0,8),ne(s,s.e+1,m)},X.isEqualTo=X.eq=function(m,s){return W(this,new _(m,s))===0},X.isFinite=function(){return!!this.c},X.isGreaterThan=X.gt=function(m,s){return W(this,new _(m,s))>0},X.isGreaterThanOrEqualTo=X.gte=function(m,s){return(s=W(this,new _(m,s)))===1||s===0},X.isInteger=function(){return!!this.c&&j(this.e/E)>this.c.length-2},X.isLessThan=X.lt=function(m,s){return W(this,new _(m,s))<0},X.isLessThanOrEqualTo=X.lte=function(m,s){return(s=W(this,new _(m,s)))===-1||s===0},X.isNaN=function(){return!this.s},X.isNegative=function(){return this.s<0},X.isPositive=function(){return this.s>0},X.isZero=function(){return!!this.c&&this.c[0]==0},X.minus=function(m,s){var h,x,v,U,p=this,a=p.s;if(m=new _(m,s),s=m.s,!a||!s)return new _(NaN);if(a!=s)return m.s=-s,p.plus(m);var u=p.e/E,g=m.e/E,T=p.c,O=m.c;if(!u||!g){if(!T||!O)return T?(m.s=-s,m):new _(O?p:NaN);if(!T[0]||!O[0])return O[0]?(m.s=-s,m):new _(T[0]?p:R==3?-0:0)}if(u=j(u),g=j(g),T=T.slice(),a=u-g){for((U=a<0)?(a=-a,v=T):(g=u,v=O),v.reverse(),s=a;s--;v.push(0));v.reverse()}else for(x=(U=(a=T.length)<(s=O.length))?a:s,a=s=0;s<x;s++)if(T[s]!=O[s]){U=T[s]<O[s];break}if(U&&(v=T,T=O,O=v,m.s=-m.s),s=(x=O.length)-(h=T.length),s>0)for(;s--;T[h++]=0);for(s=w-1;x>a;){if(T[--x]<O[x]){for(h=x;h&&!T[--h];T[h]=s);--T[h],T[x]+=w}T[x]-=O[x]}for(;T[0]==0;T.splice(0,1),--g);return T[0]?he(m,T,g):(m.s=R==3?-1:1,m.c=[m.e=0],m)},X.modulo=X.mod=function(m,s){var h,x,v=this;return m=new _(m,s),!v.c||!m.s||m.c&&!m.c[0]?new _(NaN):!m.c||v.c&&!v.c[0]?new _(v):(ee==9?(x=m.s,m.s=1,h=q(v,m,0,3),m.s=x,h.s*=x):h=q(v,m,0,ee),m=v.minus(h.times(m)),!m.c[0]&&ee==1&&(m.s=v.s),m)},X.multipliedBy=X.times=function(m,s){var h,x,v,U,p,a,u,g,T,O,L,Y,oe,pe,me,y=this,f=y.c,l=(m=new _(m,s)).c;if(!f||!l||!f[0]||!l[0])return!y.s||!m.s||f&&!f[0]&&!l||l&&!l[0]&&!f?m.c=m.e=m.s=null:(m.s*=y.s,!f||!l?m.c=m.e=null:(m.c=[0],m.e=0)),m;for(x=j(y.e/E)+j(m.e/E),m.s*=y.s,u=f.length,O=l.length,u<O&&(oe=f,f=l,l=oe,v=u,u=O,O=v),v=u+O,oe=[];v--;oe.push(0));for(pe=w,me=S,v=O;--v>=0;){for(h=0,L=l[v]%me,Y=l[v]/me|0,p=u,U=v+p;U>v;)g=f[--p]%me,T=f[p]/me|0,a=Y*g+T*L,g=L*g+a%me*me+oe[U]+h,h=(g/pe|0)+(a/me|0)+Y*T,oe[U--]=g%pe;oe[U]=h}return h?++x:oe.splice(0,1),he(m,oe,x)},X.negated=function(){var m=new _(this);return m.s=-m.s||null,m},X.plus=function(m,s){var h,x=this,v=x.s;if(m=new _(m,s),s=m.s,!v||!s)return new _(NaN);if(v!=s)return m.s=-s,x.minus(m);var U=x.e/E,p=m.e/E,a=x.c,u=m.c;if(!U||!p){if(!a||!u)return new _(v/0);if(!a[0]||!u[0])return u[0]?m:new _(a[0]?x:v*0)}if(U=j(U),p=j(p),a=a.slice(),v=U-p){for(v>0?(p=U,h=u):(v=-v,h=a),h.reverse();v--;h.push(0));h.reverse()}for(v=a.length,s=u.length,v-s<0&&(h=u,u=a,a=h,s=v),v=0;s;)v=(a[--s]=a[s]+u[s]+v)/w|0,a[s]=w===a[s]?0:a[s]%w;return v&&(a=[v].concat(a),++p),he(m,a,p)},X.precision=X.sd=function(m,s){var h,x,v,U=this;if(m!=null&&m!==!!m)return K(m,1,N),s==null?s=R:K(s,0,8),ne(new _(U),m,s);if(!(h=U.c))return null;if(v=h.length-1,x=v*E+1,v=h[v]){for(;v%10==0;v/=10,x--);for(v=h[0];v>=10;v/=10,x++);}return m&&U.e+1>x&&(x=U.e+1),x},X.shiftedBy=function(m){return K(m,-9007199254740991,A),this.times("1e"+m)},X.squareRoot=X.sqrt=function(){var m,s,h,x,v,U=this,p=U.c,a=U.s,u=U.e,g=fe+4,T=new _("0.5");if(a!==1||!p||!p[0])return new _(!a||a<0&&(!p||p[0])?NaN:p?U:1/0);if(a=Math.sqrt(+ce(U)),a==0||a==1/0?(s=V(p),(s.length+u)%2==0&&(s+="0"),a=Math.sqrt(+s),u=j((u+1)/2)-(u<0||u%2),a==1/0?s="5e"+u:(s=a.toExponential(),s=s.slice(0,s.indexOf("e")+1)+u),h=new _(s)):h=new _(a+""),h.c[0]){for(u=h.e,a=u+g,a<3&&(a=0);;)if(v=h,h=T.times(v.plus(q(U,v,g,1))),V(v.c).slice(0,a)===(s=V(h.c)).slice(0,a))if(h.e<u&&--a,s=s.slice(a-3,a+1),s=="9999"||!x&&s=="4999"){if(!x&&(ne(v,v.e+fe+2,0),v.times(v).eq(U))){h=v;break}g+=4,a+=4,x=1}else{(!+s||!+s.slice(1)&&s.charAt(0)=="5")&&(ne(h,h.e+fe+2,1),m=!h.times(h).eq(U));break}}return ne(h,h.e+fe+1,R,m)},X.toExponential=function(m,s){return m!=null&&(K(m,0,N),m++),se(this,m,s,1)},X.toFixed=function(m,s){return m!=null&&(K(m,0,N),m=m+this.e+1),se(this,m,s)},X.toFormat=function(m,s,h){var x,v=this;if(h==null)m!=null&&s&&typeof s=="object"?(h=s,s=null):m&&typeof m=="object"?(h=m,m=s=null):h=ae;else if(typeof h!="object")throw Error(d+"Argument not an object: "+h);if(x=v.toFixed(m,s),v.c){var U,p=x.split("."),a=+h.groupSize,u=+h.secondaryGroupSize,g=h.groupSeparator||"",T=p[0],O=p[1],L=v.s<0,Y=L?T.slice(1):T,oe=Y.length;if(u&&(U=a,a=u,u=U,oe-=U),a>0&&oe>0){for(U=oe%a||a,T=Y.substr(0,U);U<oe;U+=a)T+=g+Y.substr(U,a);u>0&&(T+=g+Y.slice(U)),L&&(T="-"+T)}x=O?T+(h.decimalSeparator||"")+((u=+h.fractionGroupSize)?O.replace(new RegExp("\\d{"+u+"}\\B","g"),"$&"+(h.fractionGroupSeparator||"")):O):T}return(h.prefix||"")+x+(h.suffix||"")},X.toFraction=function(m){var s,h,x,v,U,p,a,u,g,T,O,L,Y=this,oe=Y.c;if(m!=null&&(a=new _(m),!a.isInteger()&&(a.c||a.s!==1)||a.lt(de)))throw Error(d+"Argument "+(a.isInteger()?"out of range: ":"not an integer: ")+ce(a));if(!oe)return new _(Y);for(s=new _(de),g=h=new _(de),x=u=new _(de),L=V(oe),U=s.e=L.length-Y.e-1,s.c[0]=I[(p=U%E)<0?E+p:p],m=!m||a.comparedTo(s)>0?U>0?s:g:a,p=G,G=1/0,a=new _(L),u.c[0]=0;T=q(a,s,0,1),v=h.plus(T.times(x)),v.comparedTo(m)!=1;)h=x,x=v,g=u.plus(T.times(v=g)),u=v,s=a.minus(T.times(v=s)),a=v;return v=q(m.minus(h),x,0,1),u=u.plus(v.times(g)),h=h.plus(v.times(x)),u.s=g.s=Y.s,U=U*2,O=q(g,x,U,R).minus(Y).abs().comparedTo(q(u,h,U,R).minus(Y).abs())<1?[g,x]:[u,h],G=p,O},X.toNumber=function(){return+ce(this)},X.toPrecision=function(m,s){return m!=null&&K(m,1,N),se(this,m,s,2)},X.toString=function(m){var s,h=this,x=h.s,v=h.e;return v===null?x?(s="Infinity",x<0&&(s="-"+s)):s="NaN":(m==null?s=v<=P||v>=z?ie(V(h.c),v):C(V(h.c),v,"0"):m===10&&te?(h=ne(new _(h),fe+v+1,R),s=C(V(h.c),h.e,"0")):(K(m,2,le.length,"Base"),s=Q(C(V(h.c),v,"0"),10,m,x,!0)),x<0&&h.c[0]&&(s="-"+s)),s},X.valueOf=X.toJSON=function(){return ce(this)},X._isBigNumber=!0,Z!=null&&_.set(Z),_}function j(Z){var q=Z|0;return Z>0||Z===q?q:q-1}function V(Z){for(var q,Q,re=1,X=Z.length,de=Z[0]+"";re<X;){for(q=Z[re++]+"",Q=E-q.length;Q--;q="0"+q);de+=q}for(X=de.length;de.charCodeAt(--X)===48;);return de.slice(0,X+1||1)}function W(Z,q){var Q,re,X=Z.c,de=q.c,fe=Z.s,R=q.s,P=Z.e,z=q.e;if(!fe||!R)return null;if(Q=X&&!X[0],re=de&&!de[0],Q||re)return Q?re?0:-R:fe;if(fe!=R)return fe;if(Q=fe<0,re=P==z,!X||!de)return re?0:!X^Q?1:-1;if(!re)return P>z^Q?1:-1;for(R=(P=X.length)<(z=de.length)?P:z,fe=0;fe<R;fe++)if(X[fe]!=de[fe])return X[fe]>de[fe]^Q?1:-1;return P==z?0:P>z^Q?1:-1}function K(Z,q,Q,re){if(Z<q||Z>Q||Z!==o(Z))throw Error(d+(re||"Argument")+(typeof Z=="number"?Z<q||Z>Q?" out of range: ":" not an integer: ":" not a primitive number: ")+String(Z))}function $(Z){var q=Z.c.length-1;return j(Z.e/E)==q&&Z.c[q]%2!=0}function ie(Z,q){return(Z.length>1?Z.charAt(0)+"."+Z.slice(1):Z)+(q<0?"e":"e+")+q}function C(Z,q,Q){var re,X;if(q<0){for(X=Q+".";++q;X+=Q);Z=X+Z}else if(re=Z.length,++q>re){for(X=Q,q-=re;--q;X+=Q);Z+=X}else q<re&&(Z=Z.slice(0,q)+"."+Z.slice(q));return Z}r=b(),r.default=r.BigNumber=r,e.exports?e.exports=r:(t||(t=typeof self<"u"&&self?self:window),t.BigNumber=r)})(qr)})(Wo);var Ii=Wo.exports,Tf=function(t,r,n){var i=new t.Uint8Array(n),o=r.pushInt,d=r.pushInt32,c=r.pushInt32Neg,w=r.pushInt64,E=r.pushInt64Neg,A=r.pushFloat,I=r.pushFloatSingle,S=r.pushFloatDouble,N=r.pushTrue,b=r.pushFalse,j=r.pushUndefined,V=r.pushNull,W=r.pushInfinity,K=r.pushInfinityNeg,$=r.pushNaN,ie=r.pushNaNNeg,C=r.pushArrayStart,Z=r.pushArrayStartFixed,q=r.pushArrayStartFixed32,Q=r.pushArrayStartFixed64,re=r.pushObjectStart,X=r.pushObjectStartFixed,de=r.pushObjectStartFixed32,fe=r.pushObjectStartFixed64,R=r.pushByteString,P=r.pushByteStringStart,z=r.pushUtf8String,M=r.pushUtf8StringStart,G=r.pushSimpleUnassigned,J=r.pushTagStart,ee=r.pushTagStart4,ge=r.pushTagStart8,ae=r.pushTagUnassigned,le=r.pushBreak,te=t.Math.pow,_=0,se=0,ue=0;function he(F){for(F=F|0,_=0,se=F;(_|0)<(se|0)&&(ue=Su[i[_]&255](i[_]|0)|0,!((ue|0)>0)););return ue|0}function ne(F){return F=F|0,((_|0)+(F|0)|0)<(se|0)?0:1}function ce(F){return F=F|0,i[F|0]<<8|i[F+1|0]|0}function m(F){return F=F|0,i[F|0]<<24|i[F+1|0]<<16|i[F+2|0]<<8|i[F+3|0]|0}function s(F){return F=F|0,o(F|0),_=_+1|0,0}function h(F){return F=F|0,ne(1)|0?1:(o(i[_+1|0]|0),_=_+2|0,0)}function x(F){return F=F|0,ne(2)|0?1:(o(ce(_+1|0)|0),_=_+3|0,0)}function v(F){return F=F|0,ne(4)|0?1:(d(ce(_+1|0)|0,ce(_+3|0)|0),_=_+5|0,0)}function U(F){return F=F|0,ne(8)|0?1:(w(ce(_+1|0)|0,ce(_+3|0)|0,ce(_+5|0)|0,ce(_+7|0)|0),_=_+9|0,0)}function p(F){return F=F|0,o(-1-(F-32|0)|0),_=_+1|0,0}function a(F){return F=F|0,ne(1)|0?1:(o(-1-(i[_+1|0]|0)|0),_=_+2|0,0)}function u(F){F=F|0;var Se=0;return ne(2)|0?1:(Se=ce(_+1|0)|0,o(-1-(Se|0)|0),_=_+3|0,0)}function g(F){return F=F|0,ne(4)|0?1:(c(ce(_+1|0)|0,ce(_+3|0)|0),_=_+5|0,0)}function T(F){return F=F|0,ne(8)|0?1:(E(ce(_+1|0)|0,ce(_+3|0)|0,ce(_+5|0)|0,ce(_+7|0)|0),_=_+9|0,0)}function O(F){F=F|0;var Se=0,Ie=0,Ae=0;return Ae=F-64|0,ne(Ae|0)|0?1:(Se=_+1|0,Ie=(_+1|0)+(Ae|0)|0,R(Se|0,Ie|0),_=Ie|0,0)}function L(F){F=F|0;var Se=0,Ie=0,Ae=0;return ne(1)|0||(Ae=i[_+1|0]|0,Se=_+2|0,Ie=(_+2|0)+(Ae|0)|0,ne(Ae+1|0)|0)?1:(R(Se|0,Ie|0),_=Ie|0,0)}function Y(F){F=F|0;var Se=0,Ie=0,Ae=0;return ne(2)|0||(Ae=ce(_+1|0)|0,Se=_+3|0,Ie=(_+3|0)+(Ae|0)|0,ne(Ae+2|0)|0)?1:(R(Se|0,Ie|0),_=Ie|0,0)}function oe(F){F=F|0;var Se=0,Ie=0,Ae=0;return ne(4)|0||(Ae=m(_+1|0)|0,Se=_+5|0,Ie=(_+5|0)+(Ae|0)|0,ne(Ae+4|0)|0)?1:(R(Se|0,Ie|0),_=Ie|0,0)}function pe(F){return F=F|0,1}function me(F){return F=F|0,P(),_=_+1|0,0}function y(F){F=F|0;var Se=0,Ie=0,Ae=0;return Ae=F-96|0,ne(Ae|0)|0?1:(Se=_+1|0,Ie=(_+1|0)+(Ae|0)|0,z(Se|0,Ie|0),_=Ie|0,0)}function f(F){F=F|0;var Se=0,Ie=0,Ae=0;return ne(1)|0||(Ae=i[_+1|0]|0,Se=_+2|0,Ie=(_+2|0)+(Ae|0)|0,ne(Ae+1|0)|0)?1:(z(Se|0,Ie|0),_=Ie|0,0)}function l(F){F=F|0;var Se=0,Ie=0,Ae=0;return ne(2)|0||(Ae=ce(_+1|0)|0,Se=_+3|0,Ie=(_+3|0)+(Ae|0)|0,ne(Ae+2|0)|0)?1:(z(Se|0,Ie|0),_=Ie|0,0)}function B(F){F=F|0;var Se=0,Ie=0,Ae=0;return ne(4)|0||(Ae=m(_+1|0)|0,Se=_+5|0,Ie=(_+5|0)+(Ae|0)|0,ne(Ae+4|0)|0)?1:(z(Se|0,Ie|0),_=Ie|0,0)}function k(F){return F=F|0,1}function D(F){return F=F|0,M(),_=_+1|0,0}function H(F){return F=F|0,Z(F-128|0),_=_+1|0,0}function _e(F){return F=F|0,ne(1)|0?1:(Z(i[_+1|0]|0),_=_+2|0,0)}function Te(F){return F=F|0,ne(2)|0?1:(Z(ce(_+1|0)|0),_=_+3|0,0)}function xe(F){return F=F|0,ne(4)|0?1:(q(ce(_+1|0)|0,ce(_+3|0)|0),_=_+5|0,0)}function Ee(F){return F=F|0,ne(8)|0?1:(Q(ce(_+1|0)|0,ce(_+3|0)|0,ce(_+5|0)|0,ce(_+7|0)|0),_=_+9|0,0)}function Oe(F){return F=F|0,C(),_=_+1|0,0}function ke(F){F=F|0;var Se=0;return Se=F-160|0,ne(Se|0)|0?1:(X(Se|0),_=_+1|0,0)}function Mi(F){return F=F|0,ne(1)|0?1:(X(i[_+1|0]|0),_=_+2|0,0)}function Vi(F){return F=F|0,ne(2)|0?1:(X(ce(_+1|0)|0),_=_+3|0,0)}function $i(F){return F=F|0,ne(4)|0?1:(de(ce(_+1|0)|0,ce(_+3|0)|0),_=_+5|0,0)}function hu(F){return F=F|0,ne(8)|0?1:(fe(ce(_+1|0)|0,ce(_+3|0)|0,ce(_+5|0)|0,ce(_+7|0)|0),_=_+9|0,0)}function pu(F){return F=F|0,re(),_=_+1|0,0}function xr(F){return F=F|0,J(F-192|0|0),_=_+1|0,0}function I0(F){return F=F|0,J(F|0),_=_+1|0,0}function O0(F){return F=F|0,J(F|0),_=_+1|0,0}function R0(F){return F=F|0,J(F|0),_=_+1|0,0}function U0(F){return F=F|0,J(F|0),_=_+1|0,0}function We(F){return F=F|0,J(F-192|0|0),_=_+1|0,0}function F0(F){return F=F|0,J(F|0),_=_+1|0,0}function P0(F){return F=F|0,J(F|0),_=_+1|0,0}function k0(F){return F=F|0,J(F|0),_=_+1|0,0}function yu(F){return F=F|0,ne(1)|0?1:(J(i[_+1|0]|0),_=_+2|0,0)}function gu(F){return F=F|0,ne(2)|0?1:(J(ce(_+1|0)|0),_=_+3|0,0)}function wu(F){return F=F|0,ne(4)|0?1:(ee(ce(_+1|0)|0,ce(_+3|0)|0),_=_+5|0,0)}function mu(F){return F=F|0,ne(8)|0?1:(ge(ce(_+1|0)|0,ce(_+3|0)|0,ce(_+5|0)|0,ce(_+7|0)|0),_=_+9|0,0)}function Ge(F){return F=F|0,G((F|0)-224|0),_=_+1|0,0}function bu(F){return F=F|0,b(),_=_+1|0,0}function _u(F){return F=F|0,N(),_=_+1|0,0}function Eu(F){return F=F|0,V(),_=_+1|0,0}function xu(F){return F=F|0,j(),_=_+1|0,0}function Tu(F){return F=F|0,ne(1)|0?1:(G(i[_+1|0]|0),_=_+2|0,0)}function vu(F){F=F|0;var Se=0,Ie=0,Ae=1,vn=0,zr=0,C0=0;return ne(2)|0?1:(Se=i[_+1|0]|0,Ie=i[_+2|0]|0,(Se|0)&128&&(Ae=-1),vn=+(((Se|0)&124)>>2),zr=+(((Se|0)&3)<<8|Ie),+vn==0?A(+(+Ae*5960464477539063e-23*+zr)):+vn==31?+Ae==1?+zr>0?$():W():+zr>0?ie():K():A(+(+Ae*te(2,+(+vn-25))*+(1024+zr))),_=_+3|0,0)}function Bu(F){return F=F|0,ne(4)|0?1:(I(i[_+1|0]|0,i[_+2|0]|0,i[_+3|0]|0,i[_+4|0]|0),_=_+5|0,0)}function Au(F){return F=F|0,ne(8)|0?1:(S(i[_+1|0]|0,i[_+2|0]|0,i[_+3|0]|0,i[_+4|0]|0,i[_+5|0]|0,i[_+6|0]|0,i[_+7|0]|0,i[_+8|0]|0),_=_+9|0,0)}function Fe(F){return F=F|0,1}function Nu(F){return F=F|0,le(),_=_+1|0,0}var Su=[s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,h,x,v,U,Fe,Fe,Fe,Fe,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,a,u,g,T,Fe,Fe,Fe,Fe,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,L,Y,oe,pe,Fe,Fe,Fe,me,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,f,l,B,k,Fe,Fe,Fe,D,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,_e,Te,xe,Ee,Fe,Fe,Fe,Oe,ke,ke,ke,ke,ke,ke,ke,ke,ke,ke,ke,ke,ke,ke,ke,ke,ke,ke,ke,ke,ke,ke,ke,ke,Mi,Vi,$i,hu,Fe,Fe,Fe,pu,xr,xr,xr,xr,xr,xr,We,We,We,We,We,We,We,We,We,We,We,We,We,We,We,We,We,We,yu,gu,wu,mu,Fe,Fe,Fe,Fe,Ge,Ge,Ge,Ge,Ge,Ge,Ge,Ge,Ge,Ge,Ge,Ge,Ge,Ge,Ge,Ge,Ge,Ge,Ge,Ge,bu,_u,Eu,xu,Tu,vu,Bu,Au,Fe,Fe,Fe,Nu];return{parse:he}},Oi={},nt={};const $s=Ii.BigNumber;nt.MT={POS_INT:0,NEG_INT:1,BYTE_STRING:2,UTF8_STRING:3,ARRAY:4,MAP:5,TAG:6,SIMPLE_FLOAT:7};nt.TAG={DATE_STRING:0,DATE_EPOCH:1,POS_BIGINT:2,NEG_BIGINT:3,DECIMAL_FRAC:4,BIGFLOAT:5,BASE64URL_EXPECTED:21,BASE64_EXPECTED:22,BASE16_EXPECTED:23,CBOR:24,URI:32,BASE64URL:33,BASE64:34,REGEXP:35,MIME:36};nt.NUMBYTES={ZERO:0,ONE:24,TWO:25,FOUR:26,EIGHT:27,INDEFINITE:31};nt.SIMPLE={FALSE:20,TRUE:21,NULL:22,UNDEFINED:23};nt.SYMS={NULL:Symbol("null"),UNDEFINED:Symbol("undef"),PARENT:Symbol("parent"),BREAK:Symbol("break"),STREAM:Symbol("stream")};nt.SHIFT32=Math.pow(2,32);nt.SHIFT16=Math.pow(2,16);nt.MAX_SAFE_HIGH=2097151;nt.NEG_ONE=new $s(-1);nt.TEN=new $s(10);nt.TWO=new $s(2);nt.PARENT={ARRAY:0,OBJECT:1,MAP:2,TAG:3,BYTE_STRING:4,UTF8_STRING:5};(function(e){const{Buffer:t}=_n,r=Ii.BigNumber,n=nt,i=n.SHIFT32,o=n.SHIFT16,d=2097151;e.parseHalf=function(E){var A,I,S;return S=E[0]&128?-1:1,A=(E[0]&124)>>2,I=(E[0]&3)<<8|E[1],A?A===31?S*(I?NaN:1/0):S*Math.pow(2,A-25)*(1024+I):S*5960464477539063e-23*I};function c(w){return w<16?"0"+w.toString(16):w.toString(16)}e.arrayBufferToBignumber=function(w){const E=w.byteLength;let A="";for(let I=0;I<E;I++)A+=c(w[I]);return new r(A,16)},e.buildMap=w=>{const E=new Map,A=Object.keys(w),I=A.length;for(let S=0;S<I;S++)E.set(A[S],w[A[S]]);return E},e.buildInt32=(w,E)=>w*o+E,e.buildInt64=(w,E,A,I)=>{const S=e.buildInt32(w,E),N=e.buildInt32(A,I);return S>d?new r(S).times(i).plus(N):S*i+N},e.writeHalf=function(E,A){const I=t.allocUnsafe(4);I.writeFloatBE(A,0);const S=I.readUInt32BE(0);if(S&8191)return!1;var N=S>>16&32768;const b=S>>23&255,j=S&8388607;if(b>=113&&b<=142)N+=(b-112<<10)+(j>>13);else if(b>=103&&b<113){if(j&(1<<126-b)-1)return!1;N+=j+8388608>>126-b}else return!1;return E.writeUInt16BE(N,0),!0},e.keySorter=function(w,E){var A=w[0].byteLength,I=E[0].byteLength;return A>I?1:I>A?-1:w[0].compare(E[0])},e.isNegativeZero=w=>w===0&&1/w<0,e.nextPowerOf2=w=>{let E=0;if(w&&!(w&w-1))return w;for(;w!==0;)w>>=1,E+=1;return 1<<E}})(Oi);const qs=nt,vf=qs.MT,Bn=qs.SIMPLE,Li=qs.SYMS;let Bf=class ps{constructor(t){if(typeof t!="number")throw new Error("Invalid Simple type: "+typeof t);if(t<0||t>255||(t|0)!==t)throw new Error("value must be a small positive integer: "+t);this.value=t}toString(){return"simple("+this.value+")"}inspect(){return"simple("+this.value+")"}encodeCBOR(t){return t._pushInt(this.value,vf.SIMPLE_FLOAT)}static isSimple(t){return t instanceof ps}static decode(t,r){switch(r==null&&(r=!0),t){case Bn.FALSE:return!1;case Bn.TRUE:return!0;case Bn.NULL:return r?null:Li.NULL;case Bn.UNDEFINED:return r?void 0:Li.UNDEFINED;case-1:if(!r)throw new Error("Invalid BREAK");return Li.BREAK;default:return new ps(t)}}};var Yo=Bf;let Af=class ys{constructor(t,r,n){if(this.tag=t,this.value=r,this.err=n,typeof this.tag!="number")throw new Error("Invalid tag type ("+typeof this.tag+")");if(this.tag<0||(this.tag|0)!==this.tag)throw new Error("Tag must be a positive integer: "+this.tag)}toString(){return`${this.tag}(${JSON.stringify(this.value)})`}encodeCBOR(t){return t._pushTag(this.tag),t.pushAny(this.value)}convert(t){var r,n;if(n=t?.[this.tag],typeof n!="function"&&(n=ys["_tag"+this.tag],typeof n!="function"))return this;try{return n.call(ys,this.value)}catch(i){return r=i,this.err=r,this}}};var Zo=Af;const Xo=self.location?self.location.protocol+"//"+self.location.host:"",gs=self.URL;let Nf=class{constructor(t="",r=Xo){this.super=new gs(t,r),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(t){this.super.hash=t}set host(t){this.super.host=t}set hostname(t){this.super.hostname=t}set href(t){this.super.href=t}set origin(t){this.super.origin=t}set password(t){this.super.password=t}set pathname(t){this.super.pathname=t}set port(t){this.super.port=t}set protocol(t){this.super.protocol=t}set search(t){this.super.search=t}set searchParams(t){this.super.searchParams=t}set username(t){this.super.username=t}createObjectURL(t){return this.super.createObjectURL(t)}revokeObjectURL(t){this.super.revokeObjectURL(t)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}};function Sf(e){if(typeof e=="string")return new gs(e).toString();if(!(e instanceof gs)){const t=e.username&&e.password?`${e.username}:${e.password}@`:"",r=e.auth?e.auth+"@":"",n=e.port?":"+e.port:"",i=e.protocol?e.protocol+"//":"",o=e.host||"",d=e.hostname||"",c=e.search||(e.query?"?"+e.query:""),w=e.hash||"",E=e.pathname||"",A=e.path||E+c;return`${i}${t||r}${o||d+n}${A}${w}`}}var Jo={URLWithLegacySupport:Nf,URLSearchParams:self.URLSearchParams,defaultBase:Xo,format:Sf};const{URLWithLegacySupport:sa,format:If}=Jo;var Of=(e,t={},r={},n)=>{let i=t.protocol?t.protocol.replace(":",""):"http";i=(r[i]||n||i)+":";let o;try{o=new sa(e)}catch{o={}}const d=Object.assign({},t,{protocol:i||o.protocol,host:t.host||o.host});return new sa(e,If(d)).toString()};const{URLWithLegacySupport:Rf,format:Uf,URLSearchParams:Ff,defaultBase:Pf}=Jo,kf=Of;var Qo={URL:Rf,URLSearchParams:Ff,format:Uf,relative:kf,defaultBase:Pf};const{Buffer:Br}=_n,aa=mn,Cf=Ii.BigNumber,Mf=Tf,it=Oi,Ue=nt,Vf=Yo,$f=Zo,{URL:qf}=Qo;let ws=class ms{constructor(t){t=t||{},!t.size||t.size<65536?t.size=65536:t.size=it.nextPowerOf2(t.size),this._heap=new ArrayBuffer(t.size),this._heap8=new Uint8Array(this._heap),this._buffer=Br.from(this._heap),this._reset(),this._knownTags=Object.assign({0:r=>new Date(r),1:r=>new Date(r*1e3),2:r=>it.arrayBufferToBignumber(r),3:r=>Ue.NEG_ONE.minus(it.arrayBufferToBignumber(r)),4:r=>Ue.TEN.pow(r[0]).times(r[1]),5:r=>Ue.TWO.pow(r[0]).times(r[1]),32:r=>new qf(r),35:r=>new RegExp(r)},t.tags),this.parser=Mf(qr,{log:console.log.bind(console),pushInt:this.pushInt.bind(this),pushInt32:this.pushInt32.bind(this),pushInt32Neg:this.pushInt32Neg.bind(this),pushInt64:this.pushInt64.bind(this),pushInt64Neg:this.pushInt64Neg.bind(this),pushFloat:this.pushFloat.bind(this),pushFloatSingle:this.pushFloatSingle.bind(this),pushFloatDouble:this.pushFloatDouble.bind(this),pushTrue:this.pushTrue.bind(this),pushFalse:this.pushFalse.bind(this),pushUndefined:this.pushUndefined.bind(this),pushNull:this.pushNull.bind(this),pushInfinity:this.pushInfinity.bind(this),pushInfinityNeg:this.pushInfinityNeg.bind(this),pushNaN:this.pushNaN.bind(this),pushNaNNeg:this.pushNaNNeg.bind(this),pushArrayStart:this.pushArrayStart.bind(this),pushArrayStartFixed:this.pushArrayStartFixed.bind(this),pushArrayStartFixed32:this.pushArrayStartFixed32.bind(this),pushArrayStartFixed64:this.pushArrayStartFixed64.bind(this),pushObjectStart:this.pushObjectStart.bind(this),pushObjectStartFixed:this.pushObjectStartFixed.bind(this),pushObjectStartFixed32:this.pushObjectStartFixed32.bind(this),pushObjectStartFixed64:this.pushObjectStartFixed64.bind(this),pushByteString:this.pushByteString.bind(this),pushByteStringStart:this.pushByteStringStart.bind(this),pushUtf8String:this.pushUtf8String.bind(this),pushUtf8StringStart:this.pushUtf8StringStart.bind(this),pushSimpleUnassigned:this.pushSimpleUnassigned.bind(this),pushTagUnassigned:this.pushTagUnassigned.bind(this),pushTagStart:this.pushTagStart.bind(this),pushTagStart4:this.pushTagStart4.bind(this),pushTagStart8:this.pushTagStart8.bind(this),pushBreak:this.pushBreak.bind(this)},this._heap)}get _depth(){return this._parents.length}get _currentParent(){return this._parents[this._depth-1]}get _ref(){return this._currentParent.ref}_closeParent(){var t=this._parents.pop();if(t.length>0)throw new Error(`Missing ${t.length} elements`);switch(t.type){case Ue.PARENT.TAG:this._push(this.createTag(t.ref[0],t.ref[1]));break;case Ue.PARENT.BYTE_STRING:this._push(this.createByteString(t.ref,t.length));break;case Ue.PARENT.UTF8_STRING:this._push(this.createUtf8String(t.ref,t.length));break;case Ue.PARENT.MAP:if(t.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createMap(t.ref,t.length));break;case Ue.PARENT.OBJECT:if(t.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createObject(t.ref,t.length));break;case Ue.PARENT.ARRAY:this._push(this.createArray(t.ref,t.length));break}this._currentParent&&this._currentParent.type===Ue.PARENT.TAG&&this._dec()}_dec(){const t=this._currentParent;t.length<0||(t.length--,t.length===0&&this._closeParent())}_push(t,r){const n=this._currentParent;switch(n.values++,n.type){case Ue.PARENT.ARRAY:case Ue.PARENT.BYTE_STRING:case Ue.PARENT.UTF8_STRING:n.length>-1?this._ref[this._ref.length-n.length]=t:this._ref.push(t),this._dec();break;case Ue.PARENT.OBJECT:n.tmpKey!=null?(this._ref[n.tmpKey]=t,n.tmpKey=null,this._dec()):(n.tmpKey=t,typeof n.tmpKey!="string"&&(n.type=Ue.PARENT.MAP,n.ref=it.buildMap(n.ref)));break;case Ue.PARENT.MAP:n.tmpKey!=null?(this._ref.set(n.tmpKey,t),n.tmpKey=null,this._dec()):n.tmpKey=t;break;case Ue.PARENT.TAG:this._ref.push(t),r||this._dec();break;default:throw new Error("Unknown parent type")}}_createParent(t,r,n){this._parents[this._depth]={type:r,length:n,ref:t,values:0,tmpKey:null}}_reset(){this._res=[],this._parents=[{type:Ue.PARENT.ARRAY,length:-1,ref:this._res,values:0,tmpKey:null}]}createTag(t,r){const n=this._knownTags[t];return n?n(r):new $f(t,r)}createMap(t,r){return t}createObject(t,r){return t}createArray(t,r){return t}createByteString(t,r){return Br.concat(t)}createByteStringFromHeap(t,r){return t===r?Br.alloc(0):Br.from(this._heap.slice(t,r))}createInt(t){return t}createInt32(t,r){return it.buildInt32(t,r)}createInt64(t,r,n,i){return it.buildInt64(t,r,n,i)}createFloat(t){return t}createFloatSingle(t,r,n,i){return aa.read([t,r,n,i],0,!1,23,4)}createFloatDouble(t,r,n,i,o,d,c,w){return aa.read([t,r,n,i,o,d,c,w],0,!1,52,8)}createInt32Neg(t,r){return-1-it.buildInt32(t,r)}createInt64Neg(t,r,n,i){const o=it.buildInt32(t,r),d=it.buildInt32(n,i);return o>Ue.MAX_SAFE_HIGH?Ue.NEG_ONE.minus(new Cf(o).times(Ue.SHIFT32).plus(d)):-1-(o*Ue.SHIFT32+d)}createTrue(){return!0}createFalse(){return!1}createNull(){return null}createUndefined(){}createInfinity(){return 1/0}createInfinityNeg(){return-1/0}createNaN(){return NaN}createNaNNeg(){return NaN}createUtf8String(t,r){return t.join("")}createUtf8StringFromHeap(t,r){return t===r?"":this._buffer.toString("utf8",t,r)}createSimpleUnassigned(t){return new Vf(t)}pushInt(t){this._push(this.createInt(t))}pushInt32(t,r){this._push(this.createInt32(t,r))}pushInt64(t,r,n,i){this._push(this.createInt64(t,r,n,i))}pushFloat(t){this._push(this.createFloat(t))}pushFloatSingle(t,r,n,i){this._push(this.createFloatSingle(t,r,n,i))}pushFloatDouble(t,r,n,i,o,d,c,w){this._push(this.createFloatDouble(t,r,n,i,o,d,c,w))}pushInt32Neg(t,r){this._push(this.createInt32Neg(t,r))}pushInt64Neg(t,r,n,i){this._push(this.createInt64Neg(t,r,n,i))}pushTrue(){this._push(this.createTrue())}pushFalse(){this._push(this.createFalse())}pushNull(){this._push(this.createNull())}pushUndefined(){this._push(this.createUndefined())}pushInfinity(){this._push(this.createInfinity())}pushInfinityNeg(){this._push(this.createInfinityNeg())}pushNaN(){this._push(this.createNaN())}pushNaNNeg(){this._push(this.createNaNNeg())}pushArrayStart(){this._createParent([],Ue.PARENT.ARRAY,-1)}pushArrayStartFixed(t){this._createArrayStartFixed(t)}pushArrayStartFixed32(t,r){const n=it.buildInt32(t,r);this._createArrayStartFixed(n)}pushArrayStartFixed64(t,r,n,i){const o=it.buildInt64(t,r,n,i);this._createArrayStartFixed(o)}pushObjectStart(){this._createObjectStartFixed(-1)}pushObjectStartFixed(t){this._createObjectStartFixed(t)}pushObjectStartFixed32(t,r){const n=it.buildInt32(t,r);this._createObjectStartFixed(n)}pushObjectStartFixed64(t,r,n,i){const o=it.buildInt64(t,r,n,i);this._createObjectStartFixed(o)}pushByteStringStart(){this._parents[this._depth]={type:Ue.PARENT.BYTE_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushByteString(t,r){this._push(this.createByteStringFromHeap(t,r))}pushUtf8StringStart(){this._parents[this._depth]={type:Ue.PARENT.UTF8_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushUtf8String(t,r){this._push(this.createUtf8StringFromHeap(t,r))}pushSimpleUnassigned(t){this._push(this.createSimpleUnassigned(t))}pushTagStart(t){this._parents[this._depth]={type:Ue.PARENT.TAG,length:1,ref:[t]}}pushTagStart4(t,r){this.pushTagStart(it.buildInt32(t,r))}pushTagStart8(t,r,n,i){this.pushTagStart(it.buildInt64(t,r,n,i))}pushTagUnassigned(t){this._push(this.createTag(t))}pushBreak(){if(this._currentParent.length>-1)throw new Error("Unexpected break");this._closeParent()}_createObjectStartFixed(t){if(t===0){this._push(this.createObject({}));return}this._createParent({},Ue.PARENT.OBJECT,t)}_createArrayStartFixed(t){if(t===0){this._push(this.createArray([]));return}this._createParent(new Array(t),Ue.PARENT.ARRAY,t)}_decode(t){if(t.byteLength===0)throw new Error("Input too short");this._reset(),this._heap8.set(t);const r=this.parser.parse(t.byteLength);if(this._depth>1){for(;this._currentParent.length===0;)this._closeParent();if(this._depth>1)throw new Error("Undeterminated nesting")}if(r>0)throw new Error("Failed to parse");if(this._res.length===0)throw new Error("No valid result")}decodeFirst(t){return this._decode(t),this._res[0]}decodeAll(t){return this._decode(t),this._res}static decode(t,r){return typeof t=="string"&&(t=Br.from(t,r||"hex")),new ms({size:t.length}).decodeFirst(t)}static decodeAll(t,r){return typeof t=="string"&&(t=Br.from(t,r||"hex")),new ms({size:t.length}).decodeAll(t)}};ws.decodeFirst=ws.decode;var ec=ws;const{Buffer:Hi}=_n,jf=ec,Gf=Oi;class js extends jf{createTag(t,r){return`${t}(${r})`}createInt(t){return super.createInt(t).toString()}createInt32(t,r){return super.createInt32(t,r).toString()}createInt64(t,r,n,i){return super.createInt64(t,r,n,i).toString()}createInt32Neg(t,r){return super.createInt32Neg(t,r).toString()}createInt64Neg(t,r,n,i){return super.createInt64Neg(t,r,n,i).toString()}createTrue(){return"true"}createFalse(){return"false"}createFloat(t){const r=super.createFloat(t);return Gf.isNegativeZero(t)?"-0_1":`${r}_1`}createFloatSingle(t,r,n,i){return`${super.createFloatSingle(t,r,n,i)}_2`}createFloatDouble(t,r,n,i,o,d,c,w){return`${super.createFloatDouble(t,r,n,i,o,d,c,w)}_3`}createByteString(t,r){const n=t.join(", ");return r===-1?`(_ ${n})`:`h'${n}`}createByteStringFromHeap(t,r){return`h'${Hi.from(super.createByteStringFromHeap(t,r)).toString("hex")}'`}createInfinity(){return"Infinity_1"}createInfinityNeg(){return"-Infinity_1"}createNaN(){return"NaN_1"}createNaNNeg(){return"-NaN_1"}createNull(){return"null"}createUndefined(){return"undefined"}createSimpleUnassigned(t){return`simple(${t})`}createArray(t,r){const n=super.createArray(t,r);return r===-1?`[_ ${n.join(", ")}]`:`[${n.join(", ")}]`}createMap(t,r){const n=super.createMap(t),i=Array.from(n.keys()).reduce(oa(n),"");return r===-1?`{_ ${i}}`:`{${i}}`}createObject(t,r){const n=super.createObject(t),i=Object.keys(n).reduce(oa(n),"");return r===-1?`{_ ${i}}`:`{${i}}`}createUtf8String(t,r){const n=t.join(", ");return r===-1?`(_ ${n})`:`"${n}"`}createUtf8StringFromHeap(t,r){return`"${Hi.from(super.createUtf8StringFromHeap(t,r)).toString("utf8")}"`}static diagnose(t,r){return typeof t=="string"&&(t=Hi.from(t,r||"hex")),new js().decodeFirst(t)}}var Lf=js;function oa(e){return(t,r)=>t?`${t}, ${r}: ${e[r]}`:`${r}: ${e[r]}`}const{Buffer:Ut}=_n,{URL:Hf}=Qo,bs=Ii.BigNumber,Di=Oi,ze=nt,mt=ze.MT,An=ze.NUMBYTES,ca=ze.SHIFT32,ua=ze.SYMS,Ar=ze.TAG,Df=ze.MT.SIMPLE_FLOAT<<5|ze.NUMBYTES.TWO,Kf=ze.MT.SIMPLE_FLOAT<<5|ze.NUMBYTES.FOUR,zf=ze.MT.SIMPLE_FLOAT<<5|ze.NUMBYTES.EIGHT,Wf=ze.MT.SIMPLE_FLOAT<<5|ze.SIMPLE.TRUE,Yf=ze.MT.SIMPLE_FLOAT<<5|ze.SIMPLE.FALSE,Zf=ze.MT.SIMPLE_FLOAT<<5|ze.SIMPLE.UNDEFINED,fa=ze.MT.SIMPLE_FLOAT<<5|ze.SIMPLE.NULL,Xf=new bs("0x20000000000000"),Jf=Ut.from("f97e00","hex"),Qf=Ut.from("f9fc00","hex"),el=Ut.from("f97c00","hex");function tl(e){return{}.toString.call(e).slice(8,-1)}class fi{constructor(t){t=t||{},this.streaming=typeof t.stream=="function",this.onData=t.stream,this.semanticTypes=[[Hf,this._pushUrl],[bs,this._pushBigNumber]];const r=t.genTypes||[],n=r.length;for(let i=0;i<n;i++)this.addSemanticType(r[i][0],r[i][1]);this._reset()}addSemanticType(t,r){const n=this.semanticTypes.length;for(let i=0;i<n;i++)if(this.semanticTypes[i][0]===t){const d=this.semanticTypes[i][1];return this.semanticTypes[i][1]=r,d}return this.semanticTypes.push([t,r]),null}push(t){return t&&(this.result[this.offset]=t,this.resultMethod[this.offset]=0,this.resultLength[this.offset]=t.length,this.offset++,this.streaming&&this.onData(this.finalize())),!0}pushWrite(t,r,n){return this.result[this.offset]=t,this.resultMethod[this.offset]=r,this.resultLength[this.offset]=n,this.offset++,this.streaming&&this.onData(this.finalize()),!0}_pushUInt8(t){return this.pushWrite(t,1,1)}_pushUInt16BE(t){return this.pushWrite(t,2,2)}_pushUInt32BE(t){return this.pushWrite(t,3,4)}_pushDoubleBE(t){return this.pushWrite(t,4,8)}_pushNaN(){return this.push(Jf)}_pushInfinity(t){const r=t<0?Qf:el;return this.push(r)}_pushFloat(t){const r=Ut.allocUnsafe(2);if(Di.writeHalf(r,t)&&Di.parseHalf(r)===t)return this._pushUInt8(Df)&&this.push(r);const n=Ut.allocUnsafe(4);return n.writeFloatBE(t,0),n.readFloatBE(0)===t?this._pushUInt8(Kf)&&this.push(n):this._pushUInt8(zf)&&this._pushDoubleBE(t)}_pushInt(t,r,n){const i=r<<5;return t<24?this._pushUInt8(i|t):t<=255?this._pushUInt8(i|An.ONE)&&this._pushUInt8(t):t<=65535?this._pushUInt8(i|An.TWO)&&this._pushUInt16BE(t):t<=4294967295?this._pushUInt8(i|An.FOUR)&&this._pushUInt32BE(t):t<=Number.MAX_SAFE_INTEGER?this._pushUInt8(i|An.EIGHT)&&this._pushUInt32BE(Math.floor(t/ca))&&this._pushUInt32BE(t%ca):r===mt.NEG_INT?this._pushFloat(n):this._pushFloat(t)}_pushIntNum(t){return t<0?this._pushInt(-t-1,mt.NEG_INT,t):this._pushInt(t,mt.POS_INT)}_pushNumber(t){switch(!1){case t===t:return this._pushNaN(t);case isFinite(t):return this._pushInfinity(t);case t%1!==0:return this._pushIntNum(t);default:return this._pushFloat(t)}}_pushString(t){const r=Ut.byteLength(t,"utf8");return this._pushInt(r,mt.UTF8_STRING)&&this.pushWrite(t,5,r)}_pushBoolean(t){return this._pushUInt8(t?Wf:Yf)}_pushUndefined(t){return this._pushUInt8(Zf)}_pushArray(t,r){const n=r.length;if(!t._pushInt(n,mt.ARRAY))return!1;for(let i=0;i<n;i++)if(!t.pushAny(r[i]))return!1;return!0}_pushTag(t){return this._pushInt(t,mt.TAG)}_pushDate(t,r){return t._pushTag(Ar.DATE_EPOCH)&&t.pushAny(Math.round(r/1e3))}_pushBuffer(t,r){return t._pushInt(r.length,mt.BYTE_STRING)&&t.push(r)}_pushNoFilter(t,r){return t._pushBuffer(t,r.slice())}_pushRegexp(t,r){return t._pushTag(Ar.REGEXP)&&t.pushAny(r.source)}_pushSet(t,r){if(!t._pushInt(r.size,mt.ARRAY))return!1;for(const n of r)if(!t.pushAny(n))return!1;return!0}_pushUrl(t,r){return t._pushTag(Ar.URI)&&t.pushAny(r.format())}_pushBigint(t){let r=Ar.POS_BIGINT;t.isNegative()&&(t=t.negated().minus(1),r=Ar.NEG_BIGINT);let n=t.toString(16);n.length%2&&(n="0"+n);const i=Ut.from(n,"hex");return this._pushTag(r)&&this._pushBuffer(this,i)}_pushBigNumber(t,r){if(r.isNaN())return t._pushNaN();if(!r.isFinite())return t._pushInfinity(r.isNegative()?-1/0:1/0);if(r.isInteger())return t._pushBigint(r);if(!(t._pushTag(Ar.DECIMAL_FRAC)&&t._pushInt(2,mt.ARRAY)))return!1;const n=r.decimalPlaces(),i=r.multipliedBy(new bs(10).pow(n));return t._pushIntNum(-n)?i.abs().isLessThan(Xf)?t._pushIntNum(i.toNumber()):t._pushBigint(i):!1}_pushMap(t,r){return t._pushInt(r.size,mt.MAP)?this._pushRawMap(r.size,Array.from(r)):!1}_pushObject(t){if(!t)return this._pushUInt8(fa);for(var r=this.semanticTypes.length,n=0;n<r;n++)if(t instanceof this.semanticTypes[n][0])return this.semanticTypes[n][1].call(t,this,t);var i=t.encodeCBOR;if(typeof i=="function")return i.call(t,this);var o=Object.keys(t),d=o.length;return this._pushInt(d,mt.MAP)?this._pushRawMap(d,o.map(c=>[c,t[c]])):!1}_pushRawMap(t,r){r=r.map(function(i){return i[0]=fi.encode(i[0]),i}).sort(Di.keySorter);for(var n=0;n<t;n++)if(!this.push(r[n][0])||!this.pushAny(r[n][1]))return!1;return!0}write(t){return this.pushAny(t)}pushAny(t){var r=tl(t);switch(r){case"Number":return this._pushNumber(t);case"String":return this._pushString(t);case"Boolean":return this._pushBoolean(t);case"Object":return this._pushObject(t);case"Array":return this._pushArray(this,t);case"Uint8Array":return this._pushBuffer(this,Ut.isBuffer(t)?t:Ut.from(t));case"Null":return this._pushUInt8(fa);case"Undefined":return this._pushUndefined(t);case"Map":return this._pushMap(this,t);case"Set":return this._pushSet(this,t);case"URL":return this._pushUrl(this,t);case"BigNumber":return this._pushBigNumber(this,t);case"Date":return this._pushDate(this,t);case"RegExp":return this._pushRegexp(this,t);case"Symbol":switch(t){case ua.NULL:return this._pushObject(null);case ua.UNDEFINED:return this._pushUndefined(void 0);default:throw new Error("Unknown symbol: "+t.toString())}default:throw new Error("Unknown type: "+typeof t+", "+(t?t.toString():""))}}finalize(){if(this.offset===0)return null;for(var t=this.result,r=this.resultLength,n=this.resultMethod,i=this.offset,o=0,d=0;d<i;d++)o+=r[d];var c=Ut.allocUnsafe(o),w=0,E=0;for(d=0;d<i;d++){switch(E=r[d],n[d]){case 0:t[d].copy(c,w);break;case 1:c.writeUInt8(t[d],w,!0);break;case 2:c.writeUInt16BE(t[d],w,!0);break;case 3:c.writeUInt32BE(t[d],w,!0);break;case 4:c.writeDoubleBE(t[d],w,!0);break;case 5:c.write(t[d],w,E,"utf8");break;default:throw new Error("unkown method")}w+=E}var A=c;return this._reset(),A}_reset(){this.result=[],this.resultMethod=[],this.resultLength=[],this.offset=0}static encode(t){const r=new fi;if(!r.pushAny(t))throw new Error("Failed to encode input");return r.finalize()}}var rl=fi;(function(e){e.Diagnose=Lf,e.Decoder=ec,e.Encoder=rl,e.Simple=Yo,e.Tagged=Zo,e.decodeAll=e.Decoder.decodeAll,e.decodeFirst=e.Decoder.decodeFirst,e.diagnose=e.Diagnose.diagnose,e.encode=e.Encoder.encode,e.decode=e.Decoder.decode,e.leveldb={decode:e.Decoder.decodeAll,encode:e.Encoder.encode,buffer:!0,name:"cbor"}})(zo);const tc=Iu(zo);function vt(e){return sn(Ps.create().update(new Uint8Array(e)).digest())}function Vn(e){if(e instanceof tc.Tagged)return Vn(e.value);if(typeof e=="string")return rc(e);if(typeof e=="number")return vt($e(e));if(e instanceof ArrayBuffer||ArrayBuffer.isView(e))return vt(e);if(Array.isArray(e)){const t=e.map(Vn);return vt(Bt(...t))}else{if(e&&typeof e=="object"&&e._isPrincipal)return vt(e.toUint8Array());if(typeof e=="object"&&e!==null&&typeof e.toHash=="function")return Vn(e.toHash());if(typeof e=="object")return li(e);if(typeof e=="bigint")return vt($e(e))}throw Object.assign(new Error(`Attempt to hash a value of unsupported type: ${e}`),{value:e})}const rc=e=>{const t=new TextEncoder().encode(e);return vt(t)};function ln(e){return li(e)}function li(e){const n=Object.entries(e).filter(([,d])=>d!==void 0).map(([d,c])=>{const w=rc(d),E=Vn(c);return[w,E]}).sort(([d],[c])=>ao(d,c)),i=Bt(...n.map(d=>Bt(...d)));return vt(i)}var nl=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r};const il=new TextEncoder().encode(`
ic-request`);class Gs{getPrincipal(){return this._principal||(this._principal=ve.selfAuthenticating(new Uint8Array(this.getPublicKey().toDer()))),this._principal}async transformRequest(t){const{body:r}=t,n=nl(t,["body"]),i=ln(r);return Object.assign(Object.assign({},n),{body:{content:r,sender_pubkey:this.getPublicKey().toDer(),sender_sig:await this.sign(Bt(il,i))}})}}class di{getPrincipal(){return ve.anonymous()}async transformRequest(t){return Object.assign(Object.assign({},t),{body:{content:t.body}})}}var lt={},Kr={},Pe={};Object.defineProperty(Pe,"__esModule",{value:!0});const sl=9007199254740992;function Ht(e,...t){const r=new Uint8Array(e.byteLength+t.reduce((i,o)=>i+o.byteLength,0));r.set(new Uint8Array(e),0);let n=e.byteLength;for(const i of t)r.set(new Uint8Array(i),n),n+=i.byteLength;return r.buffer}function At(e,t,r){r=r.replace(/[^0-9a-fA-F]/g,"");const n=2**(t-24);r=r.slice(-n*2).padStart(n*2,"0");const i=[(e<<5)+t].concat(r.match(/../g).map(o=>parseInt(o,16)));return new Uint8Array(i).buffer}function Ri(e,t){if(t<24)return new Uint8Array([(e<<5)+t]).buffer;{const r=t<=255?24:t<=65535?25:t<=4294967295?26:27;return At(e,r,t.toString(16))}}function nc(e){const t=[];for(let r=0;r<e.length;r++){let n=e.charCodeAt(r);n<128?t.push(n):n<2048?t.push(192|n>>6,128|n&63):n<55296||n>=57344?t.push(224|n>>12,128|n>>6&63,128|n&63):(r++,n=(n&1023)<<10|e.charCodeAt(r)&1023,t.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63))}return Ht(new Uint8Array(Ri(3,e.length)),new Uint8Array(t))}function al(e,t){if(e==14277111)return Ht(new Uint8Array([217,217,247]),t);if(e<24)return Ht(new Uint8Array([192+e]),t);{const r=e<=255?24:e<=65535?25:e<=4294967295?26:27,n=2**(r-24),i=e.toString(16).slice(-n*2).padStart(n*2,"0"),o=[192+r].concat(i.match(/../g).map(d=>parseInt(d,16)));return new Uint8Array(o).buffer}}Pe.tagged=al;function En(e){return new Uint8Array(e).buffer}Pe.raw=En;function Ls(e){if(isNaN(e))throw new RangeError("Invalid number.");e=Math.min(Math.max(0,e),23);const t=[0+e];return new Uint8Array(t).buffer}Pe.uSmall=Ls;function ic(e,t){if(e=parseInt(""+e,t),isNaN(e))throw new RangeError("Invalid number.");return e=Math.min(Math.max(0,e),255),e=e.toString(16),At(0,24,e)}Pe.u8=ic;function sc(e,t){if(e=parseInt(""+e,t),isNaN(e))throw new RangeError("Invalid number.");return e=Math.min(Math.max(0,e),65535),e=e.toString(16),At(0,25,e)}Pe.u16=sc;function ac(e,t){if(e=parseInt(""+e,t),isNaN(e))throw new RangeError("Invalid number.");return e=Math.min(Math.max(0,e),4294967295),e=e.toString(16),At(0,26,e)}Pe.u32=ac;function Hs(e,t){if(typeof e=="string"&&t==16){if(e.match(/[^0-9a-fA-F]/))throw new RangeError("Invalid number.");return At(0,27,e)}if(e=parseInt(""+e,t),isNaN(e))throw new RangeError("Invalid number.");return e=Math.min(Math.max(0,e),sl),e=e.toString(16),At(0,27,e)}Pe.u64=Hs;function oc(e){if(isNaN(e))throw new RangeError("Invalid number.");if(e===0)return Ls(0);e=Math.min(Math.max(0,-e),24)-1;const t=[32+e];return new Uint8Array(t).buffer}Pe.iSmall=oc;function cc(e,t){if(e=parseInt(""+e,t),isNaN(e))throw new RangeError("Invalid number.");return e=Math.min(Math.max(0,-e-1),255),e=e.toString(16),At(1,24,e)}Pe.i8=cc;function uc(e,t){if(e=parseInt(""+e,t),isNaN(e))throw new RangeError("Invalid number.");return e=Math.min(Math.max(0,-e-1),65535),e=e.toString(16),At(1,25,e)}Pe.i16=uc;function fc(e,t){if(e=parseInt(""+e,t),isNaN(e))throw new RangeError("Invalid number.");return e=Math.min(Math.max(0,-e-1),4294967295),e=e.toString(16),At(1,26,e)}Pe.i32=fc;function lc(e,t){if(typeof e=="string"&&t==16){if(e.startsWith("-")?e=e.slice(1):e="0",e.match(/[^0-9a-fA-F]/)||e.length>16)throw new RangeError("Invalid number.");let r=!1,n=e.split("").reduceRight((i,o)=>{if(r)return o+i;let d=parseInt(o,16)-1;return d>=0?(r=!0,d.toString(16)+i):"f"+i},"");return r?At(1,27,n):Hs(0)}if(e=parseInt(""+e,t),isNaN(e))throw new RangeError("Invalid number.");return e=Math.min(Math.max(0,-e-1),9007199254740992),e=e.toString(16),At(1,27,e)}Pe.i64=lc;function ol(e){return e>=0?e<24?Ls(e):e<=255?ic(e):e<=65535?sc(e):e<=4294967295?ac(e):Hs(e):e>=-24?oc(e):e>=-255?cc(e):e>=-65535?uc(e):e>=-4294967295?fc(e):lc(e)}Pe.number=ol;function cl(e){return Ht(Ri(2,e.byteLength),e)}Pe.bytes=cl;function ul(e){return nc(e)}Pe.string=ul;function fl(e){return Ht(Ri(4,e.length),...e)}Pe.array=fl;function ll(e,t=!1){e instanceof Map||(e=new Map(Object.entries(e)));let r=Array.from(e.entries());return t&&(r=r.sort(([n],[i])=>n.localeCompare(i))),Ht(Ri(5,e.size),...r.map(([n,i])=>Ht(nc(n),i)))}Pe.map=ll;function dl(e){const t=new Float32Array([e]);return Ht(new Uint8Array([250]),new Uint8Array(t.buffer))}Pe.singleFloat=dl;function hl(e){const t=new Float64Array([e]);return Ht(new Uint8Array([251]),new Uint8Array(t.buffer))}Pe.doubleFloat=hl;function pl(e){return e?dc():hc()}Pe.bool=pl;function dc(){return En(new Uint8Array([245]))}Pe.true_=dc;function hc(){return En(new Uint8Array([244]))}Pe.false_=hc;function yl(){return En(new Uint8Array([246]))}Pe.null_=yl;function gl(){return En(new Uint8Array([247]))}Pe.undefined_=gl;var wl=qr&&qr.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(Kr,"__esModule",{value:!0});const _t=wl(Pe),ml=[ArrayBuffer,Uint8Array,Uint16Array,Uint32Array,Int8Array,Int16Array,Int32Array,Float32Array,Float64Array];class pc{constructor(t,r=!1){this._serializer=t,this._stable=r,this.name="jsonDefault",this.priority=-100}match(t){return["undefined","boolean","number","string","object"].indexOf(typeof t)!=-1}encode(t){switch(typeof t){case"undefined":return _t.undefined_();case"boolean":return _t.bool(t);case"number":return Math.floor(t)===t?_t.number(t):_t.doubleFloat(t);case"string":return _t.string(t);case"object":if(t===null)return _t.null_();if(Array.isArray(t))return _t.array(t.map(r=>this._serializer.serializeValue(r)));if(ml.find(r=>t instanceof r))return _t.bytes(t.buffer);if(Object.getOwnPropertyNames(t).indexOf("toJSON")!==-1)return this.encode(t.toJSON());if(t instanceof Map){const r=new Map;for(const[n,i]of t.entries())r.set(n,this._serializer.serializeValue(i));return _t.map(r,this._stable)}else{const r=new Map;for(const[n,i]of Object.entries(t))r.set(n,this._serializer.serializeValue(i));return _t.map(r,this._stable)}default:throw new Error("Invalid value.")}}}Kr.JsonDefaultCborEncoder=pc;class yc{constructor(){this.name="cborEncoder",this.priority=-90}match(t){return typeof t=="object"&&typeof t.toCBOR=="function"}encode(t){return t.toCBOR()}}Kr.ToCborEncoder=yc;class gc{constructor(){this._encoders=new Set}static withDefaultEncoders(t=!1){const r=new this;return r.addEncoder(new pc(r,t)),r.addEncoder(new yc),r}removeEncoder(t){for(const r of this._encoders.values())r.name==t&&this._encoders.delete(r)}addEncoder(t){this._encoders.add(t)}getEncoderFor(t){let r=null;for(const n of this._encoders)(!r||n.priority>r.priority)&&n.match(t)&&(r=n);if(r===null)throw new Error("Could not find an encoder for value.");return r}serializeValue(t){return this.getEncoderFor(t).encode(t)}serialize(t){return this.serializeValue(t)}}Kr.CborSerializer=gc;class bl extends gc{serialize(t){return _t.raw(new Uint8Array([...new Uint8Array([217,217,247]),...new Uint8Array(super.serializeValue(t))]))}}Kr.SelfDescribeCborSerializer=bl;(function(e){function t(i){for(var o in i)e.hasOwnProperty(o)||(e[o]=i[o])}var r=qr&&qr.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var d in i)Object.hasOwnProperty.call(i,d)&&(o[d]=i[d]);return o.default=i,o};Object.defineProperty(e,"__esModule",{value:!0}),t(Kr);const n=r(Pe);e.value=n})(lt);class _l{get name(){return"Principal"}get priority(){return 0}match(t){return t&&t._isPrincipal===!0}encode(t){return lt.value.bytes(t.toUint8Array())}}class El{get name(){return"Buffer"}get priority(){return 1}match(t){return t instanceof ArrayBuffer||ArrayBuffer.isView(t)}encode(t){return lt.value.bytes(new Uint8Array(t))}}class xl{get name(){return"BigInt"}get priority(){return 1}match(t){return typeof t=="bigint"}encode(t){return t>BigInt(0)?lt.value.tagged(2,lt.value.bytes(Lt(t.toString(16)))):lt.value.tagged(3,lt.value.bytes(Lt((BigInt("-1")*t).toString(16))))}}const Ui=lt.SelfDescribeCborSerializer.withDefaultEncoders(!0);Ui.addEncoder(new _l);Ui.addEncoder(new El);Ui.addEncoder(new xl);var _s;(function(e){e[e.Uint64LittleEndian=71]="Uint64LittleEndian",e[e.Semantic=55799]="Semantic"})(_s||(_s={}));function Ki(e){return Ui.serialize(e)}function la(e){const t=e.byteLength;let r=BigInt(0);for(let n=0;n<t;n++)r=r*BigInt(256)+BigInt(e[n]);return r}class Tl extends tc.Decoder{createByteString(t){return Bt(...t)}createByteStringFromHeap(t,r){return t===r?new ArrayBuffer(0):new Uint8Array(this._heap.slice(t,r))}}function jt(e){const t=new Uint8Array(e),r=new Tl({size:t.byteLength,tags:{2:n=>la(n),3:n=>-la(n),[_s.Semantic]:n=>n}});try{return r.decodeFirst(t)}catch(n){throw new Error(`Failed to decode CBOR: ${n}, input: ${et(t)}`)}}const Nn=()=>{if(typeof window<"u"&&window.crypto&&window.crypto.getRandomValues){const e=new Uint32Array(1);return window.crypto.getRandomValues(e),e[0]}if(typeof crypto<"u"&&crypto.getRandomValues){const e=new Uint32Array(1);return crypto.getRandomValues(e),e[0]}return typeof crypto<"u"&&crypto.randomInt?crypto.randomInt(0,4294967295):Math.floor(Math.random()*4294967295)};var Es;(function(e){e.Call="call"})(Es||(Es={}));function xs(){const e=new ArrayBuffer(16),t=new DataView(e),r=Nn(),n=Nn(),i=Nn(),o=Nn();return t.setUint32(0,r),t.setUint32(4,n),t.setUint32(8,i),t.setUint32(12,o),e}const da=BigInt(1e6),vl=60*1e3;class Ir{constructor(t){if(t<90*1e3){const c=BigInt(Date.now()+t)*da/BigInt(1e9);this._value=c*BigInt(1e9);return}const o=BigInt(Math.floor(Date.now()+t-vl))*da/BigInt(1e9)/BigInt(60)*BigInt(60)*BigInt(1e9);this._value=o}toCBOR(){return lt.value.u64(this._value.toString(16),16)}toHash(){return $e(this._value)}}function ha(e=xs){return async t=>{const r=t.request.headers;t.request.headers=r,t.endpoint==="call"&&(t.body.nonce=e())}}function Xr(e){const t=[];return e.forEach((r,n)=>{t.push([n,r])}),t}class zi extends De{constructor(t,r){super(t),this.response=r,this.name=this.constructor.name,Object.setPrototypeOf(this,new.target.prototype)}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ds=BigInt(0),Ks=BigInt(1),Bl=BigInt(2);function Fi(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function ur(e){if(!Fi(e))throw new Error("Uint8Array expected")}function an(e,t){if(typeof t!="boolean")throw new Error(e+" boolean expected, got "+t)}const Al=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Er(e){ur(e);let t="";for(let r=0;r<e.length;r++)t+=Al[e[r]];return t}function wc(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?Ds:BigInt("0x"+e)}const Mt={_0:48,_9:57,A:65,F:70,a:97,f:102};function pa(e){if(e>=Mt._0&&e<=Mt._9)return e-Mt._0;if(e>=Mt.A&&e<=Mt.F)return e-(Mt.A-10);if(e>=Mt.a&&e<=Mt.f)return e-(Mt.a-10)}function mc(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);const t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(r);for(let i=0,o=0;i<r;i++,o+=2){const d=pa(e.charCodeAt(o)),c=pa(e.charCodeAt(o+1));if(d===void 0||c===void 0){const w=e[o]+e[o+1];throw new Error('hex string expected, got non-hex character "'+w+'" at index '+o)}n[i]=d*16+c}return n}function Tt(e){return wc(Er(e))}function on(e){return ur(e),wc(Er(Uint8Array.from(e).reverse()))}function Qe(e,t){return mc(e.toString(16).padStart(t*2,"0"))}function hi(e,t){return Qe(e,t).reverse()}function ct(e,t,r){let n;if(typeof t=="string")try{n=mc(t)}catch(o){throw new Error(e+" must be hex string or Uint8Array, cause: "+o)}else if(Fi(t))n=Uint8Array.from(t);else throw new Error(e+" must be hex string or Uint8Array");const i=n.length;if(typeof r=="number"&&i!==r)throw new Error(e+" of length "+r+" expected, got "+i);return n}function Le(...e){let t=0;for(let n=0;n<e.length;n++){const i=e[n];ur(i),t+=i.length}const r=new Uint8Array(t);for(let n=0,i=0;n<e.length;n++){const o=e[n];r.set(o,i),i+=o.length}return r}function zs(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}const Wi=e=>typeof e=="bigint"&&Ds<=e;function bc(e,t,r){return Wi(e)&&Wi(t)&&Wi(r)&&t<=e&&e<r}function nr(e,t,r,n){if(!bc(t,r,n))throw new Error("expected valid "+e+": "+r+" <= n < "+n+", got "+t)}function cn(e){let t;for(t=0;e>Ds;e>>=Ks,t+=1);return t}function Nl(e,t){return e>>BigInt(t)&Ks}const $n=e=>(Bl<<BigInt(e-1))-Ks,Sl={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",stringOrUint8Array:e=>typeof e=="string"||Fi(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function xn(e,t,r={}){const n=(i,o,d)=>{const c=Sl[o];if(typeof c!="function")throw new Error("invalid validator function");const w=e[i];if(!(d&&w===void 0)&&!c(w,e))throw new Error("param "+String(i)+" is invalid. Expected "+o+", got "+w)};for(const[i,o]of Object.entries(t))n(i,o,!1);for(const[i,o]of Object.entries(r))n(i,o,!0);return e}const ya=()=>{throw new Error("not implemented")};function dn(e){const t=new WeakMap;return(r,...n)=>{const i=t.get(r);if(i!==void 0)return i;const o=e(r,...n);return t.set(r,o),o}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Je=BigInt(0),Ce=BigInt(1),ir=BigInt(2),Il=BigInt(3),Ts=BigInt(4),ga=BigInt(5),wa=BigInt(8);function Ve(e,t){const r=e%t;return r>=Je?r:t+r}function Ol(e,t,r){if(t<Je)throw new Error("invalid exponent, negatives unsupported");if(r<=Je)throw new Error("invalid modulus");if(r===Ce)return Je;let n=Ce;for(;t>Je;)t&Ce&&(n=n*e%r),e=e*e%r,t>>=Ce;return n}function St(e,t,r){let n=e;for(;t-- >Je;)n*=n,n%=r;return n}function ma(e,t){if(e===Je)throw new Error("invert: expected non-zero number");if(t<=Je)throw new Error("invert: expected positive modulus, got "+t);let r=Ve(e,t),n=t,i=Je,o=Ce;for(;r!==Je;){const c=n/r,w=n%r,E=i-o*c;n=r,r=w,i=o,o=E}if(n!==Ce)throw new Error("invert: does not exist");return Ve(i,t)}function Rl(e){const t=(e-Ce)/ir;let r,n,i;for(r=e-Ce,n=0;r%ir===Je;r/=ir,n++);for(i=ir;i<e&&Ol(i,t,e)!==e-Ce;i++)if(i>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){const d=(e+Ce)/Ts;return function(w,E){const A=w.pow(E,d);if(!w.eql(w.sqr(A),E))throw new Error("Cannot find square root");return A}}const o=(r+Ce)/ir;return function(c,w){if(c.pow(w,t)===c.neg(c.ONE))throw new Error("Cannot find square root");let E=n,A=c.pow(c.mul(c.ONE,i),r),I=c.pow(w,o),S=c.pow(w,r);for(;!c.eql(S,c.ONE);){if(c.eql(S,c.ZERO))return c.ZERO;let N=1;for(let j=c.sqr(S);N<E&&!c.eql(j,c.ONE);N++)j=c.sqr(j);const b=c.pow(A,Ce<<BigInt(E-N-1));A=c.sqr(b),I=c.mul(I,b),S=c.mul(S,A),E=N}return I}}function Ul(e){if(e%Ts===Il){const t=(e+Ce)/Ts;return function(n,i){const o=n.pow(i,t);if(!n.eql(n.sqr(o),i))throw new Error("Cannot find square root");return o}}if(e%wa===ga){const t=(e-ga)/wa;return function(n,i){const o=n.mul(i,ir),d=n.pow(o,t),c=n.mul(i,d),w=n.mul(n.mul(c,ir),d),E=n.mul(c,n.sub(w,n.ONE));if(!n.eql(n.sqr(E),i))throw new Error("Cannot find square root");return E}}return Rl(e)}const Fl=(e,t)=>(Ve(e,t)&Ce)===Ce,Pl=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function _c(e){const t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=Pl.reduce((n,i)=>(n[i]="function",n),t);return xn(e,r)}function qn(e,t,r){if(r<Je)throw new Error("invalid exponent, negatives unsupported");if(r===Je)return e.ONE;if(r===Ce)return t;let n=e.ONE,i=t;for(;r>Je;)r&Ce&&(n=e.mul(n,i)),i=e.sqr(i),r>>=Ce;return n}function jn(e,t){const r=new Array(t.length),n=t.reduce((o,d,c)=>e.is0(d)?o:(r[c]=o,e.mul(o,d)),e.ONE),i=e.inv(n);return t.reduceRight((o,d,c)=>e.is0(d)?o:(r[c]=e.mul(o,r[c]),e.mul(o,d)),i),r}function kl(e){const t=(e-Ce)/ir;return(r,n)=>r.pow(n,t)}function Ec(e,t){const r=t!==void 0?t:e.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function Tn(e,t,r=!1,n={}){if(e<=Je)throw new Error("invalid field: expected ORDER > 0, got "+e);const{nBitLength:i,nByteLength:o}=Ec(e,t);if(o>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let d;const c=Object.freeze({ORDER:e,isLE:r,BITS:i,BYTES:o,MASK:$n(i),ZERO:Je,ONE:Ce,create:w=>Ve(w,e),isValid:w=>{if(typeof w!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof w);return Je<=w&&w<e},is0:w=>w===Je,isOdd:w=>(w&Ce)===Ce,neg:w=>Ve(-w,e),eql:(w,E)=>w===E,sqr:w=>Ve(w*w,e),add:(w,E)=>Ve(w+E,e),sub:(w,E)=>Ve(w-E,e),mul:(w,E)=>Ve(w*E,e),pow:(w,E)=>qn(c,w,E),div:(w,E)=>Ve(w*ma(E,e),e),sqrN:w=>w*w,addN:(w,E)=>w+E,subN:(w,E)=>w-E,mulN:(w,E)=>w*E,inv:w=>ma(w,e),sqrt:n.sqrt||(w=>(d||(d=Ul(e)),d(c,w))),invertBatch:w=>jn(c,w),cmov:(w,E,A)=>A?E:w,toBytes:w=>r?hi(w,o):Qe(w,o),fromBytes:w=>{if(w.length!==o)throw new Error("Field.fromBytes: expected "+o+" bytes, got "+w.length);return r?on(w):Tt(w)}});return Object.freeze(c)}function xc(e){if(typeof e!="bigint")throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function Tc(e){const t=xc(e);return t+Math.ceil(t/2)}function Cl(e,t,r=!1){const n=e.length,i=xc(t),o=Tc(t);if(n<16||n<o||n>1024)throw new Error("expected "+o+"-1024 bytes of input, got "+n);const d=r?on(e):Tt(e),c=Ve(d,t-Ce)+Ce;return r?hi(c,i):Qe(c,i)}const Ml=Tt;function Jt(e,t){if(hn(e),hn(t),e<0||e>=1<<8*t)throw new Error("invalid I2OSP input: "+e);const r=Array.from({length:t}).fill(0);for(let n=t-1;n>=0;n--)r[n]=e&255,e>>>=8;return new Uint8Array(r)}function Vl(e,t){const r=new Uint8Array(e.length);for(let n=0;n<e.length;n++)r[n]=e[n]^t[n];return r}function hn(e){if(!Number.isSafeInteger(e))throw new Error("number expected")}function $l(e,t,r,n){ur(e),ur(t),hn(r),t.length>255&&(t=n(Le(zs("H2C-OVERSIZE-DST-"),t)));const{outputLen:i,blockLen:o}=n,d=Math.ceil(r/i);if(r>65535||d>255)throw new Error("expand_message_xmd: invalid lenInBytes");const c=Le(t,Jt(t.length,1)),w=Jt(0,o),E=Jt(r,2),A=new Array(d),I=n(Le(w,e,E,Jt(0,1),c));A[0]=n(Le(I,Jt(1,1),c));for(let N=1;N<=d;N++){const b=[Vl(I,A[N-1]),Jt(N+1,1),c];A[N]=n(Le(...b))}return Le(...A).slice(0,r)}function ql(e,t,r,n,i){if(ur(e),ur(t),hn(r),t.length>255){const o=Math.ceil(2*n/8);t=i.create({dkLen:o}).update(zs("H2C-OVERSIZE-DST-")).update(t).digest()}if(r>65535||t.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:r}).update(e).update(Jt(r,2)).update(t).update(Jt(t.length,1)).digest()}function ba(e,t,r){xn(r,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});const{p:n,k:i,m:o,hash:d,expand:c,DST:w}=r;ur(e),hn(t);const E=typeof w=="string"?zs(w):w,A=n.toString(2).length,I=Math.ceil((A+i)/8),S=t*o*I;let N;if(c==="xmd")N=$l(e,E,S,d);else if(c==="xof")N=ql(e,E,S,i,d);else if(c==="_internal_pass")N=e;else throw new Error('expand must be "xmd" or "xof"');const b=new Array(t);for(let j=0;j<t;j++){const V=new Array(o);for(let W=0;W<o;W++){const K=I*(W+j*o),$=N.subarray(K,K+I);V[W]=Ve(Ml($),n)}b[j]=V}return b}function vc(e,t){const r=t.map(n=>Array.from(n).reverse());return(n,i)=>{const[o,d,c,w]=r.map(E=>E.reduce((A,I)=>e.add(e.mul(A,n),I)));return n=e.div(o,d),i=e.mul(i,e.div(c,w)),{x:n,y:i}}}function _a(e,t,r){if(typeof t!="function")throw new Error("mapToCurve() must be defined");return{hashToCurve(n,i){const o=ba(n,2,{...r,DST:r.DST,...i}),d=e.fromAffine(t(o[0])),c=e.fromAffine(t(o[1])),w=d.add(c).clearCofactor();return w.assertValidity(),w},encodeToCurve(n,i){const o=ba(n,1,{...r,DST:r.encodeDST,...i}),d=e.fromAffine(t(o[0])).clearCofactor();return d.assertValidity(),d},mapToCurve(n){if(!Array.isArray(n))throw new Error("mapToCurve: expected array of bigints");for(const o of n)if(typeof o!="bigint")throw new Error("mapToCurve: expected array of bigints");const i=e.fromAffine(t(n)).clearCofactor();return i.assertValidity(),i}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ea=BigInt(0),Sn=BigInt(1);function Yi(e,t){const r=t.negate();return e?r:t}function Bc(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function Zi(e,t){Bc(e,t);const r=Math.ceil(t/e)+1,n=2**(e-1);return{windows:r,windowSize:n}}function jl(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((r,n)=>{if(!(r instanceof t))throw new Error("invalid point at index "+n)})}function Gl(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((r,n)=>{if(!t.isValid(r))throw new Error("invalid scalar at index "+n)})}const Xi=new WeakMap,Ac=new WeakMap;function Ji(e){return Ac.get(e)||1}function Nc(e,t){return{constTimeNegate:Yi,hasPrecomputes(r){return Ji(r)!==1},unsafeLadder(r,n,i=e.ZERO){let o=r;for(;n>Ea;)n&Sn&&(i=i.add(o)),o=o.double(),n>>=Sn;return i},precomputeWindow(r,n){const{windows:i,windowSize:o}=Zi(n,t),d=[];let c=r,w=c;for(let E=0;E<i;E++){w=c,d.push(w);for(let A=1;A<o;A++)w=w.add(c),d.push(w);c=w.double()}return d},wNAF(r,n,i){const{windows:o,windowSize:d}=Zi(r,t);let c=e.ZERO,w=e.BASE;const E=BigInt(2**r-1),A=2**r,I=BigInt(r);for(let S=0;S<o;S++){const N=S*d;let b=Number(i&E);i>>=I,b>d&&(b-=A,i+=Sn);const j=N,V=N+Math.abs(b)-1,W=S%2!==0,K=b<0;b===0?w=w.add(Yi(W,n[j])):c=c.add(Yi(K,n[V]))}return{p:c,f:w}},wNAFUnsafe(r,n,i,o=e.ZERO){const{windows:d,windowSize:c}=Zi(r,t),w=BigInt(2**r-1),E=2**r,A=BigInt(r);for(let I=0;I<d;I++){const S=I*c;if(i===Ea)break;let N=Number(i&w);if(i>>=A,N>c&&(N-=E,i+=Sn),N===0)continue;let b=n[S+Math.abs(N)-1];N<0&&(b=b.negate()),o=o.add(b)}return o},getPrecomputes(r,n,i){let o=Xi.get(n);return o||(o=this.precomputeWindow(n,r),r!==1&&Xi.set(n,i(o))),o},wNAFCached(r,n,i){const o=Ji(r);return this.wNAF(o,this.getPrecomputes(o,r,i),n)},wNAFCachedUnsafe(r,n,i,o){const d=Ji(r);return d===1?this.unsafeLadder(r,n,o):this.wNAFUnsafe(d,this.getPrecomputes(d,r,i),n,o)},setWindowSize(r,n){Bc(n,t),Ac.set(r,n),Xi.delete(r)}}}function Sc(e,t,r,n){if(jl(r,e),Gl(n,t),r.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const i=e.ZERO,o=cn(BigInt(r.length)),d=o>12?o-3:o>4?o-2:o?2:1,c=(1<<d)-1,w=new Array(c+1).fill(i),E=Math.floor((t.BITS-1)/d)*d;let A=i;for(let I=E;I>=0;I-=d){w.fill(i);for(let N=0;N<n.length;N++){const b=n[N],j=Number(b>>BigInt(I)&BigInt(c));w[j]=w[j].add(r[N])}let S=i;for(let N=w.length-1,b=i;N>0;N--)b=b.add(w[N]),S=S.add(b);if(A=A.add(S),I!==0)for(let N=0;N<d;N++)A=A.double()}return A}function Ic(e){return _c(e.Fp),xn(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Ec(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Ll(e){const t=Ic(e);xn(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:r,Fp:n,a:i}=t;if(r){if(!n.eql(i,n.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...t})}const yr=BigInt(0),qe=BigInt(1),zt=BigInt(2),pi=BigInt(3),xa=BigInt(4);function Ta(e){const t=Ll(e),{Fp:r}=t,n=Tn(t.n,t.nBitLength),i=t.toBytes||((j,V,W)=>{const K=V.toAffine();return Le(Uint8Array.from([4]),r.toBytes(K.x),r.toBytes(K.y))}),o=t.fromBytes||(j=>{const V=j.subarray(1),W=r.fromBytes(V.subarray(0,r.BYTES)),K=r.fromBytes(V.subarray(r.BYTES,2*r.BYTES));return{x:W,y:K}});function d(j){const{a:V,b:W}=t,K=r.sqr(j),$=r.mul(K,j);return r.add(r.add($,r.mul(j,V)),W)}if(!r.eql(r.sqr(t.Gy),d(t.Gx)))throw new Error("bad generator point: equation left != right");function c(j){return bc(j,qe,t.n)}function w(j){const{allowedPrivateKeyLengths:V,nByteLength:W,wrapPrivateKey:K,n:$}=t;if(V&&typeof j!="bigint"){if(Fi(j)&&(j=Er(j)),typeof j!="string"||!V.includes(j.length))throw new Error("invalid private key");j=j.padStart(W*2,"0")}let ie;try{ie=typeof j=="bigint"?j:Tt(ct("private key",j,W))}catch{throw new Error("invalid private key, expected hex or "+W+" bytes, got "+typeof j)}return K&&(ie=Ve(ie,$)),nr("private key",ie,qe,$),ie}function E(j){if(!(j instanceof S))throw new Error("ProjectivePoint expected")}const A=dn((j,V)=>{const{px:W,py:K,pz:$}=j;if(r.eql($,r.ONE))return{x:W,y:K};const ie=j.is0();V==null&&(V=ie?r.ONE:r.inv($));const C=r.mul(W,V),Z=r.mul(K,V),q=r.mul($,V);if(ie)return{x:r.ZERO,y:r.ZERO};if(!r.eql(q,r.ONE))throw new Error("invZ was invalid");return{x:C,y:Z}}),I=dn(j=>{if(j.is0()){if(t.allowInfinityPoint&&!r.is0(j.py))return;throw new Error("bad point: ZERO")}const{x:V,y:W}=j.toAffine();if(!r.isValid(V)||!r.isValid(W))throw new Error("bad point: x or y not FE");const K=r.sqr(W),$=d(V);if(!r.eql(K,$))throw new Error("bad point: equation left != right");if(!j.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class S{constructor(V,W,K){if(this.px=V,this.py=W,this.pz=K,V==null||!r.isValid(V))throw new Error("x required");if(W==null||!r.isValid(W))throw new Error("y required");if(K==null||!r.isValid(K))throw new Error("z required");Object.freeze(this)}static fromAffine(V){const{x:W,y:K}=V||{};if(!V||!r.isValid(W)||!r.isValid(K))throw new Error("invalid affine point");if(V instanceof S)throw new Error("projective point not allowed");const $=ie=>r.eql(ie,r.ZERO);return $(W)&&$(K)?S.ZERO:new S(W,K,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(V){const W=r.invertBatch(V.map(K=>K.pz));return V.map((K,$)=>K.toAffine(W[$])).map(S.fromAffine)}static fromHex(V){const W=S.fromAffine(o(ct("pointHex",V)));return W.assertValidity(),W}static fromPrivateKey(V){return S.BASE.multiply(w(V))}static msm(V,W){return Sc(S,n,V,W)}_setWindowSize(V){b.setWindowSize(this,V)}assertValidity(){I(this)}hasEvenY(){const{y:V}=this.toAffine();if(r.isOdd)return!r.isOdd(V);throw new Error("Field doesn't support isOdd")}equals(V){E(V);const{px:W,py:K,pz:$}=this,{px:ie,py:C,pz:Z}=V,q=r.eql(r.mul(W,Z),r.mul(ie,$)),Q=r.eql(r.mul(K,Z),r.mul(C,$));return q&&Q}negate(){return new S(this.px,r.neg(this.py),this.pz)}double(){const{a:V,b:W}=t,K=r.mul(W,pi),{px:$,py:ie,pz:C}=this;let Z=r.ZERO,q=r.ZERO,Q=r.ZERO,re=r.mul($,$),X=r.mul(ie,ie),de=r.mul(C,C),fe=r.mul($,ie);return fe=r.add(fe,fe),Q=r.mul($,C),Q=r.add(Q,Q),Z=r.mul(V,Q),q=r.mul(K,de),q=r.add(Z,q),Z=r.sub(X,q),q=r.add(X,q),q=r.mul(Z,q),Z=r.mul(fe,Z),Q=r.mul(K,Q),de=r.mul(V,de),fe=r.sub(re,de),fe=r.mul(V,fe),fe=r.add(fe,Q),Q=r.add(re,re),re=r.add(Q,re),re=r.add(re,de),re=r.mul(re,fe),q=r.add(q,re),de=r.mul(ie,C),de=r.add(de,de),re=r.mul(de,fe),Z=r.sub(Z,re),Q=r.mul(de,X),Q=r.add(Q,Q),Q=r.add(Q,Q),new S(Z,q,Q)}add(V){E(V);const{px:W,py:K,pz:$}=this,{px:ie,py:C,pz:Z}=V;let q=r.ZERO,Q=r.ZERO,re=r.ZERO;const X=t.a,de=r.mul(t.b,pi);let fe=r.mul(W,ie),R=r.mul(K,C),P=r.mul($,Z),z=r.add(W,K),M=r.add(ie,C);z=r.mul(z,M),M=r.add(fe,R),z=r.sub(z,M),M=r.add(W,$);let G=r.add(ie,Z);return M=r.mul(M,G),G=r.add(fe,P),M=r.sub(M,G),G=r.add(K,$),q=r.add(C,Z),G=r.mul(G,q),q=r.add(R,P),G=r.sub(G,q),re=r.mul(X,M),q=r.mul(de,P),re=r.add(q,re),q=r.sub(R,re),re=r.add(R,re),Q=r.mul(q,re),R=r.add(fe,fe),R=r.add(R,fe),P=r.mul(X,P),M=r.mul(de,M),R=r.add(R,P),P=r.sub(fe,P),P=r.mul(X,P),M=r.add(M,P),fe=r.mul(R,M),Q=r.add(Q,fe),fe=r.mul(G,M),q=r.mul(z,q),q=r.sub(q,fe),fe=r.mul(z,R),re=r.mul(G,re),re=r.add(re,fe),new S(q,Q,re)}subtract(V){return this.add(V.negate())}is0(){return this.equals(S.ZERO)}wNAF(V){return b.wNAFCached(this,V,S.normalizeZ)}multiplyUnsafe(V){const{endo:W,n:K}=t;nr("scalar",V,yr,K);const $=S.ZERO;if(V===yr)return $;if(this.is0()||V===qe)return this;if(!W||b.hasPrecomputes(this))return b.wNAFCachedUnsafe(this,V,S.normalizeZ);let{k1neg:ie,k1:C,k2neg:Z,k2:q}=W.splitScalar(V),Q=$,re=$,X=this;for(;C>yr||q>yr;)C&qe&&(Q=Q.add(X)),q&qe&&(re=re.add(X)),X=X.double(),C>>=qe,q>>=qe;return ie&&(Q=Q.negate()),Z&&(re=re.negate()),re=new S(r.mul(re.px,W.beta),re.py,re.pz),Q.add(re)}multiply(V){const{endo:W,n:K}=t;nr("scalar",V,qe,K);let $,ie;if(W){const{k1neg:C,k1:Z,k2neg:q,k2:Q}=W.splitScalar(V);let{p:re,f:X}=this.wNAF(Z),{p:de,f:fe}=this.wNAF(Q);re=b.constTimeNegate(C,re),de=b.constTimeNegate(q,de),de=new S(r.mul(de.px,W.beta),de.py,de.pz),$=re.add(de),ie=X.add(fe)}else{const{p:C,f:Z}=this.wNAF(V);$=C,ie=Z}return S.normalizeZ([$,ie])[0]}multiplyAndAddUnsafe(V,W,K){const $=S.BASE,ie=(Z,q)=>q===yr||q===qe||!Z.equals($)?Z.multiplyUnsafe(q):Z.multiply(q),C=ie(this,W).add(ie(V,K));return C.is0()?void 0:C}toAffine(V){return A(this,V)}isTorsionFree(){const{h:V,isTorsionFree:W}=t;if(V===qe)return!0;if(W)return W(S,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:V,clearCofactor:W}=t;return V===qe?this:W?W(S,this):this.multiplyUnsafe(t.h)}toRawBytes(V=!0){return an("isCompressed",V),this.assertValidity(),i(S,this,V)}toHex(V=!0){return an("isCompressed",V),Er(this.toRawBytes(V))}}S.BASE=new S(t.Gx,t.Gy,r.ONE),S.ZERO=new S(r.ZERO,r.ONE,r.ZERO);const N=t.nBitLength,b=Nc(S,t.endo?Math.ceil(N/2):N);return{CURVE:t,ProjectivePoint:S,normPrivateKeyToScalar:w,weierstrassEquation:d,isWithinCurveOrder:c}}function Hl(e,t){const r=e.ORDER;let n=yr;for(let b=r-qe;b%zt===yr;b/=zt)n+=qe;const i=n,o=zt<<i-qe-qe,d=o*zt,c=(r-qe)/d,w=(c-qe)/zt,E=d-qe,A=o,I=e.pow(t,c),S=e.pow(t,(c+qe)/zt);let N=(b,j)=>{let V=I,W=e.pow(j,E),K=e.sqr(W);K=e.mul(K,j);let $=e.mul(b,K);$=e.pow($,w),$=e.mul($,W),W=e.mul($,j),K=e.mul($,b);let ie=e.mul(K,W);$=e.pow(ie,A);let C=e.eql($,e.ONE);W=e.mul(K,S),$=e.mul(ie,V),K=e.cmov(W,K,C),ie=e.cmov($,ie,C);for(let Z=i;Z>qe;Z--){let q=Z-zt;q=zt<<q-qe;let Q=e.pow(ie,q);const re=e.eql(Q,e.ONE);W=e.mul(K,V),V=e.mul(V,V),Q=e.mul(ie,V),K=e.cmov(W,K,re),ie=e.cmov(Q,ie,re)}return{isValid:C,value:K}};if(e.ORDER%xa===pi){const b=(e.ORDER-pi)/xa,j=e.sqrt(e.neg(t));N=(V,W)=>{let K=e.sqr(W);const $=e.mul(V,W);K=e.mul(K,$);let ie=e.pow(K,b);ie=e.mul(ie,$);const C=e.mul(ie,j),Z=e.mul(e.sqr(ie),W),q=e.eql(Z,V);let Q=e.cmov(C,ie,q);return{isValid:q,value:Q}}}return N}function Oc(e,t){if(_c(e),!e.isValid(t.A)||!e.isValid(t.B)||!e.isValid(t.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");const r=Hl(e,t.Z);if(!e.isOdd)throw new Error("Fp.isOdd is not implemented!");return n=>{let i,o,d,c,w,E,A,I;i=e.sqr(n),i=e.mul(i,t.Z),o=e.sqr(i),o=e.add(o,i),d=e.add(o,e.ONE),d=e.mul(d,t.B),c=e.cmov(t.Z,e.neg(o),!e.eql(o,e.ZERO)),c=e.mul(c,t.A),o=e.sqr(d),E=e.sqr(c),w=e.mul(E,t.A),o=e.add(o,w),o=e.mul(o,d),E=e.mul(E,c),w=e.mul(E,t.B),o=e.add(o,w),A=e.mul(i,d);const{isValid:S,value:N}=r(o,E);I=e.mul(i,n),I=e.mul(I,N),A=e.cmov(A,d,S),I=e.cmov(I,N,S);const b=e.isOdd(n)===e.isOdd(I);return I=e.cmov(e.neg(I),I,b),A=e.div(A,c),{x:A,y:I}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Dl=BigInt(0),In=BigInt(1),va=BigInt(2),Cr=BigInt(3);function Kl(e){const t=[];for(;e>In;e>>=In)(e&In)===Dl?t.unshift(0):(e&Cr)===Cr?(t.unshift(-1),e+=In):t.unshift(1);return t}function zl(e){const{Fp:t,Fr:r,Fp2:n,Fp6:i,Fp12:o}=e.fields,d=e.params.xNegative,c=e.params.twistType,w=Ta({n:r.ORDER,...e.G1}),E=Object.assign(w,_a(w.ProjectivePoint,e.G1.mapToCurve,{...e.htfDefaults,...e.G1.htfDefaults})),A=Ta({n:r.ORDER,...e.G2}),I=Object.assign(A,_a(A.ProjectivePoint,e.G2.mapToCurve,{...e.htfDefaults,...e.G2.htfDefaults}));let S;if(c==="multiplicative")S=(te,_,se,ue,he,ne)=>o.mul014(ue,te,n.mul(_,he),n.mul(se,ne));else if(c==="divisive")S=(te,_,se,ue,he,ne)=>o.mul034(ue,n.mul(se,ne),n.mul(_,he),te);else throw new Error("bls: unknown twist type");const N=n.div(n.ONE,n.mul(n.ONE,va));function b(te,_,se,ue){const he=n.sqr(se),ne=n.sqr(ue),ce=n.mulByB(n.mul(ne,Cr)),m=n.mul(ce,Cr),s=n.sub(n.sub(n.sqr(n.add(se,ue)),ne),he),h=n.sub(ce,he),x=n.mul(n.sqr(_),Cr),v=n.neg(s);return te.push([h,x,v]),_=n.mul(n.mul(n.mul(n.sub(he,m),_),se),N),se=n.sub(n.sqr(n.mul(n.add(he,m),N)),n.mul(n.sqr(ce),Cr)),ue=n.mul(he,s),{Rx:_,Ry:se,Rz:ue}}function j(te,_,se,ue,he,ne){const ce=n.sub(se,n.mul(ne,ue)),m=n.sub(_,n.mul(he,ue)),s=n.sub(n.mul(ce,he),n.mul(m,ne)),h=n.neg(ce),x=m;te.push([s,h,x]);const v=n.sqr(m),U=n.mul(v,m),p=n.mul(v,_),a=n.add(n.sub(U,n.mul(p,va)),n.mul(n.sqr(ce),ue));return _=n.mul(m,a),se=n.sub(n.mul(n.sub(p,a),ce),n.mul(U,se)),ue=n.mul(ue,U),{Rx:_,Ry:se,Rz:ue}}const V=Kl(e.params.ateLoopSize),W=dn(te=>{const _=te,{x:se,y:ue}=_.toAffine(),he=se,ne=ue,ce=n.neg(ue);let m=he,s=ne,h=n.ONE;const x=[];for(const v of V){const U=[];({Rx:m,Ry:s,Rz:h}=b(U,m,s,h)),v&&({Rx:m,Ry:s,Rz:h}=j(U,m,s,h,he,v===-1?ce:ne)),x.push(U)}if(e.postPrecompute){const v=x[x.length-1];e.postPrecompute(m,s,h,he,ne,j.bind(null,v))}return x});function K(te,_=!1){let se=o.ONE;if(te.length){const ue=te[0][0].length;for(let he=0;he<ue;he++){se=o.sqr(se);for(const[ne,ce,m]of te)for(const[s,h,x]of ne[he])se=S(s,h,x,se,ce,m)}}return d&&(se=o.conjugate(se)),_?o.finalExponentiate(se):se}function $(te,_=!0){const se=[];E.ProjectivePoint.normalizeZ(te.map(({g1:ue})=>ue)),I.ProjectivePoint.normalizeZ(te.map(({g2:ue})=>ue));for(const{g1:ue,g2:he}of te){if(ue.equals(E.ProjectivePoint.ZERO)||he.equals(I.ProjectivePoint.ZERO))throw new Error("pairing is not available for ZERO point");ue.assertValidity(),he.assertValidity();const ne=ue.toAffine();se.push([W(he),ne.x,ne.y])}return K(se,_)}function ie(te,_,se=!0){return $([{g1:te,g2:_}],se)}const C={randomPrivateKey:()=>{const te=Tc(r.ORDER);return Cl(e.randomBytes(te),r.ORDER)},calcPairingPrecomputes:W},{ShortSignature:Z}=e.G1,{Signature:q}=e.G2;function Q(te){return te instanceof E.ProjectivePoint?te:E.ProjectivePoint.fromHex(te)}function re(te,_){return te instanceof E.ProjectivePoint?te:E.hashToCurve(ct("point",te),_)}function X(te){return te instanceof I.ProjectivePoint?te:q.fromHex(te)}function de(te,_){return te instanceof I.ProjectivePoint?te:I.hashToCurve(ct("point",te),_)}function fe(te){return E.ProjectivePoint.fromPrivateKey(te).toRawBytes(!0)}function R(te){return I.ProjectivePoint.fromPrivateKey(te).toRawBytes(!0)}function P(te,_,se){const ue=de(te,se);ue.assertValidity();const he=ue.multiply(E.normPrivateKeyToScalar(_));return te instanceof I.ProjectivePoint?he:q.toRawBytes(he)}function z(te,_,se){const ue=re(te,se);ue.assertValidity();const he=ue.multiply(E.normPrivateKeyToScalar(_));return te instanceof E.ProjectivePoint?he:Z.toRawBytes(he)}function M(te,_,se,ue){const he=Q(se),ne=de(_,ue),ce=E.ProjectivePoint.BASE,m=X(te),s=$([{g1:he.negate(),g2:ne},{g1:ce,g2:m}]);return o.eql(s,o.ONE)}function G(te,_,se,ue){const he=X(se),ne=re(_,ue),ce=I.ProjectivePoint.BASE,m=Q(te),s=$([{g1:ne,g2:he},{g1:m,g2:ce.negate()}]);return o.eql(s,o.ONE)}function J(te){if(!Array.isArray(te)||te.length===0)throw new Error("expected non-empty array")}function ee(te){J(te);const se=te.map(Q).reduce((ue,he)=>ue.add(he),E.ProjectivePoint.ZERO);return te[0]instanceof E.ProjectivePoint?(se.assertValidity(),se):se.toRawBytes(!0)}function ge(te){J(te);const se=te.map(X).reduce((ue,he)=>ue.add(he),I.ProjectivePoint.ZERO);return te[0]instanceof I.ProjectivePoint?(se.assertValidity(),se):q.toRawBytes(se)}function ae(te){J(te);const se=te.map(Q).reduce((ue,he)=>ue.add(he),E.ProjectivePoint.ZERO);return te[0]instanceof E.ProjectivePoint?(se.assertValidity(),se):Z.toRawBytes(se)}function le(te,_,se,ue){if(J(_),se.length!==_.length)throw new Error("amount of public keys and messages should be equal");const he=X(te),ne=_.map(h=>de(h,ue)),ce=se.map(Q),m=new Map;for(let h=0;h<ce.length;h++){const x=ce[h],v=ne[h];let U=m.get(v);U===void 0&&(U=[],m.set(v,U)),U.push(x)}const s=[];try{for(const[h,x]of m){const v=x.reduce((U,p)=>U.add(p));s.push({g1:v,g2:h})}return s.push({g1:E.ProjectivePoint.BASE.negate(),g2:he}),o.eql($(s),o.ONE)}catch{return!1}}return E.ProjectivePoint.BASE._setWindowSize(4),{getPublicKey:fe,getPublicKeyForShortSignatures:R,sign:P,signShortSignature:z,verify:M,verifyBatch:le,verifyShortSignature:G,aggregatePublicKeys:ee,aggregateSignatures:ge,aggregateShortSignatures:ae,millerLoopBatch:K,pairing:ie,pairingBatch:$,G1:E,G2:I,Signature:q,ShortSignature:Z,fields:{Fr:r,Fp:t,Fp2:n,Fp6:i,Fp12:o},params:{ateLoopSize:e.params.ateLoopSize,r:e.params.r,G1b:e.G1.b,G2b:e.G2.b},utils:C}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Wl=BigInt(0),Mr=BigInt(1),$t=BigInt(2),Ba=BigInt(3);function Qi(e,t,r,n,i=1,o){const d=BigInt(o===void 0?n:o),c=r**BigInt(n),w=[];for(let E=0;E<i;E++){const A=BigInt(E+1),I=[];for(let S=0,N=Mr;S<n;S++){const b=(A*N-A)/d%c;I.push(e.pow(t,b)),N*=r}w.push(I)}return w}function Yl(e,t,r){const n=t.pow(r,(e.ORDER-Mr)/Ba),i=t.pow(r,(e.ORDER-Mr)/$t);function o(S,N){const b=t.mul(t.frobeniusMap(S,1),n),j=t.mul(t.frobeniusMap(N,1),i);return[b,j]}const d=t.pow(r,(e.ORDER**$t-Mr)/Ba),c=t.pow(r,(e.ORDER**$t-Mr)/$t);if(!t.eql(c,t.neg(t.ONE)))throw new Error("psiFrobenius: PSI2_Y!==-1");function w(S,N){return[t.mul(S,d),t.neg(N)]}const E=S=>(N,b)=>{const j=b.toAffine(),V=S(j.x,j.y);return N.fromAffine({x:V[0],y:V[1]})},A=E(o),I=E(w);return{psi:o,psi2:w,G2psi:A,G2psi2:I,PSI_X:n,PSI_Y:i,PSI2_X:d,PSI2_Y:c}}function Zl(e){const{ORDER:t}=e,r=Tn(t),n=r.create(e.NONRESIDUE||BigInt(-1)),i=kl(t),o=r.div(r.ONE,$t),d=Qi(r,n,r.ORDER,2)[0],c=({c0:R,c1:P},{c0:z,c1:M})=>({c0:r.add(R,z),c1:r.add(P,M)}),w=({c0:R,c1:P},{c0:z,c1:M})=>({c0:r.sub(R,z),c1:r.sub(P,M)}),E=({c0:R,c1:P},z)=>{if(typeof z=="bigint")return{c0:r.mul(R,z),c1:r.mul(P,z)};const{c0:M,c1:G}=z;let J=r.mul(R,M),ee=r.mul(P,G);const ge=r.sub(J,ee),ae=r.sub(r.mul(r.add(R,P),r.add(M,G)),r.add(J,ee));return{c0:ge,c1:ae}},A=({c0:R,c1:P})=>{const z=r.add(R,P),M=r.sub(R,P),G=r.add(R,R);return{c0:r.mul(z,M),c1:r.mul(G,P)}},I=R=>{if(R.length!==2)throw new Error("invalid tuple");const P=R.map(z=>r.create(z));return{c0:P[0],c1:P[1]}},S=t*t,N=I(e.FP2_NONRESIDUE),b={ORDER:S,isLE:r.isLE,NONRESIDUE:N,BITS:cn(S),BYTES:Math.ceil(cn(S)/8),MASK:$n(cn(S)),ZERO:{c0:r.ZERO,c1:r.ZERO},ONE:{c0:r.ONE,c1:r.ZERO},create:R=>R,isValid:({c0:R,c1:P})=>typeof R=="bigint"&&typeof P=="bigint",is0:({c0:R,c1:P})=>r.is0(R)&&r.is0(P),eql:({c0:R,c1:P},{c0:z,c1:M})=>r.eql(R,z)&&r.eql(P,M),neg:({c0:R,c1:P})=>({c0:r.neg(R),c1:r.neg(P)}),pow:(R,P)=>qn(b,R,P),invertBatch:R=>jn(b,R),add:c,sub:w,mul:E,sqr:A,addN:c,subN:w,mulN:E,sqrN:A,div:(R,P)=>b.mul(R,typeof P=="bigint"?r.inv(r.create(P)):b.inv(P)),inv:({c0:R,c1:P})=>{const z=r.inv(r.create(R*R+P*P));return{c0:r.mul(z,r.create(R)),c1:r.mul(z,r.create(-P))}},sqrt:R=>{if(e.Fp2sqrt)return e.Fp2sqrt(R);const{c0:P,c1:z}=R;if(r.is0(z))return r.eql(i(r,P),r.ONE)?b.create({c0:r.sqrt(P),c1:r.ZERO}):b.create({c0:r.ZERO,c1:r.sqrt(r.div(P,n))});const M=r.sqrt(r.sub(r.sqr(P),r.mul(r.sqr(z),n)));let G=r.mul(r.add(M,P),o);const J=i(r,G);!r.is0(J)&&!r.eql(J,r.ONE)&&(G=r.sub(G,M));const ee=r.sqrt(G),ge=b.create({c0:ee,c1:r.div(r.mul(z,o),ee)});if(!b.eql(b.sqr(ge),R))throw new Error("Cannot find square root");const ae=ge,le=b.neg(ae),{re:te,im:_}=b.reim(ae),{re:se,im:ue}=b.reim(le);return _>ue||_===ue&&te>se?ae:le},isOdd:R=>{const{re:P,im:z}=b.reim(R),M=P%$t,G=P===Wl,J=z%$t;return BigInt(M||G&&J)==Mr},fromBytes(R){if(R.length!==b.BYTES)throw new Error("fromBytes invalid length="+R.length);return{c0:r.fromBytes(R.subarray(0,r.BYTES)),c1:r.fromBytes(R.subarray(r.BYTES))}},toBytes:({c0:R,c1:P})=>Le(r.toBytes(R),r.toBytes(P)),cmov:({c0:R,c1:P},{c0:z,c1:M},G)=>({c0:r.cmov(R,z,G),c1:r.cmov(P,M,G)}),reim:({c0:R,c1:P})=>({re:R,im:P}),mulByNonresidue:({c0:R,c1:P})=>b.mul({c0:R,c1:P},N),mulByB:e.Fp2mulByB,fromBigTuple:I,frobeniusMap:({c0:R,c1:P},z)=>({c0:R,c1:r.mul(P,d[z%2])})},j=({c0:R,c1:P,c2:z},{c0:M,c1:G,c2:J})=>({c0:b.add(R,M),c1:b.add(P,G),c2:b.add(z,J)}),V=({c0:R,c1:P,c2:z},{c0:M,c1:G,c2:J})=>({c0:b.sub(R,M),c1:b.sub(P,G),c2:b.sub(z,J)}),W=({c0:R,c1:P,c2:z},M)=>{if(typeof M=="bigint")return{c0:b.mul(R,M),c1:b.mul(P,M),c2:b.mul(z,M)};const{c0:G,c1:J,c2:ee}=M,ge=b.mul(R,G),ae=b.mul(P,J),le=b.mul(z,ee);return{c0:b.add(ge,b.mulByNonresidue(b.sub(b.mul(b.add(P,z),b.add(J,ee)),b.add(ae,le)))),c1:b.add(b.sub(b.mul(b.add(R,P),b.add(G,J)),b.add(ge,ae)),b.mulByNonresidue(le)),c2:b.sub(b.add(ae,b.mul(b.add(R,z),b.add(G,ee))),b.add(ge,le))}},K=({c0:R,c1:P,c2:z})=>{let M=b.sqr(R),G=b.mul(b.mul(R,P),$t),J=b.mul(b.mul(P,z),$t),ee=b.sqr(z);return{c0:b.add(b.mulByNonresidue(J),M),c1:b.add(b.mulByNonresidue(ee),G),c2:b.sub(b.sub(b.add(b.add(G,b.sqr(b.add(b.sub(R,P),z))),J),M),ee)}},[$,ie]=Qi(b,N,r.ORDER,6,2,3),C={ORDER:b.ORDER,isLE:b.isLE,BITS:3*b.BITS,BYTES:3*b.BYTES,MASK:$n(3*b.BITS),ZERO:{c0:b.ZERO,c1:b.ZERO,c2:b.ZERO},ONE:{c0:b.ONE,c1:b.ZERO,c2:b.ZERO},create:R=>R,isValid:({c0:R,c1:P,c2:z})=>b.isValid(R)&&b.isValid(P)&&b.isValid(z),is0:({c0:R,c1:P,c2:z})=>b.is0(R)&&b.is0(P)&&b.is0(z),neg:({c0:R,c1:P,c2:z})=>({c0:b.neg(R),c1:b.neg(P),c2:b.neg(z)}),eql:({c0:R,c1:P,c2:z},{c0:M,c1:G,c2:J})=>b.eql(R,M)&&b.eql(P,G)&&b.eql(z,J),sqrt:ya,div:(R,P)=>C.mul(R,typeof P=="bigint"?r.inv(r.create(P)):C.inv(P)),pow:(R,P)=>qn(C,R,P),invertBatch:R=>jn(C,R),add:j,sub:V,mul:W,sqr:K,addN:j,subN:V,mulN:W,sqrN:K,inv:({c0:R,c1:P,c2:z})=>{let M=b.sub(b.sqr(R),b.mulByNonresidue(b.mul(z,P))),G=b.sub(b.mulByNonresidue(b.sqr(z)),b.mul(R,P)),J=b.sub(b.sqr(P),b.mul(R,z)),ee=b.inv(b.add(b.mulByNonresidue(b.add(b.mul(z,G),b.mul(P,J))),b.mul(R,M)));return{c0:b.mul(ee,M),c1:b.mul(ee,G),c2:b.mul(ee,J)}},fromBytes:R=>{if(R.length!==C.BYTES)throw new Error("fromBytes invalid length="+R.length);return{c0:b.fromBytes(R.subarray(0,b.BYTES)),c1:b.fromBytes(R.subarray(b.BYTES,2*b.BYTES)),c2:b.fromBytes(R.subarray(2*b.BYTES))}},toBytes:({c0:R,c1:P,c2:z})=>Le(b.toBytes(R),b.toBytes(P),b.toBytes(z)),cmov:({c0:R,c1:P,c2:z},{c0:M,c1:G,c2:J},ee)=>({c0:b.cmov(R,M,ee),c1:b.cmov(P,G,ee),c2:b.cmov(z,J,ee)}),fromBigSix:R=>{if(!Array.isArray(R)||R.length!==6)throw new Error("invalid Fp6 usage");return{c0:b.fromBigTuple(R.slice(0,2)),c1:b.fromBigTuple(R.slice(2,4)),c2:b.fromBigTuple(R.slice(4,6))}},frobeniusMap:({c0:R,c1:P,c2:z},M)=>({c0:b.frobeniusMap(R,M),c1:b.mul(b.frobeniusMap(P,M),$[M%6]),c2:b.mul(b.frobeniusMap(z,M),ie[M%6])}),mulByFp2:({c0:R,c1:P,c2:z},M)=>({c0:b.mul(R,M),c1:b.mul(P,M),c2:b.mul(z,M)}),mulByNonresidue:({c0:R,c1:P,c2:z})=>({c0:b.mulByNonresidue(z),c1:R,c2:P}),mul1:({c0:R,c1:P,c2:z},M)=>({c0:b.mulByNonresidue(b.mul(z,M)),c1:b.mul(R,M),c2:b.mul(P,M)}),mul01({c0:R,c1:P,c2:z},M,G){let J=b.mul(R,M),ee=b.mul(P,G);return{c0:b.add(b.mulByNonresidue(b.sub(b.mul(b.add(P,z),G),ee)),J),c1:b.sub(b.sub(b.mul(b.add(M,G),b.add(R,P)),J),ee),c2:b.add(b.sub(b.mul(b.add(R,z),M),J),ee)}}},Z=Qi(b,N,r.ORDER,12,1,6)[0],q=({c0:R,c1:P},{c0:z,c1:M})=>({c0:C.add(R,z),c1:C.add(P,M)}),Q=({c0:R,c1:P},{c0:z,c1:M})=>({c0:C.sub(R,z),c1:C.sub(P,M)}),re=({c0:R,c1:P},z)=>{if(typeof z=="bigint")return{c0:C.mul(R,z),c1:C.mul(P,z)};let{c0:M,c1:G}=z,J=C.mul(R,M),ee=C.mul(P,G);return{c0:C.add(J,C.mulByNonresidue(ee)),c1:C.sub(C.mul(C.add(R,P),C.add(M,G)),C.add(J,ee))}},X=({c0:R,c1:P})=>{let z=C.mul(R,P);return{c0:C.sub(C.sub(C.mul(C.add(C.mulByNonresidue(P),R),C.add(R,P)),z),C.mulByNonresidue(z)),c1:C.add(z,z)}};function de(R,P){const z=b.sqr(R),M=b.sqr(P);return{first:b.add(b.mulByNonresidue(M),z),second:b.sub(b.sub(b.sqr(b.add(R,P)),z),M)}}const fe={ORDER:b.ORDER,isLE:C.isLE,BITS:2*b.BITS,BYTES:2*b.BYTES,MASK:$n(2*b.BITS),ZERO:{c0:C.ZERO,c1:C.ZERO},ONE:{c0:C.ONE,c1:C.ZERO},create:R=>R,isValid:({c0:R,c1:P})=>C.isValid(R)&&C.isValid(P),is0:({c0:R,c1:P})=>C.is0(R)&&C.is0(P),neg:({c0:R,c1:P})=>({c0:C.neg(R),c1:C.neg(P)}),eql:({c0:R,c1:P},{c0:z,c1:M})=>C.eql(R,z)&&C.eql(P,M),sqrt:ya,inv:({c0:R,c1:P})=>{let z=C.inv(C.sub(C.sqr(R),C.mulByNonresidue(C.sqr(P))));return{c0:C.mul(R,z),c1:C.neg(C.mul(P,z))}},div:(R,P)=>fe.mul(R,typeof P=="bigint"?r.inv(r.create(P)):fe.inv(P)),pow:(R,P)=>qn(fe,R,P),invertBatch:R=>jn(fe,R),add:q,sub:Q,mul:re,sqr:X,addN:q,subN:Q,mulN:re,sqrN:X,fromBytes:R=>{if(R.length!==fe.BYTES)throw new Error("fromBytes invalid length="+R.length);return{c0:C.fromBytes(R.subarray(0,C.BYTES)),c1:C.fromBytes(R.subarray(C.BYTES))}},toBytes:({c0:R,c1:P})=>Le(C.toBytes(R),C.toBytes(P)),cmov:({c0:R,c1:P},{c0:z,c1:M},G)=>({c0:C.cmov(R,z,G),c1:C.cmov(P,M,G)}),fromBigTwelve:R=>({c0:C.fromBigSix(R.slice(0,6)),c1:C.fromBigSix(R.slice(6,12))}),frobeniusMap(R,P){const{c0:z,c1:M,c2:G}=C.frobeniusMap(R.c1,P),J=Z[P%12];return{c0:C.frobeniusMap(R.c0,P),c1:C.create({c0:b.mul(z,J),c1:b.mul(M,J),c2:b.mul(G,J)})}},mulByFp2:({c0:R,c1:P},z)=>({c0:C.mulByFp2(R,z),c1:C.mulByFp2(P,z)}),conjugate:({c0:R,c1:P})=>({c0:R,c1:C.neg(P)}),mul014:({c0:R,c1:P},z,M,G)=>{let J=C.mul01(R,z,M),ee=C.mul1(P,G);return{c0:C.add(C.mulByNonresidue(ee),J),c1:C.sub(C.sub(C.mul01(C.add(P,R),z,b.add(M,G)),J),ee)}},mul034:({c0:R,c1:P},z,M,G)=>{const J=C.create({c0:b.mul(R.c0,z),c1:b.mul(R.c1,z),c2:b.mul(R.c2,z)}),ee=C.mul01(P,M,G),ge=C.mul01(C.add(R,P),b.add(z,M),G);return{c0:C.add(C.mulByNonresidue(ee),J),c1:C.sub(ge,C.add(J,ee))}},_cyclotomicSquare:e.Fp12cyclotomicSquare,_cyclotomicExp:e.Fp12cyclotomicExp,finalExponentiate:e.Fp12finalExponentiate};return{Fp:r,Fp2:b,Fp6:C,Fp4Square:de,Fp12:fe}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ot=BigInt(0),yi=BigInt(1),Ze=BigInt(2),On=BigInt(3),un=BigInt(4),Qt=BigInt("0xd201000000010000"),Xl=cn(Qt),{Fp:we,Fp2:be,Fp6:vs,Fp4Square:es,Fp12:Ne}=Zl({ORDER:BigInt("0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab"),FP2_NONRESIDUE:[yi,yi],Fp2mulByB:({c0:e,c1:t})=>{const r=we.mul(e,un),n=we.mul(t,un);return{c0:we.sub(r,n),c1:we.add(r,n)}},Fp12cyclotomicSquare:({c0:e,c1:t})=>{const{c0:r,c1:n,c2:i}=e,{c0:o,c1:d,c2:c}=t,{first:w,second:E}=es(r,d),{first:A,second:I}=es(o,i),{first:S,second:N}=es(n,c),b=be.mulByNonresidue(N);return{c0:vs.create({c0:be.add(be.mul(be.sub(w,r),Ze),w),c1:be.add(be.mul(be.sub(A,n),Ze),A),c2:be.add(be.mul(be.sub(S,i),Ze),S)}),c1:vs.create({c0:be.add(be.mul(be.add(b,o),Ze),b),c1:be.add(be.mul(be.add(E,d),Ze),E),c2:be.add(be.mul(be.add(I,c),Ze),I)})}},Fp12cyclotomicExp(e,t){let r=Ne.ONE;for(let n=Xl-1;n>=0;n--)r=Ne._cyclotomicSquare(r),Nl(t,n)&&(r=Ne.mul(r,e));return r},Fp12finalExponentiate:e=>{const t=Qt,r=Ne.div(Ne.frobeniusMap(e,6),e),n=Ne.mul(Ne.frobeniusMap(r,2),r),i=Ne.conjugate(Ne._cyclotomicExp(n,t)),o=Ne.mul(Ne.conjugate(Ne._cyclotomicSquare(n)),i),d=Ne.conjugate(Ne._cyclotomicExp(o,t)),c=Ne.conjugate(Ne._cyclotomicExp(d,t)),w=Ne.mul(Ne.conjugate(Ne._cyclotomicExp(c,t)),Ne._cyclotomicSquare(i)),E=Ne.conjugate(Ne._cyclotomicExp(w,t)),A=Ne.frobeniusMap(Ne.mul(i,c),2),I=Ne.frobeniusMap(Ne.mul(d,n),3),S=Ne.frobeniusMap(Ne.mul(w,Ne.conjugate(n)),1),N=Ne.mul(Ne.mul(E,Ne.conjugate(o)),n);return Ne.mul(Ne.mul(Ne.mul(A,I),S),N)}}),Aa=Tn(BigInt("0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001")),Jl=vc(be,[[["0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6"],["0x0","0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71a"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71e","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38d"],["0x171d6541fa38ccfaed6dea691f5fb614cb14b4e7f4e810aa22d6108f142b85757098e38d0f671c7188e2aaaaaaaa5ed1","0x0"]],[["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa63"],["0xc","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa9f"],["0x1","0x0"]],[["0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706","0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706"],["0x0","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97be"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71c","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38f"],["0x124c9ad43b6cf79bfbf7043de3811ad0761b0f37a1e26286b0e977c69aa274524e79097a56dc4bd9e1b371c71c718b10","0x0"]],[["0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb"],["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa9d3"],["0x12","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa99"],["0x1","0x0"]]].map(e=>e.map(t=>be.fromBigTuple(t.map(BigInt))))),Ql=vc(we,[["0x11a05f2b1e833340b809101dd99815856b303e88a2d7005ff2627b56cdb4e2c85610c2d5f2e62d6eaeac1662734649b7","0x17294ed3e943ab2f0588bab22147a81c7c17e75b2f6a8417f565e33c70d1e86b4838f2a6f318c356e834eef1b3cb83bb","0xd54005db97678ec1d1048c5d10a9a1bce032473295983e56878e501ec68e25c958c3e3d2a09729fe0179f9dac9edcb0","0x1778e7166fcc6db74e0609d307e55412d7f5e4656a8dbf25f1b33289f1b330835336e25ce3107193c5b388641d9b6861","0xe99726a3199f4436642b4b3e4118e5499db995a1257fb3f086eeb65982fac18985a286f301e77c451154ce9ac8895d9","0x1630c3250d7313ff01d1201bf7a74ab5db3cb17dd952799b9ed3ab9097e68f90a0870d2dcae73d19cd13c1c66f652983","0xd6ed6553fe44d296a3726c38ae652bfb11586264f0f8ce19008e218f9c86b2a8da25128c1052ecaddd7f225a139ed84","0x17b81e7701abdbe2e8743884d1117e53356de5ab275b4db1a682c62ef0f2753339b7c8f8c8f475af9ccb5618e3f0c88e","0x80d3cf1f9a78fc47b90b33563be990dc43b756ce79f5574a2c596c928c5d1de4fa295f296b74e956d71986a8497e317","0x169b1f8e1bcfa7c42e0c37515d138f22dd2ecb803a0c5c99676314baf4bb1b7fa3190b2edc0327797f241067be390c9e","0x10321da079ce07e272d8ec09d2565b0dfa7dccdde6787f96d50af36003b14866f69b771f8c285decca67df3f1605fb7b","0x6e08c248e260e70bd1e962381edee3d31d79d7e22c837bc23c0bf1bc24c6b68c24b1b80b64d391fa9c8ba2e8ba2d229"],["0x8ca8d548cff19ae18b2e62f4bd3fa6f01d5ef4ba35b48ba9c9588617fc8ac62b558d681be343df8993cf9fa40d21b1c","0x12561a5deb559c4348b4711298e536367041e8ca0cf0800c0126c2588c48bf5713daa8846cb026e9e5c8276ec82b3bff","0xb2962fe57a3225e8137e629bff2991f6f89416f5a718cd1fca64e00b11aceacd6a3d0967c94fedcfcc239ba5cb83e19","0x3425581a58ae2fec83aafef7c40eb545b08243f16b1655154cca8abc28d6fd04976d5243eecf5c4130de8938dc62cd8","0x13a8e162022914a80a6f1d5f43e7a07dffdfc759a12062bb8d6b44e833b306da9bd29ba81f35781d539d395b3532a21e","0xe7355f8e4e667b955390f7f0506c6e9395735e9ce9cad4d0a43bcef24b8982f7400d24bc4228f11c02df9a29f6304a5","0x772caacf16936190f3e0c63e0596721570f5799af53a1894e2e073062aede9cea73b3538f0de06cec2574496ee84a3a","0x14a7ac2a9d64a8b230b3f5b074cf01996e7f63c21bca68a81996e1cdf9822c580fa5b9489d11e2d311f7d99bbdcc5a5e","0xa10ecf6ada54f825e920b3dafc7a3cce07f8d1d7161366b74100da67f39883503826692abba43704776ec3a79a1d641","0x95fc13ab9e92ad4476d6e3eb3a56680f682b4ee96f7d03776df533978f31c1593174e4b4b7865002d6384d168ecdd0a","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"],["0x90d97c81ba24ee0259d1f094980dcfa11ad138e48a869522b52af6c956543d3cd0c7aee9b3ba3c2be9845719707bb33","0x134996a104ee5811d51036d776fb46831223e96c254f383d0f906343eb67ad34d6c56711962fa8bfe097e75a2e41c696","0xcc786baa966e66f4a384c86a3b49942552e2d658a31ce2c344be4b91400da7d26d521628b00523b8dfe240c72de1f6","0x1f86376e8981c217898751ad8746757d42aa7b90eeb791c09e4a3ec03251cf9de405aba9ec61deca6355c77b0e5f4cb","0x8cc03fdefe0ff135caf4fe2a21529c4195536fbe3ce50b879833fd221351adc2ee7f8dc099040a841b6daecf2e8fedb","0x16603fca40634b6a2211e11db8f0a6a074a7d0d4afadb7bd76505c3d3ad5544e203f6326c95a807299b23ab13633a5f0","0x4ab0b9bcfac1bbcb2c977d027796b3ce75bb8ca2be184cb5231413c4d634f3747a87ac2460f415ec961f8855fe9d6f2","0x987c8d5333ab86fde9926bd2ca6c674170a05bfe3bdd81ffd038da6c26c842642f64550fedfe935a15e4ca31870fb29","0x9fc4018bd96684be88c9e221e4da1bb8f3abd16679dc26c1e8b6e6a1f20cabe69d65201c78607a360370e577bdba587","0xe1bba7a1186bdb5223abde7ada14a23c42a0ca7915af6fe06985e7ed1e4d43b9b3f7055dd4eba6f2bafaaebca731c30","0x19713e47937cd1be0dfd0b8f1d43fb93cd2fcbcb6caf493fd1183e416389e61031bf3a5cce3fbafce813711ad011c132","0x18b46a908f36f6deb918c143fed2edcc523559b8aaf0c2462e6bfe7f911f643249d9cdf41b44d606ce07c8a4d0074d8e","0xb182cac101b9399d155096004f53f447aa7b12a3426b08ec02710e807b4633f06c851c1919211f20d4c04f00b971ef8","0x245a394ad1eca9b72fc00ae7be315dc757b3b080d4c158013e6632d3c40659cc6cf90ad1c232a6442d9d3f5db980133","0x5c129645e44cf1102a159f748c4a3fc5e673d81d7e86568d9ab0f5d396a7ce46ba1049b6579afb7866b1e715475224b","0x15e6be4e990f03ce4ea50b3b42df2eb5cb181d8f84965a3957add4fa95af01b2b665027efec01c7704b456be69c8b604"],["0x16112c4c3a9c98b252181140fad0eae9601a6de578980be6eec3232b5be72e7a07f3688ef60c206d01479253b03663c1","0x1962d75c2381201e1a0cbd6c43c348b885c84ff731c4d59ca4a10356f453e01f78a4260763529e3532f6102c2e49a03d","0x58df3306640da276faaae7d6e8eb15778c4855551ae7f310c35a5dd279cd2eca6757cd636f96f891e2538b53dbf67f2","0x16b7d288798e5395f20d23bf89edb4d1d115c5dbddbcd30e123da489e726af41727364f2c28297ada8d26d98445f5416","0xbe0e079545f43e4b00cc912f8228ddcc6d19c9f0f69bbb0542eda0fc9dec916a20b15dc0fd2ededda39142311a5001d","0x8d9e5297186db2d9fb266eaac783182b70152c65550d881c5ecd87b6f0f5a6449f38db9dfa9cce202c6477faaf9b7ac","0x166007c08a99db2fc3ba8734ace9824b5eecfdfa8d0cf8ef5dd365bc400a0051d5fa9c01a58b1fb93d1a1399126a775c","0x16a3ef08be3ea7ea03bcddfabba6ff6ee5a4375efa1f4fd7feb34fd206357132b920f5b00801dee460ee415a15812ed9","0x1866c8ed336c61231a1be54fd1d74cc4f9fb0ce4c6af5920abc5750c4bf39b4852cfe2f7bb9248836b233d9d55535d4a","0x167a55cda70a6e1cea820597d94a84903216f763e13d87bb5308592e7ea7d4fbc7385ea3d529b35e346ef48bb8913f55","0x4d2f259eea405bd48f010a01ad2911d9c6dd039bb61a6290e591b36e636a5c871a5c29f4f83060400f8b49cba8f6aa8","0xaccbb67481d033ff5852c1e48c50c477f94ff8aefce42d28c0f9a88cea7913516f968986f7ebbea9684b529e2561092","0xad6b9514c767fe3c3613144b45f1496543346d98adf02267d5ceef9a00d9b8693000763e3b90ac11e99b138573345cc","0x2660400eb2e4f3b628bdd0d53cd76f2bf565b94e72927c1cb748df27942480e420517bd8714cc80d1fadc1326ed06f7","0xe0fa1d816ddc03e6b24255e0d7819c171c40f65e273b853324efcd6356caa205ca2f570f13497804415473a1d634b8f","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"]].map(e=>e.map(t=>BigInt(t)))),ed=Oc(be,{A:be.create({c0:we.create(ot),c1:we.create(BigInt(240))}),B:be.create({c0:we.create(BigInt(1012)),c1:we.create(BigInt(1012))}),Z:be.create({c0:we.create(BigInt(-2)),c1:we.create(BigInt(-1))})}),td=Oc(we,{A:we.create(BigInt("0x144698a3b8e9433d693a02c96d4982b0ea985383ee66a8d8e8981aefd881ac98936f8da0e0f97f5cf428082d584c1d")),B:we.create(BigInt("0x12e2908d11688030018b12e8753eee3b2016c1f0f24f4070a0b9c14fcef35ef55a23215a316ceaa5d1cc48e98e172be0")),Z:we.create(BigInt(11))}),{G2psi:Na,G2psi2:rd}=Yl(we,be,be.div(be.ONE,be.NONRESIDUE)),ts=Object.freeze({DST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",encodeDST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",p:we.ORDER,m:2,k:128,expand:"xmd",hash:Ps}),gi=pn(we.toBytes(ot),{infinity:!0,compressed:!0});function Rn(e){e=e.slice();const t=e[0]&224,r=!!(t>>7&1),n=!!(t>>6&1),i=!!(t>>5&1);return e[0]&=31,{compressed:r,infinity:n,sort:i,value:e}}function pn(e,t){if(e[0]&224)throw new Error("setMask: non-empty mask");return t.compressed&&(e[0]|=128),t.infinity&&(e[0]|=64),t.sort&&(e[0]|=32),e}function Sa(e){e.assertValidity();const t=e.equals(pt.G1.ProjectivePoint.ZERO),{x:r,y:n}=e.toAffine();if(t)return gi.slice();const i=we.ORDER,o=!!(n*Ze/i);return pn(Qe(r,we.BYTES),{compressed:!0,sort:o})}function Ia(e){e.assertValidity();const t=we.BYTES;if(e.equals(pt.G2.ProjectivePoint.ZERO))return Le(gi,Qe(ot,t));const{x:r,y:n}=e.toAffine(),{re:i,im:o}=be.reim(r),{re:d,im:c}=be.reim(n),E=!!((c>ot?c*Ze:d*Ze)/we.ORDER&yi),A=i;return Le(pn(Qe(o,t),{sort:E,compressed:!0}),Qe(A,t))}const pt=zl({fields:{Fp:we,Fp2:be,Fp6:vs,Fp12:Ne,Fr:Aa},G1:{Fp:we,h:BigInt("0x396c8c005555e1568c00aaab0000aaab"),Gx:BigInt("0x17f1d3a73197d7942695638c4fa9ac0fc3688c4f9774b905a14e3a3f171bac586c55e83ff97a1aeffb3af00adb22c6bb"),Gy:BigInt("0x08b3f481e3aaa0f1a09e30ed741d8ae4fcf5e095d5d00af600db18cb2c04b3edd03cc744a2888ae40caa232946c5e7e1"),a:we.ZERO,b:un,htfDefaults:{...ts,m:1,DST:"BLS_SIG_BLS12381G1_XMD:SHA-256_SSWU_RO_NUL_"},wrapPrivateKey:!0,allowInfinityPoint:!0,isTorsionFree:(e,t)=>{const r=BigInt("0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffe"),n=new e(we.mul(t.px,r),t.py,t.pz);return t.multiplyUnsafe(Qt).negate().multiplyUnsafe(Qt).equals(n)},clearCofactor:(e,t)=>t.multiplyUnsafe(Qt).add(t),mapToCurve:e=>{const{x:t,y:r}=td(we.create(e[0]));return Ql(t,r)},fromBytes:e=>{const{compressed:t,infinity:r,sort:n,value:i}=Rn(e);if(i.length===48&&t){const o=we.ORDER,d=Tt(i),c=we.create(d&we.MASK);if(r){if(c!==ot)throw new Error("G1: non-empty compressed point at infinity");return{x:ot,y:ot}}const w=we.add(we.pow(c,On),we.create(pt.params.G1b));let E=we.sqrt(w);if(!E)throw new Error("invalid compressed G1 point");return E*Ze/o!==BigInt(n)&&(E=we.neg(E)),{x:we.create(c),y:we.create(E)}}else if(i.length===96&&!t){const o=Tt(i.subarray(0,we.BYTES)),d=Tt(i.subarray(we.BYTES));if(r){if(o!==ot||d!==ot)throw new Error("G1: non-empty point at infinity");return pt.G1.ProjectivePoint.ZERO.toAffine()}return{x:we.create(o),y:we.create(d)}}else throw new Error("invalid point G1, expected 48/96 bytes")},toBytes:(e,t,r)=>{const n=t.equals(e.ZERO),{x:i,y:o}=t.toAffine();if(r){if(n)return gi.slice();const d=we.ORDER,c=!!(o*Ze/d);return pn(Qe(i,we.BYTES),{compressed:!0,sort:c})}else return n?Le(new Uint8Array([64]),new Uint8Array(2*we.BYTES-1)):Le(Qe(i,we.BYTES),Qe(o,we.BYTES))},ShortSignature:{fromHex(e){const{infinity:t,sort:r,value:n}=Rn(ct("signatureHex",e,48)),i=we.ORDER,o=Tt(n);if(t)return pt.G1.ProjectivePoint.ZERO;const d=we.create(o&we.MASK),c=we.add(we.pow(d,On),we.create(pt.params.G1b));let w=we.sqrt(c);if(!w)throw new Error("invalid compressed G1 point");const E=BigInt(r);w*Ze/i!==E&&(w=we.neg(w));const A=pt.G1.ProjectivePoint.fromAffine({x:d,y:w});return A.assertValidity(),A},toRawBytes(e){return Sa(e)},toHex(e){return Er(Sa(e))}}},G2:{Fp:be,h:BigInt("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5"),Gx:be.fromBigTuple([BigInt("0x024aa2b2f08f0a91260805272dc51051c6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8"),BigInt("0x13e02b6052719f607dacd3a088274f65596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7e")]),Gy:be.fromBigTuple([BigInt("0x0ce5d527727d6e118cc9cdc6da2e351aadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801"),BigInt("0x0606c4a02ea734cc32acd2b02bc28b99cb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79be")]),a:be.ZERO,b:be.fromBigTuple([un,un]),hEff:BigInt("0xbc69f08f2ee75b3584c6a0ea91b352888e2a8e9145ad7689986ff031508ffe1329c2f178731db956d82bf015d1212b02ec0ec69d7477c1ae954cbc06689f6a359894c0adebbf6b4e8020005aaa95551"),htfDefaults:{...ts},wrapPrivateKey:!0,allowInfinityPoint:!0,mapToCurve:e=>{const{x:t,y:r}=ed(be.fromBigTuple(e));return Jl(t,r)},isTorsionFree:(e,t)=>t.multiplyUnsafe(Qt).negate().equals(Na(e,t)),clearCofactor:(e,t)=>{const r=Qt;let n=t.multiplyUnsafe(r).negate(),i=Na(e,t),o=t.double();return o=rd(e,o),o=o.subtract(i),i=n.add(i),i=i.multiplyUnsafe(r).negate(),o=o.add(i),o=o.subtract(n),o.subtract(t)},fromBytes:e=>{const{compressed:t,infinity:r,sort:n,value:i}=Rn(e);if(!t&&!r&&n||!t&&r&&n||n&&r&&t)throw new Error("invalid encoding flag: "+(e[0]&224));const o=we.BYTES,d=(c,w,E)=>Tt(c.slice(w,E));if(i.length===96&&t){const c=pt.params.G2b,w=we.ORDER;if(r){if(i.reduce((j,V)=>j!==0?V+1:V,0)>0)throw new Error("invalid compressed G2 point");return{x:be.ZERO,y:be.ZERO}}const E=d(i,0,o),A=d(i,o,2*o),I=be.create({c0:we.create(A),c1:we.create(E)}),S=be.add(be.pow(I,On),c);let N=be.sqrt(S);const b=N.c1===ot?N.c0*Ze/w:N.c1*Ze/w?yi:ot;return N=n&&b>0?N:be.neg(N),{x:I,y:N}}else if(i.length===192&&!t){if(r){if(i.reduce((I,S)=>I!==0?S+1:S,0)>0)throw new Error("invalid uncompressed G2 point");return{x:be.ZERO,y:be.ZERO}}const c=d(i,0,o),w=d(i,o,2*o),E=d(i,2*o,3*o),A=d(i,3*o,4*o);return{x:be.fromBigTuple([w,c]),y:be.fromBigTuple([A,E])}}else throw new Error("invalid point G2, expected 96/192 bytes")},toBytes:(e,t,r)=>{const{BYTES:n,ORDER:i}=we,o=t.equals(e.ZERO),{x:d,y:c}=t.toAffine();if(r){if(o)return Le(gi,Qe(ot,n));const w=!!(c.c1===ot?c.c0*Ze/i:c.c1*Ze/i);return Le(pn(Qe(d.c1,n),{compressed:!0,sort:w}),Qe(d.c0,n))}else{if(o)return Le(new Uint8Array([64]),new Uint8Array(4*n-1));const{re:w,im:E}=be.reim(d),{re:A,im:I}=be.reim(c);return Le(Qe(E,n),Qe(w,n),Qe(I,n),Qe(A,n))}},Signature:{fromHex(e){const{infinity:t,sort:r,value:n}=Rn(ct("signatureHex",e)),i=we.ORDER,o=n.length/2;if(o!==48&&o!==96)throw new Error("invalid compressed signature length, must be 96 or 192");const d=Tt(n.slice(0,o)),c=Tt(n.slice(o));if(t)return pt.G2.ProjectivePoint.ZERO;const w=we.create(d&we.MASK),E=we.create(c),A=be.create({c0:E,c1:w}),I=be.add(be.pow(A,On),pt.params.G2b);let S=be.sqrt(I);if(!S)throw new Error("Failed to find a square root");const{re:N,im:b}=be.reim(S),j=BigInt(r),V=b>ot&&b*Ze/i!==j,W=b===ot&&N*Ze/i!==j;(V||W)&&(S=be.neg(S));const K=pt.G2.ProjectivePoint.fromAffine({x:A,y:S});return K.assertValidity(),K},toRawBytes(e){return Ia(e)},toHex(e){return Er(Ia(e))}}},params:{ateLoopSize:Qt,r:Aa.ORDER,xNegative:!0,twistType:"multiplicative"},htfDefaults:ts,hash:Ps,randomBytes:no});function nd(e,t,r){const n=typeof e=="string"?e:et(e),i=typeof t=="string"?t:et(t),o=typeof r=="string"?r:et(r);return pt.verifyShortSignature(i,o,n)}const Rc=e=>Ye(new Dr(e)),Ws=e=>{const t=Rc(e);return new Date(Number(t)/1e6)};class Ft extends De{constructor(t){super(`Invalid certificate: ${t}`)}}var dt;(function(e){e[e.Empty=0]="Empty",e[e.Fork=1]="Fork",e[e.Labeled=2]="Labeled",e[e.Leaf=3]="Leaf",e[e.Pruned=4]="Pruned"})(dt||(dt={}));function id(e,t){const r=new Uint8Array(e),n=new Uint8Array(t);for(let i=0;i<r.length;i++)if(r[i]>n[i])return!0;return!1}class wr{constructor(t,r,n,i,o=5){this._rootKey=r,this._canisterId=n,this._blsVerify=i,this._maxAgeInMinutes=o,this.cert=jt(new Uint8Array(t))}static async create(t){const r=wr.createUnverified(t);return await r.verify(),r}static createUnverified(t){let r=t.blsVerify;return r||(r=nd),new wr(t.certificate,t.rootKey,t.canisterId,r,t.maxAgeInMinutes)}lookup(t){return Lr(t,this.cert.tree)}lookup_label(t){return this.lookup([t])}async verify(){const t=await Gn(this.cert.tree),r=await this._checkDelegationAndGetKey(this.cert.delegation),n=this.cert.signature,i=ad(r),o=Bt(Jr("ic-state-root"),t);let d=!1;const c=gt(this.lookup(["time"]));if(!c)throw new Ft("Certificate does not contain a time");const w=5*60*1e3,E=this._maxAgeInMinutes*60*1e3,A=Date.now(),I=A-E,S=A+w,N=Ws(c);if(N.getTime()<I)throw new Ft(`Certificate is signed more than ${this._maxAgeInMinutes} minutes in the past. Certificate time: `+N.toISOString()+" Current time: "+new Date(A).toISOString());if(N.getTime()>S)throw new Ft("Certificate is signed more than 5 minutes in the future. Certificate time: "+N.toISOString()+" Current time: "+new Date(A).toISOString());try{d=await this._blsVerify(new Uint8Array(i),new Uint8Array(n),new Uint8Array(o))}catch{d=!1}if(!d)throw new Ft("Signature verification failed")}async _checkDelegationAndGetKey(t){if(!t)return this._rootKey;const r=await wr.createUnverified({certificate:t.certificate,rootKey:this._rootKey,canisterId:this._canisterId,blsVerify:this._blsVerify,maxAgeInMinutes:1/0});if(r.cert.delegation)throw new Ft("Delegation certificates cannot be nested");if(await r.verify(),this._canisterId.toString()!==Qd&&!Uc({canisterId:this._canisterId,subnetId:ve.fromUint8Array(new Uint8Array(t.subnet_id)),tree:r.cert.tree}))throw new Ft(`Canister ${this._canisterId} not in range of delegations for subnet 0x${et(t.subnet_id)}`);const n=gt(r.lookup(["subnet",t.subnet_id,"public_key"]));if(!n)throw new Error(`Could not find subnet key for subnet 0x${et(t.subnet_id)}`);return n}}const Wr=Lt("308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100"),sd=96;function ad(e){const t=Wr.byteLength+sd;if(e.byteLength!==t)throw new TypeError(`BLS DER-encoded public key must be ${t} bytes long`);const r=e.slice(0,Wr.byteLength);if(!vi(r,Wr))throw new TypeError(`BLS DER-encoded public key is invalid. Expect the following prefix: ${Wr}, but get ${r}`);return e.slice(Wr.byteLength)}function gt(e){if(e.status===He.Found){if(e.value instanceof ArrayBuffer)return e.value;if(e.value instanceof Uint8Array)return e.value.buffer}}async function Gn(e){switch(e[0]){case dt.Empty:return vt(Jr("ic-hashtree-empty"));case dt.Pruned:return e[1];case dt.Leaf:return vt(Bt(Jr("ic-hashtree-leaf"),e[1]));case dt.Labeled:return vt(Bt(Jr("ic-hashtree-labeled"),e[1],await Gn(e[2])));case dt.Fork:return vt(Bt(Jr("ic-hashtree-fork"),await Gn(e[1]),await Gn(e[2])));default:throw new Error("unreachable")}}function Jr(e){const t=new Uint8Array([e.length]),r=new TextEncoder().encode(e);return Bt(t,r)}var He;(function(e){e.Unknown="unknown",e.Absent="absent",e.Found="found"})(He||(He={}));var qt;(function(e){e.Less="less",e.Greater="greater"})(qt||(qt={}));function Lr(e,t){if(e.length===0)switch(t[0]){case dt.Leaf:{if(!t[1])throw new Error("Invalid tree structure for leaf");return t[1]instanceof ArrayBuffer?{status:He.Found,value:t[1]}:t[1]instanceof Uint8Array?{status:He.Found,value:t[1].buffer}:{status:He.Found,value:t[1]}}default:return{status:He.Found,value:t}}const r=typeof e[0]=="string"?new TextEncoder().encode(e[0]):e[0],n=Ln(r,t);switch(n.status){case He.Found:return Lr(e.slice(1),n.value);case qt.Greater:case qt.Less:return{status:He.Absent};default:return n}}function Bs(e){switch(e[0]){case dt.Empty:return[];case dt.Fork:return Bs(e[1]).concat(Bs(e[2]));default:return[e]}}function Ln(e,t){switch(t[0]){case dt.Labeled:return id(e,t[1])?{status:qt.Greater}:vi(e,t[1])?{status:He.Found,value:t[2]}:{status:qt.Less};case dt.Fork:const r=Ln(e,t[1]);switch(r.status){case qt.Greater:{const n=Ln(e,t[2]);return n.status===qt.Less?{status:He.Absent}:n}case He.Unknown:{let n=Ln(e,t[2]);return n.status===qt.Less?{status:He.Unknown}:n}default:return r}case dt.Pruned:return{status:He.Unknown};default:return{status:He.Absent}}}function Uc(e){const{canisterId:t,subnetId:r,tree:n}=e,i=Lr(["subnet",r.toUint8Array(),"canister_ranges"],n);if(i.status!==He.Found||!(i.value instanceof ArrayBuffer))throw new Error(`Could not find canister ranges for subnet ${r}`);return jt(i.value).map(w=>[ve.fromUint8Array(w[0]),ve.fromUint8Array(w[1])]).some(w=>w[0].ltEq(t)&&w[1].gtEq(t))}class od{constructor(t,r,n){this.key=t,this.path=r,this.decodeStrategy=n}}const Fc=async e=>{const{agent:t,paths:r}=e,n=ve.from(e.canisterId),i=[...new Set(r)],o=i.map(w=>As(w,n)),d=new Map,c=i.map((w,E)=>(async()=>{var A;try{const I=await t.readState(n,{paths:[o[E]]}),S=await wr.create({certificate:I.certificate,rootKey:t.rootKey,canisterId:n}),N=(V,W)=>{if(W==="subnet"){const K=Pc(I.certificate,n,t.rootKey);return{path:W,data:K}}else return{path:W,data:gt(V.lookup(As(W,n)))}},{path:b,data:j}=N(S,i[E]);if(!j)console.warn(`Expected to find result for path ${b}, but instead found nothing.`),typeof b=="string"?d.set(b,null):d.set(b.key,null);else switch(b){case"time":{d.set(b,Ws(j));break}case"controllers":{d.set(b,ud(j));break}case"module_hash":{d.set(b,Oa(j));break}case"subnet":{d.set(b,j);break}case"candid":{d.set(b,new TextDecoder().decode(j));break}default:if(typeof b!="string"&&"key"in b&&"path"in b)switch(b.decodeStrategy){case"raw":d.set(b.key,j);break;case"leb128":{d.set(b.key,Rc(j));break}case"cbor":{d.set(b.key,kc(j));break}case"hex":{d.set(b.key,Oa(j));break}case"utf-8":d.set(b.key,cd(j))}}}catch(I){if(!((A=I?.message)===null||A===void 0)&&A.includes("Invalid certificate"))throw new De(I.message);typeof w!="string"&&"key"in w&&"path"in w?d.set(w.key,null):d.set(w,null),console.group(),console.warn(`Expected to find result for path ${w}, but instead found nothing.`),console.warn(I),console.groupEnd()}})());return await Promise.all(c),d},Pc=(e,t,r)=>{if(!t._isPrincipal)throw new Error("Invalid canisterId");const n=jt(new Uint8Array(e)),i=n.tree;let o=n.delegation,d;if(o&&o.subnet_id?d=ve.fromUint8Array(new Uint8Array(o.subnet_id)):!o&&typeof r<"u"?(d=ve.selfAuthenticating(new Uint8Array(r)),o={subnet_id:d.toUint8Array(),certificate:new ArrayBuffer(0)}):(d=ve.selfAuthenticating(ve.fromText("tdb26-jop6k-aogll-7ltgs-eruif-6kk7m-qpktf-gdiqx-mxtrf-vb5e6-eqe").toUint8Array()),o={subnet_id:d.toUint8Array(),certificate:new ArrayBuffer(0)}),!Uc({canisterId:t,subnetId:d,tree:i}))throw new Error("Canister not in range");const w=Lr(["subnet",o.subnet_id,"node"],i);if(w.status!==He.Found)throw new Error("Node not found");if(w.value instanceof ArrayBuffer)throw new Error("Invalid node tree");const E=Bs(w.value),A=new Map;return E.forEach(I=>{const S=ve.from(new Uint8Array(I[1])).toText(),N=Lr(["public_key"],I[2]);if(N.status!==He.Found)throw new Error("Public key not found");const b=N.value;if(b.byteLength!==44)throw new Error("Invalid public key length");A.set(S,b)}),{subnetId:ve.fromUint8Array(new Uint8Array(o.subnet_id)).toText(),nodeKeys:A}},As=(e,t)=>{const r=new TextEncoder,n=o=>new DataView(r.encode(o).buffer).buffer,i=new DataView(t.toUint8Array().buffer).buffer;switch(e){case"time":return[n("time")];case"controllers":return[n("canister"),i,n("controllers")];case"module_hash":return[n("canister"),i,n("module_hash")];case"subnet":return[n("subnet")];case"candid":return[n("canister"),i,n("metadata"),n("candid:service")];default:if("key"in e&&"path"in e)if(typeof e.path=="string"||e.path instanceof ArrayBuffer){const o=e.path,d=typeof o=="string"?n(o):o;return[n("canister"),i,n("metadata"),d]}else return e.path}throw new Error(`An unexpeected error was encountered while encoding your path for canister status. Please ensure that your path, ${e} was formatted correctly.`)},Oa=e=>et(e),kc=e=>jt(e),cd=e=>new TextDecoder().decode(e),ud=e=>kc(e).map(r=>ve.fromUint8Array(new Uint8Array(r))),fd=Object.freeze(Object.defineProperty({__proto__:null,CustomPath:od,encodePath:As,fetchNodeKeys:Pc,request:Fc},Symbol.toStringTag,{value:"Module"})),Un=BigInt(2**32-1),Ns=BigInt(32);function Cc(e,t=!1){return t?{h:Number(e&Un),l:Number(e>>Ns&Un)}:{h:Number(e>>Ns&Un)|0,l:Number(e&Un)|0}}function ld(e,t=!1){let r=new Uint32Array(e.length),n=new Uint32Array(e.length);for(let i=0;i<e.length;i++){const{h:o,l:d}=Cc(e[i],t);[r[i],n[i]]=[o,d]}return[r,n]}const dd=(e,t)=>BigInt(e>>>0)<<Ns|BigInt(t>>>0),hd=(e,t,r)=>e>>>r,pd=(e,t,r)=>e<<32-r|t>>>r,yd=(e,t,r)=>e>>>r|t<<32-r,gd=(e,t,r)=>e<<32-r|t>>>r,wd=(e,t,r)=>e<<64-r|t>>>r-32,md=(e,t,r)=>e>>>r-32|t<<64-r,bd=(e,t)=>t,_d=(e,t)=>e,Ed=(e,t,r)=>e<<r|t>>>32-r,xd=(e,t,r)=>t<<r|e>>>32-r,Td=(e,t,r)=>t<<r-32|e>>>64-r,vd=(e,t,r)=>e<<r-32|t>>>64-r;function Bd(e,t,r,n){const i=(t>>>0)+(n>>>0);return{h:e+r+(i/2**32|0)|0,l:i|0}}const Ad=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),Nd=(e,t,r,n)=>t+r+n+(e/2**32|0)|0,Sd=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0),Id=(e,t,r,n,i)=>t+r+n+i+(e/2**32|0)|0,Od=(e,t,r,n,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(i>>>0),Rd=(e,t,r,n,i,o)=>t+r+n+i+o+(e/2**32|0)|0,Be={fromBig:Cc,split:ld,toBig:dd,shrSH:hd,shrSL:pd,rotrSH:yd,rotrSL:gd,rotrBH:wd,rotrBL:md,rotr32H:bd,rotr32L:_d,rotlSH:Ed,rotlSL:xd,rotlBH:Td,rotlBL:vd,add:Bd,add3L:Ad,add3H:Nd,add4L:Sd,add4H:Id,add5H:Rd,add5L:Od},[Ud,Fd]=Be.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),Wt=new Uint32Array(80),Yt=new Uint32Array(80);class Pd extends io{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:r,Bh:n,Bl:i,Ch:o,Cl:d,Dh:c,Dl:w,Eh:E,El:A,Fh:I,Fl:S,Gh:N,Gl:b,Hh:j,Hl:V}=this;return[t,r,n,i,o,d,c,w,E,A,I,S,N,b,j,V]}set(t,r,n,i,o,d,c,w,E,A,I,S,N,b,j,V){this.Ah=t|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=o|0,this.Cl=d|0,this.Dh=c|0,this.Dl=w|0,this.Eh=E|0,this.El=A|0,this.Fh=I|0,this.Fl=S|0,this.Gh=N|0,this.Gl=b|0,this.Hh=j|0,this.Hl=V|0}process(t,r){for(let $=0;$<16;$++,r+=4)Wt[$]=t.getUint32(r),Yt[$]=t.getUint32(r+=4);for(let $=16;$<80;$++){const ie=Wt[$-15]|0,C=Yt[$-15]|0,Z=Be.rotrSH(ie,C,1)^Be.rotrSH(ie,C,8)^Be.shrSH(ie,C,7),q=Be.rotrSL(ie,C,1)^Be.rotrSL(ie,C,8)^Be.shrSL(ie,C,7),Q=Wt[$-2]|0,re=Yt[$-2]|0,X=Be.rotrSH(Q,re,19)^Be.rotrBH(Q,re,61)^Be.shrSH(Q,re,6),de=Be.rotrSL(Q,re,19)^Be.rotrBL(Q,re,61)^Be.shrSL(Q,re,6),fe=Be.add4L(q,de,Yt[$-7],Yt[$-16]),R=Be.add4H(fe,Z,X,Wt[$-7],Wt[$-16]);Wt[$]=R|0,Yt[$]=fe|0}let{Ah:n,Al:i,Bh:o,Bl:d,Ch:c,Cl:w,Dh:E,Dl:A,Eh:I,El:S,Fh:N,Fl:b,Gh:j,Gl:V,Hh:W,Hl:K}=this;for(let $=0;$<80;$++){const ie=Be.rotrSH(I,S,14)^Be.rotrSH(I,S,18)^Be.rotrBH(I,S,41),C=Be.rotrSL(I,S,14)^Be.rotrSL(I,S,18)^Be.rotrBL(I,S,41),Z=I&N^~I&j,q=S&b^~S&V,Q=Be.add5L(K,C,q,Fd[$],Yt[$]),re=Be.add5H(Q,W,ie,Z,Ud[$],Wt[$]),X=Q|0,de=Be.rotrSH(n,i,28)^Be.rotrBH(n,i,34)^Be.rotrBH(n,i,39),fe=Be.rotrSL(n,i,28)^Be.rotrBL(n,i,34)^Be.rotrBL(n,i,39),R=n&o^n&c^o&c,P=i&d^i&w^d&w;W=j|0,K=V|0,j=N|0,V=b|0,N=I|0,b=S|0,{h:I,l:S}=Be.add(E|0,A|0,re|0,X|0),E=c|0,A=w|0,c=o|0,w=d|0,o=n|0,d=i|0;const z=Be.add3L(X,fe,P);n=Be.add3H(z,re,de,R),i=z|0}({h:n,l:i}=Be.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:o,l:d}=Be.add(this.Bh|0,this.Bl|0,o|0,d|0),{h:c,l:w}=Be.add(this.Ch|0,this.Cl|0,c|0,w|0),{h:E,l:A}=Be.add(this.Dh|0,this.Dl|0,E|0,A|0),{h:I,l:S}=Be.add(this.Eh|0,this.El|0,I|0,S|0),{h:N,l:b}=Be.add(this.Fh|0,this.Fl|0,N|0,b|0),{h:j,l:V}=Be.add(this.Gh|0,this.Gl|0,j|0,V|0),{h:W,l:K}=Be.add(this.Hh|0,this.Hl|0,W|0,K|0),this.set(n,i,o,d,c,w,E,A,I,S,N,b,j,V,W,K)}roundClean(){Wt.fill(0),Yt.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const kd=Fs(()=>new Pd);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const bt=BigInt(0),ft=BigInt(1),Fn=BigInt(2),Cd=BigInt(8),Md={zip215:!0};function Vd(e){const t=Ic(e);return xn(e,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}function $d(e){const t=Vd(e),{Fp:r,n,prehash:i,hash:o,randomBytes:d,nByteLength:c,h:w}=t,E=Fn<<BigInt(c*8)-ft,A=r.create,I=Tn(t.n,t.nBitLength),S=t.uvRatio||((M,G)=>{try{return{isValid:!0,value:r.sqrt(M*r.inv(G))}}catch{return{isValid:!1,value:bt}}}),N=t.adjustScalarBytes||(M=>M),b=t.domain||((M,G,J)=>{if(an("phflag",J),G.length||J)throw new Error("Contexts/pre-hash are not supported");return M});function j(M,G){nr("coordinate "+M,G,bt,E)}function V(M){if(!(M instanceof $))throw new Error("ExtendedPoint expected")}const W=dn((M,G)=>{const{ex:J,ey:ee,ez:ge}=M,ae=M.is0();G==null&&(G=ae?Cd:r.inv(ge));const le=A(J*G),te=A(ee*G),_=A(ge*G);if(ae)return{x:bt,y:ft};if(_!==ft)throw new Error("invZ was invalid");return{x:le,y:te}}),K=dn(M=>{const{a:G,d:J}=t;if(M.is0())throw new Error("bad point: ZERO");const{ex:ee,ey:ge,ez:ae,et:le}=M,te=A(ee*ee),_=A(ge*ge),se=A(ae*ae),ue=A(se*se),he=A(te*G),ne=A(se*A(he+_)),ce=A(ue+A(J*A(te*_)));if(ne!==ce)throw new Error("bad point: equation left != right (1)");const m=A(ee*ge),s=A(ae*le);if(m!==s)throw new Error("bad point: equation left != right (2)");return!0});class ${constructor(G,J,ee,ge){this.ex=G,this.ey=J,this.ez=ee,this.et=ge,j("x",G),j("y",J),j("z",ee),j("t",ge),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(G){if(G instanceof $)throw new Error("extended point not allowed");const{x:J,y:ee}=G||{};return j("x",J),j("y",ee),new $(J,ee,ft,A(J*ee))}static normalizeZ(G){const J=r.invertBatch(G.map(ee=>ee.ez));return G.map((ee,ge)=>ee.toAffine(J[ge])).map($.fromAffine)}static msm(G,J){return Sc($,I,G,J)}_setWindowSize(G){Z.setWindowSize(this,G)}assertValidity(){K(this)}equals(G){V(G);const{ex:J,ey:ee,ez:ge}=this,{ex:ae,ey:le,ez:te}=G,_=A(J*te),se=A(ae*ge),ue=A(ee*te),he=A(le*ge);return _===se&&ue===he}is0(){return this.equals($.ZERO)}negate(){return new $(A(-this.ex),this.ey,this.ez,A(-this.et))}double(){const{a:G}=t,{ex:J,ey:ee,ez:ge}=this,ae=A(J*J),le=A(ee*ee),te=A(Fn*A(ge*ge)),_=A(G*ae),se=J+ee,ue=A(A(se*se)-ae-le),he=_+le,ne=he-te,ce=_-le,m=A(ue*ne),s=A(he*ce),h=A(ue*ce),x=A(ne*he);return new $(m,s,x,h)}add(G){V(G);const{a:J,d:ee}=t,{ex:ge,ey:ae,ez:le,et:te}=this,{ex:_,ey:se,ez:ue,et:he}=G;if(J===BigInt(-1)){const T=A((ae-ge)*(se+_)),O=A((ae+ge)*(se-_)),L=A(O-T);if(L===bt)return this.double();const Y=A(le*Fn*he),oe=A(te*Fn*ue),pe=oe+Y,me=O+T,y=oe-Y,f=A(pe*L),l=A(me*y),B=A(pe*y),k=A(L*me);return new $(f,l,k,B)}const ne=A(ge*_),ce=A(ae*se),m=A(te*ee*he),s=A(le*ue),h=A((ge+ae)*(_+se)-ne-ce),x=s-m,v=s+m,U=A(ce-J*ne),p=A(h*x),a=A(v*U),u=A(h*U),g=A(x*v);return new $(p,a,g,u)}subtract(G){return this.add(G.negate())}wNAF(G){return Z.wNAFCached(this,G,$.normalizeZ)}multiply(G){const J=G;nr("scalar",J,ft,n);const{p:ee,f:ge}=this.wNAF(J);return $.normalizeZ([ee,ge])[0]}multiplyUnsafe(G,J=$.ZERO){const ee=G;return nr("scalar",ee,bt,n),ee===bt?C:this.is0()||ee===ft?this:Z.wNAFCachedUnsafe(this,ee,$.normalizeZ,J)}isSmallOrder(){return this.multiplyUnsafe(w).is0()}isTorsionFree(){return Z.unsafeLadder(this,n).is0()}toAffine(G){return W(this,G)}clearCofactor(){const{h:G}=t;return G===ft?this:this.multiplyUnsafe(G)}static fromHex(G,J=!1){const{d:ee,a:ge}=t,ae=r.BYTES;G=ct("pointHex",G,ae),an("zip215",J);const le=G.slice(),te=G[ae-1];le[ae-1]=te&-129;const _=on(le),se=J?E:r.ORDER;nr("pointHex.y",_,bt,se);const ue=A(_*_),he=A(ue-ft),ne=A(ee*ue-ge);let{isValid:ce,value:m}=S(he,ne);if(!ce)throw new Error("Point.fromHex: invalid y coordinate");const s=(m&ft)===ft,h=(te&128)!==0;if(!J&&m===bt&&h)throw new Error("Point.fromHex: x=0 and x_0=1");return h!==s&&(m=A(-m)),$.fromAffine({x:m,y:_})}static fromPrivateKey(G){return re(G).point}toRawBytes(){const{x:G,y:J}=this.toAffine(),ee=hi(J,r.BYTES);return ee[ee.length-1]|=G&ft?128:0,ee}toHex(){return Er(this.toRawBytes())}}$.BASE=new $(t.Gx,t.Gy,ft,A(t.Gx*t.Gy)),$.ZERO=new $(bt,ft,ft,bt);const{BASE:ie,ZERO:C}=$,Z=Nc($,c*8);function q(M){return Ve(M,n)}function Q(M){return q(on(M))}function re(M){const G=r.BYTES;M=ct("private key",M,G);const J=ct("hashed private key",o(M),2*G),ee=N(J.slice(0,G)),ge=J.slice(G,2*G),ae=Q(ee),le=ie.multiply(ae),te=le.toRawBytes();return{head:ee,prefix:ge,scalar:ae,point:le,pointBytes:te}}function X(M){return re(M).pointBytes}function de(M=new Uint8Array,...G){const J=Le(...G);return Q(o(b(J,ct("context",M),!!i)))}function fe(M,G,J={}){M=ct("message",M),i&&(M=i(M));const{prefix:ee,scalar:ge,pointBytes:ae}=re(G),le=de(J.context,ee,M),te=ie.multiply(le).toRawBytes(),_=de(J.context,te,ae,M),se=q(le+_*ge);nr("signature.s",se,bt,n);const ue=Le(te,hi(se,r.BYTES));return ct("result",ue,r.BYTES*2)}const R=Md;function P(M,G,J,ee=R){const{context:ge,zip215:ae}=ee,le=r.BYTES;M=ct("signature",M,2*le),G=ct("message",G),J=ct("publicKey",J,le),ae!==void 0&&an("zip215",ae),i&&(G=i(G));const te=on(M.slice(le,2*le));let _,se,ue;try{_=$.fromHex(J,ae),se=$.fromHex(M.slice(0,le),ae),ue=ie.multiplyUnsafe(te)}catch{return!1}if(!ae&&_.isSmallOrder())return!1;const he=de(ge,se.toRawBytes(),_.toRawBytes(),G);return se.add(_.multiplyUnsafe(he)).subtract(ue).clearCofactor().equals($.ZERO)}return ie._setWindowSize(8),{CURVE:t,getPublicKey:X,sign:fe,verify:P,ExtendedPoint:$,utils:{getExtendedPublicKey:re,randomPrivateKey:()=>d(r.BYTES),precompute(M=8,G=$.BASE){return G._setWindowSize(M),G.multiply(BigInt(3)),G}}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ys=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Ra=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const qd=BigInt(1),Ua=BigInt(2);BigInt(3);const jd=BigInt(5),Gd=BigInt(8);function Ld(e){const t=BigInt(10),r=BigInt(20),n=BigInt(40),i=BigInt(80),o=Ys,c=e*e%o*e%o,w=St(c,Ua,o)*c%o,E=St(w,qd,o)*e%o,A=St(E,jd,o)*E%o,I=St(A,t,o)*A%o,S=St(I,r,o)*I%o,N=St(S,n,o)*S%o,b=St(N,i,o)*N%o,j=St(b,i,o)*N%o,V=St(j,t,o)*A%o;return{pow_p_5_8:St(V,Ua,o)*e%o,b2:c}}function Hd(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function Dd(e,t){const r=Ys,n=Ve(t*t*t,r),i=Ve(n*n*t,r),o=Ld(e*i).pow_p_5_8;let d=Ve(e*n*o,r);const c=Ve(t*d*d,r),w=d,E=Ve(d*Ra,r),A=c===e,I=c===Ve(-e,r),S=c===Ve(-e*Ra,r);return A&&(d=w),(I||S)&&(d=E),Fl(d,r)&&(d=Ve(-d,r)),{isValid:A||I,value:d}}const Kd=Tn(Ys,void 0,!0),zd={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Kd,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:Gd,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:kd,randomBytes:no,adjustScalarBytes:Hd,uvRatio:Dd},Or=$d(zd);var Fa=function(e,t,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,r):i?i.value=r:t.set(e,r),r},st=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},rt,Qr,Mc,Vc;class Wd{constructor(t={}){rt.set(this,void 0),Qr.set(this,void 0),this[Mc]=this.entries.bind(this),this[Vc]="ExpirableMap";const{source:r=[],expirationTime:n=10*60*1e3}=t,i=Date.now();Fa(this,rt,new Map([...r].map(([o,d])=>[o,{value:d,timestamp:i}])),"f"),Fa(this,Qr,n,"f")}prune(){const t=Date.now();for(const[r,n]of st(this,rt,"f").entries())t-n.timestamp>st(this,Qr,"f")&&st(this,rt,"f").delete(r);return this}set(t,r){this.prune();const n={value:r,timestamp:Date.now()};return st(this,rt,"f").set(t,n),this}get(t){const r=st(this,rt,"f").get(t);if(r!==void 0){if(Date.now()-r.timestamp>st(this,Qr,"f")){st(this,rt,"f").delete(t);return}return r.value}}clear(){st(this,rt,"f").clear()}entries(){const t=st(this,rt,"f").entries();return function*(){for(const[n,i]of t)yield[n,i.value]}()}values(){const t=st(this,rt,"f").values();return function*(){for(const n of t)yield n.value}()}keys(){return st(this,rt,"f").keys()}forEach(t,r){for(const[n,i]of st(this,rt,"f").entries())t.call(r,i.value,n,this)}has(t){return st(this,rt,"f").has(t)}delete(t){return st(this,rt,"f").delete(t)}get size(){return st(this,rt,"f").size}}rt=new WeakMap,Qr=new WeakMap,Mc=Symbol.iterator,Vc=Symbol.toStringTag;const Pa=e=>{if(e<=127)return 1;if(e<=255)return 2;if(e<=65535)return 3;if(e<=16777215)return 4;throw new Error("Length too long (> 4 bytes)")},ka=(e,t,r)=>{if(r<=127)return e[t]=r,1;if(r<=255)return e[t]=129,e[t+1]=r,2;if(r<=65535)return e[t]=130,e[t+1]=r>>8,e[t+2]=r,3;if(r<=16777215)return e[t]=131,e[t+1]=r>>16,e[t+2]=r>>8,e[t+3]=r,4;throw new Error("Length too long (> 4 bytes)")},Ss=(e,t)=>{if(e[t]<128)return 1;if(e[t]===128)throw new Error("Invalid length 0");if(e[t]===129)return 2;if(e[t]===130)return 3;if(e[t]===131)return 4;throw new Error("Length too long (> 4 bytes)")},Yd=(e,t)=>{const r=Ss(e,t);if(r===1)return e[t];if(r===2)return e[t+1];if(r===3)return(e[t+1]<<8)+e[t+2];if(r===4)return(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];throw new Error("Length too long (> 4 bytes)")};Uint8Array.from([48,12,6,10,43,6,1,4,1,131,184,67,1,1]);const wi=Uint8Array.from([48,5,6,3,43,101,112]);Uint8Array.from([48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,10]);function $c(e,t){const r=2+Pa(e.byteLength+1),n=t.byteLength+r+e.byteLength;let i=0;const o=new Uint8Array(1+Pa(n)+n);return o[i++]=48,i+=ka(o,i,n),o.set(t,i),i+=t.byteLength,o[i++]=3,i+=ka(o,i,e.byteLength+1),o[i++]=0,o.set(new Uint8Array(e),i),o}const qc=(e,t)=>{let r=0;const n=(c,w)=>{if(i[r++]!==c)throw new Error("Expected: "+w)},i=new Uint8Array(e);if(n(48,"sequence"),r+=Ss(i,r),!vi(i.slice(r,r+t.byteLength),t))throw new Error("Not the expected OID.");r+=t.byteLength,n(3,"bit string");const o=Yd(i,r)-1;r+=Ss(i,r),n(0,"0 padding");const d=i.slice(r);if(o!==d.length)throw new Error(`DER payload mismatch: Expected length ${o} actual length ${d.length}`);return d};var Ca=function(e,t,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,r):i?i.value=r:t.set(e,r),r},Ma=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},Hn,Dn;let jc=class en{constructor(t){if(Hn.set(this,void 0),Dn.set(this,void 0),t.byteLength!==en.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");Ca(this,Hn,t,"f"),Ca(this,Dn,en.derEncode(t),"f")}static from(t){return this.fromDer(t.toDer())}static fromRaw(t){return new en(t)}static fromDer(t){return new en(this.derDecode(t))}static derEncode(t){return $c(t,wi).buffer}static derDecode(t){const r=qc(t,wi);if(r.length!==this.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");return r}get rawKey(){return Ma(this,Hn,"f")}get derKey(){return Ma(this,Dn,"f")}toDer(){return this.derKey}toRaw(){return this.rawKey}};Hn=new WeakMap,Dn=new WeakMap;jc.RAW_KEY_LENGTH=32;class Zd{constructor(){this.observers=[]}subscribe(t){this.observers.push(t)}unsubscribe(t){this.observers=this.observers.filter(r=>r!==t)}notify(t,...r){this.observers.forEach(n=>n(t,...r))}}class Xd extends Zd{constructor(){super()}print(t,...r){this.notify({message:t,level:"info"},...r)}warn(t,...r){this.notify({message:t,level:"warn"},...r)}error(t,r,...n){this.notify({message:t,level:"error",error:r},...n)}}var It=function(e,t,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,r):i?i.value=r:t.set(e,r),r},tt=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},Ot,Kn,zn,Wn,Yn,Zn,Xn,Jn,Rr;const Gc=.5,Lc=1.5,Hc=500,Dc=6e4,Kc=9e5,zc=10;class Pi{constructor(t=Pi.default){Ot.set(this,void 0),Kn.set(this,void 0),zn.set(this,void 0),Wn.set(this,void 0),Yn.set(this,void 0),Zn.set(this,void 0),Xn.set(this,void 0),Jn.set(this,void 0),Rr.set(this,0);const{initialInterval:r=Hc,randomizationFactor:n=Gc,multiplier:i=Lc,maxInterval:o=Dc,maxElapsedTime:d=Kc,maxIterations:c=zc,date:w=Date}=t;It(this,Ot,r,"f"),It(this,Kn,n,"f"),It(this,zn,i,"f"),It(this,Wn,o,"f"),It(this,Jn,w,"f"),It(this,Yn,w.now(),"f"),It(this,Zn,d,"f"),It(this,Xn,c,"f")}get ellapsedTimeInMsec(){return tt(this,Jn,"f").now()-tt(this,Yn,"f")}get currentInterval(){return tt(this,Ot,"f")}get count(){return tt(this,Rr,"f")}get randomValueFromInterval(){const t=tt(this,Kn,"f")*tt(this,Ot,"f"),r=tt(this,Ot,"f")-t,n=tt(this,Ot,"f")+t;return Math.random()*(n-r)+r}incrementCurrentInterval(){var t;return It(this,Ot,Math.min(tt(this,Ot,"f")*tt(this,zn,"f"),tt(this,Wn,"f")),"f"),It(this,Rr,(t=tt(this,Rr,"f"),t++,t),"f"),tt(this,Ot,"f")}next(){return this.ellapsedTimeInMsec>=tt(this,Zn,"f")||tt(this,Rr,"f")>=tt(this,Xn,"f")?null:(this.incrementCurrentInterval(),this.randomValueFromInterval)}}Ot=new WeakMap,Kn=new WeakMap,zn=new WeakMap,Wn=new WeakMap,Yn=new WeakMap,Zn=new WeakMap,Xn=new WeakMap,Jn=new WeakMap,Rr=new WeakMap;Pi.default={initialInterval:Hc,randomizationFactor:Gc,multiplier:Lc,maxInterval:Dc,maxElapsedTime:Kc,maxIterations:zc,date:Date};const Wc=5*60*1e3;var at=function(e,t,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,r):i?i.value=r:t.set(e,r),r},ye=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},Ct,Rt,er,Vr,tn,rn,Et,Qn,xt,dr,hr,nn,Ur,Fr,pr,gr,Yc,ei,ti,Vt;(function(e){e.Received="received",e.Processing="processing",e.Replied="replied",e.Rejected="rejected",e.Unknown="unknown",e.Done="done"})(Vt||(Vt={}));const Pn=60*1e3,Jd="308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100814c0e6ec71fab583b08bd81373c255c3c371b2e84863c98a4f1e08b74235d14fb5d9c0cd546d9685f913a0c0b2cc5341583bf4b4392e467db96d65b9bb4cb717112f8472e0d5a4d14505ffd7484b01291091c5f87b98883463f98091a0baaae",Qd="aaaaa-aa",eh="ic0.app",th=".ic0.app",rh="icp0.io",nh=".icp0.io",ih="icp-api.io",sh=".icp-api.io";class rs extends De{constructor(t){super(t),this.message=t}}class kn extends De{constructor(t){super(t),this.message=t}}function ah(){let e;if(typeof window<"u")if(window.fetch)e=window.fetch.bind(window);else throw new rs("Fetch implementation was not available. You appear to be in a browser context, but window.fetch was not present.");else if(typeof global<"u")if(global.fetch)e=global.fetch.bind(global);else throw new rs("Fetch implementation was not available. You appear to be in a Node.js context, but global.fetch was not available.");else typeof self<"u"&&self.fetch&&(e=self.fetch.bind(self));if(e)return e;throw new rs("Fetch implementation was not available. Please provide fetch to the HttpAgent constructor, or ensure it is available in the window or global context.")}function oh(e){let t;if(e!==void 0)!e.match(/^[a-z]+:/)&&typeof window<"u"?t=new URL(window.location.protocol+"//"+e):t=new URL(e);else{const r=["ic0.app","icp0.io","127.0.0.1","localhost"],n=[".github.dev",".gitpod.io"],i=typeof window<"u"?window.location:void 0,o=i?.hostname;let d;o&&typeof o=="string"&&(n.some(c=>o.endsWith(c))?d=o:d=r.find(c=>o.endsWith(c))),i&&d?t=new URL(`${i.protocol}//${d}${i.port?":"+i.port:""}`):t=new URL("https://icp-api.io")}return t.toString()}class $r{constructor(t={}){var r;Ct.add(this),Rt.set(this,void 0),er.set(this,void 0),Vr.set(this,void 0),tn.set(this,void 0),rn.set(this,0),Et.set(this,void 0),Qn.set(this,!1),xt.set(this,void 0),dr.set(this,void 0),hr.set(this,void 0),this._isAgent=!0,this.config={},nn.set(this,0),this.log=new Xd,Ur.set(this,[]),Fr.set(this,[]),pr.set(this,new Wd({expirationTime:5*60*1e3})),gr.set(this,!0),ti.set(this,(o,d)=>{if(ye(this,gr,"f")===!1)return o;if(!d)throw new Ft("Invalid signature from replica signed query: no matching node key found.");const{status:c,signatures:w=[],requestId:E}=o,A=new TextEncoder().encode("\vic-response");for(const I of w){const{timestamp:S,identity:N}=I,b=ve.fromUint8Array(N).toText();let j;if(c==="replied"){const{reply:ie}=o;j=li({status:c,reply:ie,timestamp:BigInt(S),request_id:E})}else if(c==="rejected"){const{reject_code:ie,reject_message:C,error_code:Z}=o;j=li({status:c,reject_code:ie,reject_message:C,error_code:Z,timestamp:BigInt(S),request_id:E})}else throw new Error(`Unknown status: ${c}`);const V=Bt(A,new Uint8Array(j)),W=d?.nodeKeys.get(b);if(!W)throw new Ft("Invalid signature from replica signed query: no matching node key found.");const K=jc.fromDer(W).rawKey;if(Or.verify(I.signature,new Uint8Array(V),new Uint8Array(K)))return o;throw new Ft(`Invalid signature from replica ${b} signed query.`)}return o}),this.config=t,at(this,er,t.fetch||ah()||fetch.bind(global),"f"),at(this,Vr,t.fetchOptions,"f"),at(this,tn,t.callOptions,"f"),this.rootKey=t.rootKey?t.rootKey:Lt(Jd);const n=oh(t.host);this.host=new URL(n),t.verifyQuerySignatures!==void 0&&at(this,gr,t.verifyQuerySignatures,"f"),at(this,xt,(r=t.retryTimes)!==null&&r!==void 0?r:3,"f");const i=()=>new Pi({maxIterations:ye(this,xt,"f")});if(at(this,dr,t.backoffStrategy||i,"f"),this.host.hostname.endsWith(th)?this.host.hostname=eh:this.host.hostname.endsWith(nh)?this.host.hostname=rh:this.host.hostname.endsWith(sh)&&(this.host.hostname=ih),t.credentials){const{name:o,password:d}=t.credentials;at(this,Et,`${o}${d?":"+d:""}`,"f")}if(at(this,Rt,Promise.resolve(t.identity||new di),"f"),t.ingressExpiryInMinutes&&t.ingressExpiryInMinutes>5)throw new De(`The maximum ingress expiry time is 5 minutes. Provided ingress expiry time is ${t.ingressExpiryInMinutes} minutes.`);if(t.ingressExpiryInMinutes&&t.ingressExpiryInMinutes<=0)throw new De(`Ingress expiry time must be greater than 0. Provided ingress expiry time is ${t.ingressExpiryInMinutes} minutes.`);at(this,hr,t.ingressExpiryInMinutes||5,"f"),this.addTransform("update",ha(xs)),t.useQueryNonces&&this.addTransform("query",ha(xs)),t.logToConsole&&this.log.subscribe(o=>{o.level==="error"?console.error(o.message):o.level==="warn"?console.warn(o.message):console.log(o.message)})}get waterMark(){return ye(this,nn,"f")}static createSync(t={}){return new this(Object.assign({},t))}static async create(t={shouldFetchRootKey:!1}){const r=$r.createSync(t),n=[r.syncTime()];return r.host.toString()!=="https://icp-api.io"&&t.shouldFetchRootKey&&n.push(r.fetchRootKey()),await Promise.all(n),r}static async from(t){var r;try{return"config"in t?await $r.create(t.config):await $r.create({fetch:t._fetch,fetchOptions:t._fetchOptions,callOptions:t._callOptions,host:t._host.toString(),identity:(r=t._identity)!==null&&r!==void 0?r:void 0})}catch{throw new De("Failed to create agent from provided agent")}}isLocal(){const t=this.host.hostname;return t==="127.0.0.1"||t.endsWith("127.0.0.1")}addTransform(t,r,n=r.priority||0){if(t==="update"){const i=ye(this,Fr,"f").findIndex(o=>(o.priority||0)<n);ye(this,Fr,"f").splice(i>=0?i:ye(this,Fr,"f").length,0,Object.assign(r,{priority:n}))}else if(t==="query"){const i=ye(this,Ur,"f").findIndex(o=>(o.priority||0)<n);ye(this,Ur,"f").splice(i>=0?i:ye(this,Ur,"f").length,0,Object.assign(r,{priority:n}))}}async getPrincipal(){if(!ye(this,Rt,"f"))throw new kn("This identity has expired due this application's security policy. Please refresh your authentication.");return(await ye(this,Rt,"f")).getPrincipal()}async call(t,r,n){var i;const o=(i=r.callSync)!==null&&i!==void 0?i:!0,d=await(n!==void 0?await n:await ye(this,Rt,"f"));if(!d)throw new kn("This identity has expired due this application's security policy. Please refresh your authentication.");const c=ve.from(t),w=r.effectiveCanisterId?ve.from(r.effectiveCanisterId):c,E=d.getPrincipal()||ve.anonymous();let A=new Ir(ye(this,hr,"f")*Pn);Math.abs(ye(this,rn,"f"))>1e3*30&&(A=new Ir(ye(this,hr,"f")*Pn+ye(this,rn,"f")));const I={request_type:Es.Call,canister_id:c,method_name:r.methodName,arg:r.arg,sender:E,ingress_expiry:A};let S=await this._transform({request:{body:null,method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},ye(this,Et,"f")?{Authorization:"Basic "+btoa(ye(this,Et,"f"))}:{})},endpoint:"call",body:I});const N=S.body.nonce?b(S.body.nonce):void 0;I.nonce=N;function b(W){return new Uint8Array(W)}S=await d.transformRequest(S);const j=Ki(S.body),V=ye(this,dr,"f").call(this);try{const W=()=>(this.log.print(`fetching "/api/v3/canister/${w.toText()}/call" with request:`,S),ye(this,er,"f").call(this,""+new URL(`/api/v3/canister/${w.toText()}/call`,this.host),Object.assign(Object.assign(Object.assign({},ye(this,tn,"f")),S.request),{body:j}))),K=()=>(this.log.print(`fetching "/api/v2/canister/${w.toText()}/call" with request:`,S),ye(this,er,"f").call(this,""+new URL(`/api/v2/canister/${w.toText()}/call`,this.host),Object.assign(Object.assign(Object.assign({},ye(this,tn,"f")),S.request),{body:j}))),$=ye(this,Ct,"m",ei).call(this,{request:o?W:K,backoff:V,tries:0}),ie=ln(I),C=await $,Z=await C.arrayBuffer(),q=C.status===200&&Z.byteLength>0?jt(Z):null;if(q&&"certificate"in q){const Q=await this.parseTimeFromResponse({certificate:q.certificate});at(this,nn,Q,"f")}return{requestId:ie,response:{ok:C.ok,status:C.status,statusText:C.statusText,body:q,headers:Xr(C.headers)},requestDetails:I}}catch(W){if(W.message.includes("v3 api not supported."))return this.log.warn("v3 api not supported. Fall back to v2"),this.call(t,Object.assign(Object.assign({},r),{callSync:!1}),n);throw this.log.error("Error while making call:",W),W}}async query(t,r,n){const i=ye(this,dr,"f").call(this),o=r.effectiveCanisterId?ve.from(r.effectiveCanisterId):ve.from(t);this.log.print(`ecid ${o.toString()}`),this.log.print(`canisterId ${t.toString()}`);const d=async()=>{const N=await(n!==void 0?n:ye(this,Rt,"f"));if(!N)throw new kn("This identity has expired due this application's security policy. Please refresh your authentication.");const b=ve.from(t),j=N?.getPrincipal()||ve.anonymous(),V={request_type:"query",canister_id:b,method_name:r.methodName,arg:r.arg,sender:j,ingress_expiry:new Ir(ye(this,hr,"f")*Pn)},W=ln(V);let K=await this._transform({request:{method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},ye(this,Et,"f")?{Authorization:"Basic "+btoa(ye(this,Et,"f"))}:{})},endpoint:"read",body:V});K=await N?.transformRequest(K);const $=Ki(K.body),ie={canister:b.toText(),ecid:o,transformedRequest:K,body:$,requestId:W,backoff:i,tries:0};return{requestDetails:V,query:await ye(this,Ct,"m",Yc).call(this,ie)}},c=async()=>{if(!ye(this,gr,"f"))return;const N=ye(this,pr,"f").get(o.toString());return N||(await this.fetchSubnetKeys(o.toString()),ye(this,pr,"f").get(o.toString()))},[w,E]=await Promise.all([d(),c()]),{requestDetails:A,query:I}=w,S=Object.assign(Object.assign({},I),{requestDetails:A});if(this.log.print("Query response:",S),!ye(this,gr,"f"))return S;try{return ye(this,ti,"f").call(this,S,E)}catch{this.log.warn("Query response verification failed. Retrying with fresh subnet keys."),ye(this,pr,"f").delete(t.toString()),await this.fetchSubnetKeys(o.toString());const b=ye(this,pr,"f").get(t.toString());if(!b)throw new Ft("Invalid signature from replica signed query: no matching node key found.");return ye(this,ti,"f").call(this,S,b)}}async createReadStateRequest(t,r){const n=await(r!==void 0?await r:await ye(this,Rt,"f"));if(!n)throw new kn("This identity has expired due this application's security policy. Please refresh your authentication.");const i=n?.getPrincipal()||ve.anonymous(),o=await this._transform({request:{method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},ye(this,Et,"f")?{Authorization:"Basic "+btoa(ye(this,Et,"f"))}:{})},endpoint:"read_state",body:{request_type:"read_state",paths:t.paths,sender:i,ingress_expiry:new Ir(ye(this,hr,"f")*Pn)}});return n?.transformRequest(o)}async readState(t,r,n,i){const o=typeof t=="string"?ve.fromText(t):t,d=i??await this.createReadStateRequest(r,n),c=Object.assign(Object.assign({},d.body),{ingress_expiry:new Ir(Wc)}),w=Ki(c);this.log.print(`fetching "/api/v2/canister/${o}/read_state" with request:`,d);const E=ye(this,dr,"f").call(this);try{const A=await ye(this,Ct,"m",ei).call(this,{request:()=>ye(this,er,"f").call(this,""+new URL(`/api/v2/canister/${o.toString()}/read_state`,this.host),Object.assign(Object.assign(Object.assign({},ye(this,Vr,"f")),d.request),{body:w})),backoff:E,tries:0});if(!A.ok)throw new Error(`Server returned an error:
  Code: ${A.status} (${A.statusText})
  Body: ${await A.text()}
`);const I=jt(await A.arrayBuffer());this.log.print("Read state response:",I);const S=await this.parseTimeFromResponse(I);return S>0&&(this.log.print("Read state response time:",S),at(this,nn,S,"f")),I}catch(A){throw this.log.error("Caught exception while attempting to read state",A),A}}async parseTimeFromResponse(t){let r;if(t.certificate){const n=jt(t.certificate);if(n&&"tree"in n)r=n.tree;else throw new Error("Could not decode time from response");const i=Lr(["time"],r);if(i.status!==He.Found)throw new Error("Time was not found in the response or was not in its expected format.");if(!(i.value instanceof ArrayBuffer)&&!ArrayBuffer.isView(i))throw new Error("Time was not found in the response or was not in its expected format.");const o=Ws(ks(i.value));return this.log.print("Time from response:",o),this.log.print("Time from response in milliseconds:",Number(o)),Number(o)}else this.log.warn("No certificate found in response");return 0}async syncTime(t){const r=await Ou(()=>Promise.resolve().then(()=>fd),void 0,import.meta.url),n=Date.now();try{t||this.log.print("Syncing time with the IC. No canisterId provided, so falling back to ryjl3-tyaaa-aaaaa-aaaba-cai");const o=(await r.request({canisterId:t??ve.from("ryjl3-tyaaa-aaaaa-aaaba-cai"),agent:this,paths:["time"]})).get("time");o&&at(this,rn,Number(o)-Number(n),"f")}catch(i){this.log.error("Caught exception while attempting to sync time",i)}}async status(){const t=ye(this,Et,"f")?{Authorization:"Basic "+btoa(ye(this,Et,"f"))}:{};this.log.print('fetching "/api/v2/status"');const r=ye(this,dr,"f").call(this),n=await ye(this,Ct,"m",ei).call(this,{backoff:r,request:()=>ye(this,er,"f").call(this,""+new URL("/api/v2/status",this.host),Object.assign({headers:t},ye(this,Vr,"f"))),tries:0});return jt(await n.arrayBuffer())}async fetchRootKey(){if(!ye(this,Qn,"f")){const t=await this.status();this.rootKey=t.root_key,at(this,Qn,!0,"f")}return this.rootKey}invalidateIdentity(){at(this,Rt,null,"f")}replaceIdentity(t){at(this,Rt,Promise.resolve(t),"f")}async fetchSubnetKeys(t){const r=ve.from(t),i=(await Fc({canisterId:r,paths:["subnet"],agent:this})).get("subnet");if(i&&typeof i=="object"&&"nodeKeys"in i)return ye(this,pr,"f").set(r.toText(),i),i}_transform(t){let r=Promise.resolve(t);if(t.endpoint==="call")for(const n of ye(this,Fr,"f"))r=r.then(i=>n(i).then(o=>o||i));else for(const n of ye(this,Ur,"f"))r=r.then(i=>n(i).then(o=>o||i));return r}}Rt=new WeakMap,er=new WeakMap,Vr=new WeakMap,tn=new WeakMap,rn=new WeakMap,Et=new WeakMap,Qn=new WeakMap,xt=new WeakMap,dr=new WeakMap,hr=new WeakMap,nn=new WeakMap,Ur=new WeakMap,Fr=new WeakMap,pr=new WeakMap,gr=new WeakMap,ti=new WeakMap,Ct=new WeakSet,Yc=async function e(t){var r,n;const{ecid:i,transformedRequest:o,body:d,requestId:c,backoff:w,tries:E}=t,A=E===0?0:w.next();if(this.log.print(`fetching "/api/v2/canister/${i.toString()}/query" with tries:`,{tries:E,backoff:w,delay:A}),A===null)throw new De(`Timestamp failed to pass the watermark after retrying the configured ${ye(this,xt,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`);A>0&&await new Promise(b=>setTimeout(b,A));let I;try{this.log.print(`fetching "/api/v2/canister/${i.toString()}/query" with request:`,o);const b=await ye(this,er,"f").call(this,""+new URL(`/api/v2/canister/${i.toString()}/query`,this.host),Object.assign(Object.assign(Object.assign({},ye(this,Vr,"f")),o.request),{body:d}));if(b.status===200){const j=jt(await b.arrayBuffer());I=Object.assign(Object.assign({},j),{httpDetails:{ok:b.ok,status:b.status,statusText:b.statusText,headers:Xr(b.headers)},requestId:c})}else throw new zi(`Gateway returned an error:
  Code: ${b.status} (${b.statusText})
  Body: ${await b.text()}
`,{ok:b.ok,status:b.status,statusText:b.statusText,headers:Xr(b.headers)})}catch(b){if(E<ye(this,xt,"f"))return this.log.warn(`Caught exception while attempting to make query:
  ${b}
  Retrying query.`),await ye(this,Ct,"m",e).call(this,Object.assign(Object.assign({},t),{tries:E+1}));throw b}const S=(n=(r=I.signatures)===null||r===void 0?void 0:r[0])===null||n===void 0?void 0:n.timestamp;if(!ye(this,gr,"f"))return I;if(!S)throw new Error("Timestamp not found in query response. This suggests a malformed or malicious response.");const N=Number(BigInt(S)/BigInt(1e6));if(this.log.print("watermark and timestamp",{waterMark:this.waterMark,timestamp:N}),Number(this.waterMark)>N){const b=new De("Timestamp is below the watermark. Retrying query.");if(this.log.error("Timestamp is below",b,{timestamp:S,waterMark:this.waterMark}),E<ye(this,xt,"f"))return await ye(this,Ct,"m",e).call(this,Object.assign(Object.assign({},t),{tries:E+1}));throw new De(`Timestamp failed to pass the watermark after retrying the configured ${ye(this,xt,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`)}return I},ei=async function e(t){const{request:r,backoff:n,tries:i}=t,o=i===0?0:n.next();if(o===null)throw new De(`Timestamp failed to pass the watermark after retrying the configured ${ye(this,xt,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`);o>0&&await new Promise(E=>setTimeout(E,o));let d;try{d=await r()}catch(E){if(ye(this,xt,"f")>i)return this.log.warn(`Caught exception while attempting to make request:
  ${E}
  Retrying request.`),await ye(this,Ct,"m",e).call(this,{request:r,backoff:n,tries:i+1});throw E}if(d.ok)return d;const c=await d.clone().text(),w=`Server returned an error:
  Code: ${d.status} (${d.statusText})
  Body: ${c}
`;if(d.status===404&&d.url.includes("api/v3"))throw new zi("v3 api not supported. Fall back to v2",{ok:d.ok,status:d.status,statusText:d.statusText,headers:Xr(d.headers)});if(i<ye(this,xt,"f"))return await ye(this,Ct,"m",e).call(this,{request:r,backoff:n,tries:i+1});throw new zi(w,{ok:d.ok,status:d.status,statusText:d.statusText,headers:Xr(d.headers)})};var Va;(function(e){e.Error="err",e.GetPrincipal="gp",e.GetPrincipalResponse="gpr",e.Query="q",e.QueryResponse="qr",e.Call="c",e.CallResponse="cr",e.ReadState="rs",e.ReadStateResponse="rsr",e.Status="s",e.StatusResponse="sr"})(Va||(Va={}));function $a(){const e=typeof window>"u"?typeof global>"u"?typeof self>"u"?void 0:self.ic.agent:global.ic.agent:window.ic.agent;if(!e)throw new Error("No Agent could be found.");return e}const ch=5*60*1e3;function Zc(){return hh(fh(uh(),1e3),dh(1e3,1.2),lh(ch))}function uh(){let e=!0;return async()=>e?(e=!1,!0):!1}function fh(e,t){return async(r,n,i)=>{if(await e(r,n,i))return new Promise(o=>setTimeout(o,t))}}function lh(e){const t=Date.now()+e;return async(r,n,i)=>{if(Date.now()>t)throw new Error(`Request timed out after ${e} msec:
  Request ID: ${et(n)}
  Request status: ${i}
`)}}function dh(e,t){let r=e;return()=>new Promise(n=>setTimeout(()=>{r*=t,n()},r))}function hh(...e){return async(t,r,n)=>{for(const i of e)await i(t,r,n)}}function Nr(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function ph(e){return e!==null&&typeof e=="object"&&Nr(e,"body")&&e.body!==null&&typeof e.body=="object"&&Nr(e.body,"content")&&e.body.content!==null&&typeof e.body.content=="object"&&Nr(e.body.content,"request_type")&&e.body.content.request_type==="read_state"&&Nr(e.body.content,"ingress_expiry")&&typeof e.body.content.ingress_expiry=="object"&&e.body.content.ingress_expiry!==null&&Nr(e.body.content.ingress_expiry,"toCBOR")&&typeof e.body.content.ingress_expiry.toCBOR=="function"&&Nr(e.body.content.ingress_expiry,"toHash")&&typeof e.body.content.ingress_expiry.toHash=="function"}async function Xc(e,t,r,n=Zc(),i,o){var d;const c=[new TextEncoder().encode("request_status"),r],w=i??await((d=e.createReadStateRequest)===null||d===void 0?void 0:d.call(e,{paths:[c]}));i&&ph(w)&&(w.body.content.ingress_expiry=new Ir(Wc));const E=await e.readState(t,{paths:[c]},void 0,w);if(e.rootKey==null)throw new Error("Agent root key not initialized before polling");const A=await wr.create({certificate:E.certificate,rootKey:e.rootKey,canisterId:t,blsVerify:o}),I=gt(A.lookup([...c,new TextEncoder().encode("status")]));let S;switch(typeof I>"u"?S=Vt.Unknown:S=new TextDecoder().decode(I),S){case Vt.Replied:return{reply:gt(A.lookup([...c,"reply"])),certificate:A};case Vt.Received:case Vt.Unknown:case Vt.Processing:return await n(t,r,S),Xc(e,t,r,n,w,o);case Vt.Rejected:{const N=new Uint8Array(gt(A.lookup([...c,"reject_code"])))[0],b=new TextDecoder().decode(gt(A.lookup([...c,"reject_message"])));throw new Error(`Call was rejected:
  Request ID: ${et(r)}
  Reject code: ${N}
  Reject text: ${b}
`)}case Vt.Done:throw new Error(`Call was marked as done but we never saw the reply:
  Request ID: ${et(r)}
`)}throw new Error("unreachable")}const yh=({IDL:e})=>{const t=e.Variant({mainnet:e.Null,testnet:e.Null}),r=e.Text,n=e.Record({network:t,address:r,min_confirmations:e.Opt(e.Nat32)}),i=e.Nat64,o=i,d=e.Nat32,c=e.Record({start_height:d,end_height:e.Opt(d),network:t}),w=e.Vec(e.Nat8),E=e.Record({tip_height:d,block_headers:e.Vec(w)}),A=e.Record({network:t}),I=e.Nat64,S=e.Vec(I),N=e.Record({network:t,filter:e.Opt(e.Variant({page:e.Vec(e.Nat8),min_confirmations:e.Nat32})),address:r}),b=e.Vec(e.Nat8),j=e.Record({txid:e.Vec(e.Nat8),vout:e.Nat32}),V=e.Record({height:e.Nat32,value:i,outpoint:j}),W=e.Record({next_page:e.Opt(e.Vec(e.Nat8)),tip_height:d,tip_block_hash:b,utxos:e.Vec(V)}),K=e.Record({transaction:e.Vec(e.Nat8),network:t}),$=e.Principal,ie=e.Record({canister_id:$,num_requested_changes:e.Opt(e.Nat64)}),C=e.Variant({from_user:e.Record({user_id:e.Principal}),from_canister:e.Record({canister_version:e.Opt(e.Nat64),canister_id:e.Principal})}),Z=e.Vec(e.Nat8),q=e.Variant({creation:e.Record({controllers:e.Vec(e.Principal)}),code_deployment:e.Record({mode:e.Variant({reinstall:e.Null,upgrade:e.Null,install:e.Null}),module_hash:e.Vec(e.Nat8)}),load_snapshot:e.Record({canister_version:e.Nat64,taken_at_timestamp:e.Nat64,snapshot_id:Z}),controllers_change:e.Record({controllers:e.Vec(e.Principal)}),code_uninstall:e.Null}),Q=e.Record({timestamp_nanos:e.Nat64,canister_version:e.Nat64,origin:C,details:q}),re=e.Record({controllers:e.Vec(e.Principal),module_hash:e.Opt(e.Vec(e.Nat8)),recent_changes:e.Vec(Q),total_num_changes:e.Nat64}),X=e.Record({canister_id:$}),de=e.Variant({controllers:e.Null,public:e.Null}),fe=e.Record({freezing_threshold:e.Nat,controllers:e.Vec(e.Principal),reserved_cycles_limit:e.Nat,log_visibility:de,wasm_memory_limit:e.Nat,memory_allocation:e.Nat,compute_allocation:e.Nat}),R=e.Record({status:e.Variant({stopped:e.Null,stopping:e.Null,running:e.Null}),memory_size:e.Nat,cycles:e.Nat,settings:fe,query_stats:e.Record({response_payload_bytes_total:e.Nat,num_instructions_total:e.Nat,num_calls_total:e.Nat,request_payload_bytes_total:e.Nat}),idle_cycles_burned_per_day:e.Nat,module_hash:e.Opt(e.Vec(e.Nat8)),reserved_cycles:e.Nat}),P=e.Record({canister_id:$}),z=e.Record({freezing_threshold:e.Opt(e.Nat),controllers:e.Opt(e.Vec(e.Principal)),reserved_cycles_limit:e.Opt(e.Nat),log_visibility:e.Opt(de),wasm_memory_limit:e.Opt(e.Nat),memory_allocation:e.Opt(e.Nat),compute_allocation:e.Opt(e.Nat)}),M=e.Record({settings:e.Opt(z),sender_canister_version:e.Opt(e.Nat64)}),G=e.Record({canister_id:$}),J=e.Record({canister_id:$}),ee=e.Record({canister_id:$,snapshot_id:Z}),ge=e.Record({canister_id:$}),ae=e.Variant({secp256k1:e.Null}),le=e.Record({key_id:e.Record({name:e.Text,curve:ae}),canister_id:e.Opt($),derivation_path:e.Vec(e.Vec(e.Nat8))}),te=e.Record({public_key:e.Vec(e.Nat8),chain_code:e.Vec(e.Nat8)}),_=e.Record({canister_id:$}),se=e.Record({idx:e.Nat64,timestamp_nanos:e.Nat64,content:e.Vec(e.Nat8)}),ue=e.Record({canister_log_records:e.Vec(se)}),he=e.Record({value:e.Text,name:e.Text}),ne=e.Record({status:e.Nat,body:e.Vec(e.Nat8),headers:e.Vec(he)}),ce=e.Record({url:e.Text,method:e.Variant({get:e.Null,head:e.Null,post:e.Null}),max_response_bytes:e.Opt(e.Nat64),body:e.Opt(e.Vec(e.Nat8)),transform:e.Opt(e.Record({function:e.Func([e.Record({context:e.Vec(e.Nat8),response:ne})],[ne],["query"]),context:e.Vec(e.Nat8)})),headers:e.Vec(he)}),m=e.Variant({reinstall:e.Null,upgrade:e.Opt(e.Record({wasm_memory_persistence:e.Opt(e.Variant({keep:e.Null,replace:e.Null})),skip_pre_upgrade:e.Opt(e.Bool)})),install:e.Null}),s=e.Record({hash:e.Vec(e.Nat8)}),h=e.Record({arg:e.Vec(e.Nat8),wasm_module_hash:e.Vec(e.Nat8),mode:m,chunk_hashes_list:e.Vec(s),target_canister:$,store_canister:e.Opt($),sender_canister_version:e.Opt(e.Nat64)}),x=e.Vec(e.Nat8),v=e.Record({arg:e.Vec(e.Nat8),wasm_module:x,mode:m,canister_id:$,sender_canister_version:e.Opt(e.Nat64)}),U=e.Record({canister_id:$}),p=e.Record({id:Z,total_size:e.Nat64,taken_at_timestamp:e.Nat64}),a=e.Vec(p),u=e.Record({canister_id:$,sender_canister_version:e.Opt(e.Nat64),snapshot_id:Z}),g=e.Record({start_at_timestamp_nanos:e.Nat64,subnet_id:e.Principal}),T=e.Record({num_block_failures_total:e.Nat64,node_id:e.Principal,num_blocks_proposed_total:e.Nat64}),O=e.Vec(e.Record({timestamp_nanos:e.Nat64,node_metrics:e.Vec(T)})),L=e.Record({settings:e.Opt(z),specified_id:e.Opt($),amount:e.Opt(e.Nat),sender_canister_version:e.Opt(e.Nat64)}),Y=e.Record({canister_id:$}),oe=e.Record({canister_id:$,amount:e.Nat}),pe=e.Vec(e.Nat8),me=e.Variant({ed25519:e.Null,bip340secp256k1:e.Null}),y=e.Record({key_id:e.Record({algorithm:me,name:e.Text}),canister_id:e.Opt($),derivation_path:e.Vec(e.Vec(e.Nat8))}),f=e.Record({public_key:e.Vec(e.Nat8),chain_code:e.Vec(e.Nat8)}),l=e.Record({key_id:e.Record({name:e.Text,curve:ae}),derivation_path:e.Vec(e.Vec(e.Nat8)),message_hash:e.Vec(e.Nat8)}),B=e.Record({signature:e.Vec(e.Nat8)}),k=e.Record({key_id:e.Record({algorithm:me,name:e.Text}),derivation_path:e.Vec(e.Vec(e.Nat8)),message:e.Vec(e.Nat8)}),D=e.Record({signature:e.Vec(e.Nat8)}),H=e.Record({canister_id:$}),_e=e.Record({canister_id:$}),Te=e.Record({canister_id:$}),xe=e.Vec(s),Ee=e.Record({replace_snapshot:e.Opt(Z),canister_id:$}),Oe=p,ke=e.Record({canister_id:$,sender_canister_version:e.Opt(e.Nat64)}),Mi=e.Record({canister_id:e.Principal,settings:z,sender_canister_version:e.Opt(e.Nat64)}),Vi=e.Record({chunk:e.Vec(e.Nat8),canister_id:e.Principal}),$i=s;return e.Service({bitcoin_get_balance:e.Func([n],[o],[]),bitcoin_get_block_headers:e.Func([c],[E],[]),bitcoin_get_current_fee_percentiles:e.Func([A],[S],[]),bitcoin_get_utxos:e.Func([N],[W],[]),bitcoin_send_transaction:e.Func([K],[],[]),canister_info:e.Func([ie],[re],[]),canister_status:e.Func([X],[R],[]),clear_chunk_store:e.Func([P],[],[]),create_canister:e.Func([M],[G],[]),delete_canister:e.Func([J],[],[]),delete_canister_snapshot:e.Func([ee],[],[]),deposit_cycles:e.Func([ge],[],[]),ecdsa_public_key:e.Func([le],[te],[]),fetch_canister_logs:e.Func([_],[ue],["query"]),http_request:e.Func([ce],[ne],[]),install_chunked_code:e.Func([h],[],[]),install_code:e.Func([v],[],[]),list_canister_snapshots:e.Func([U],[a],[]),load_canister_snapshot:e.Func([u],[],[]),node_metrics_history:e.Func([g],[O],[]),provisional_create_canister_with_cycles:e.Func([L],[Y],[]),provisional_top_up_canister:e.Func([oe],[],[]),raw_rand:e.Func([],[pe],[]),schnorr_public_key:e.Func([y],[f],[]),sign_with_ecdsa:e.Func([l],[B],[]),sign_with_schnorr:e.Func([k],[D],[]),start_canister:e.Func([H],[],[]),stop_canister:e.Func([_e],[],[]),stored_chunks:e.Func([Te],[xe],[]),take_canister_snapshot:e.Func([Ee],[Oe],[]),uninstall_code:e.Func([ke],[],[]),update_settings:e.Func([Mi],[],[]),upload_chunk:e.Func([Vi],[$i],[])})};class Jc extends De{constructor(t,r,n,i){super(["Call failed:",`  Canister: ${t.toText()}`,`  Method: ${r} (${n})`,...Object.getOwnPropertyNames(i).map(o=>`  "${o}": ${JSON.stringify(i[o])}`)].join(`
`)),this.canisterId=t,this.methodName=r,this.type=n,this.props=i}}class gh extends Jc{constructor(t,r,n){var i;super(t,r,"query",{Status:n.status,Code:(i=ls[n.reject_code])!==null&&i!==void 0?i:`Unknown Code "${n.reject_code}"`,Message:n.reject_message}),this.result=n}}class qa extends Jc{constructor(t,r,n,i,o,d,c){super(t,r,"update",Object.assign({"Request ID":et(n)},i.body?Object.assign(Object.assign({},c?{"Error code":c}:{}),{"Reject code":String(o),"Reject message":d}):{"HTTP status code":i.status.toString(),"HTTP status text":i.statusText})),this.requestId=n,this.response=i,this.reject_code=o,this.reject_message=d,this.error_code=c}}const yt=Symbol.for("ic-agent-metadata");class yn{constructor(t){this[yt]=Object.freeze(t)}static agentOf(t){return t[yt].config.agent}static interfaceOf(t){return t[yt].service}static canisterIdOf(t){return ve.from(t[yt].config.canisterId)}static async install(t,r){const n=t.mode===void 0?{install:null}:t.mode,i=t.arg?[...new Uint8Array(t.arg)]:[],o=[...new Uint8Array(t.module)],d=typeof r.canisterId=="string"?ve.fromText(r.canisterId):r.canisterId;await ja(r).install_code({mode:n,arg:i,wasm_module:o,canister_id:d,sender_canister_version:[]})}static async createCanister(t,r){function n(o){return[{controllers:o.controllers?[o.controllers]:[],compute_allocation:o.compute_allocation?[o.compute_allocation]:[],freezing_threshold:o.freezing_threshold?[o.freezing_threshold]:[],memory_allocation:o.memory_allocation?[o.memory_allocation]:[],reserved_cycles_limit:[],log_visibility:[],wasm_memory_limit:[]}]}const{canister_id:i}=await ja(t||{}).provisional_create_canister_with_cycles({amount:[],settings:n(r||{}),specified_id:[],sender_canister_version:[]});return i}static async createAndInstallCanister(t,r,n){const i=await this.createCanister(n);return await this.install(Object.assign({},r),Object.assign(Object.assign({},n),{canisterId:i})),this.createActor(t,Object.assign(Object.assign({},n),{canisterId:i}))}static createActorClass(t,r){const n=t({IDL:xf});class i extends yn{constructor(d){if(!d.canisterId)throw new De(`Canister ID is required, but received ${typeof d.canisterId} instead. If you are using automatically generated declarations, this may be because your application is not setting the canister ID in process.env correctly.`);const c=typeof d.canisterId=="string"?ve.fromText(d.canisterId):d.canisterId;super({config:Object.assign(Object.assign(Object.assign({},Qc),d),{canisterId:c}),service:n});for(const[w,E]of n._fields)r?.httpDetails&&E.annotations.push(Is),r?.certificate&&E.annotations.push(eu),this[w]=wh(this,w,E,d.blsVerify)}}return i}static createActor(t,r){if(!r.canisterId)throw new De(`Canister ID is required, but received ${typeof r.canisterId} instead. If you are using automatically generated declarations, this may be because your application is not setting the canister ID in process.env correctly.`);return new(this.createActorClass(t))(r)}static createActorWithHttpDetails(t,r){return new(this.createActorClass(t,{httpDetails:!0}))(r)}static createActorWithExtendedDetails(t,r,n={httpDetails:!0,certificate:!0}){return new(this.createActorClass(t,n))(r)}}function Sr(e,t){const r=_o(e,Qa.Buffer.from(t));switch(r.length){case 0:return;case 1:return r[0];default:return r}}const Qc={pollingStrategyFactory:Zc},Is="http-details",eu="certificate";function wh(e,t,r,n){let i;r.annotations.includes("query")||r.annotations.includes("composite_query")?i=async(d,...c)=>{var w,E;d=Object.assign(Object.assign({},d),(E=(w=e[yt].config).queryTransform)===null||E===void 0?void 0:E.call(w,t,c,Object.assign(Object.assign({},e[yt].config),d)));const A=d.agent||e[yt].config.agent||$a(),I=ve.from(d.canisterId||e[yt].config.canisterId),S=hs(r.argTypes,c),N=await A.query(I,{methodName:t,arg:S,effectiveCanisterId:d.effectiveCanisterId}),b=Object.assign(Object.assign({},N.httpDetails),{requestDetails:N.requestDetails});switch(N.status){case"rejected":throw new gh(I,t,N);case"replied":return r.annotations.includes(Is)?{httpDetails:b,result:Sr(r.retTypes,N.reply.arg)}:Sr(r.retTypes,N.reply.arg)}}:i=async(d,...c)=>{var w,E;d=Object.assign(Object.assign({},d),(E=(w=e[yt].config).callTransform)===null||E===void 0?void 0:E.call(w,t,c,Object.assign(Object.assign({},e[yt].config),d)));const A=d.agent||e[yt].config.agent||$a(),{canisterId:I,effectiveCanisterId:S,pollingStrategyFactory:N}=Object.assign(Object.assign(Object.assign({},Qc),e[yt].config),d),b=ve.from(I),j=S!==void 0?ve.from(S):b,V=hs(r.argTypes,c);if(A.rootKey==null)throw new De("Agent root key not initialized before making call");const{requestId:W,response:K,requestDetails:$}=await A.call(b,{methodName:t,arg:V,effectiveCanisterId:j});let ie,C;if(K.body&&K.body.certificate){const re=K.body.certificate;C=await wr.create({certificate:ci(re),rootKey:A.rootKey,canisterId:ve.from(I),blsVerify:n});const X=[new TextEncoder().encode("request_status"),W];switch(new TextDecoder().decode(gt(C.lookup([...X,"status"])))){case"replied":ie=gt(C.lookup([...X,"reply"]));break;case"rejected":{const fe=new Uint8Array(gt(C.lookup([...X,"reject_code"])))[0],R=new TextDecoder().decode(gt(C.lookup([...X,"reject_message"]))),P=gt(C.lookup([...X,"error_code"])),z=P?new TextDecoder().decode(P):void 0;throw new qa(b,t,W,K,fe,R,z)}}}else if(K.body&&"reject_message"in K.body){const{reject_code:re,reject_message:X,error_code:de}=K.body;throw new qa(b,t,W,K,re,X,de)}if(K.status===202){const re=N(),X=await Xc(A,j,W,re,n);C=X.certificate,ie=X.reply}const Z=r.annotations.includes(Is),q=r.annotations.includes(eu),Q=Object.assign(Object.assign({},K),{requestDetails:$});if(ie!==void 0)return Z&&q?{httpDetails:Q,certificate:C,result:Sr(r.retTypes,ie)}:q?{certificate:C,result:Sr(r.retTypes,ie)}:Z?{httpDetails:Q,result:Sr(r.retTypes,ie)}:Sr(r.retTypes,ie);if(r.retTypes.length===0)return Z?{httpDetails:K,result:void 0}:void 0;throw new Error(`Call was returned undefined, but type [${r.retTypes.join(",")}].`)};const o=(...d)=>i({},...d);return o.withOptions=d=>(...c)=>i(d,...c),o}function ja(e){function t(r,n){if(e.effectiveCanisterId)return{effectiveCanisterId:ve.from(e.effectiveCanisterId)};const i=n[0];let o=ve.fromHex("");return i&&typeof i=="object"&&i.target_canister&&r==="install_chunked_code"&&(o=ve.from(i.target_canister)),i&&typeof i=="object"&&i.canister_id&&(o=ve.from(i.canister_id)),{effectiveCanisterId:o}}return yn.createActor(yh,Object.assign(Object.assign(Object.assign({},e),{canisterId:ve.fromHex("")}),{callTransform:t,queryTransform:t}))}var mi=function(e,t,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,r):i?i.value=r:t.set(e,r),r},tr=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},ri,ni,Pr,kr;function Ga(e){return e!==null&&typeof e=="object"}class Gt{constructor(t){if(ri.set(this,void 0),ni.set(this,void 0),t.byteLength!==Gt.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");mi(this,ri,t,"f"),mi(this,ni,Gt.derEncode(t),"f")}static from(t){if(typeof t=="string"){const r=Lt(t);return this.fromRaw(r)}else if(Ga(t)){const r=t;if(Ga(r)&&Object.hasOwnProperty.call(r,"__derEncodedPublicKey__"))return this.fromDer(r);if(ArrayBuffer.isView(r)){const n=r;return this.fromRaw(ks(n.buffer))}else{if(r instanceof ArrayBuffer)return this.fromRaw(r);if("rawKey"in r)return this.fromRaw(r.rawKey);if("derKey"in r)return this.fromDer(r.derKey);if("toDer"in r)return this.fromDer(r.toDer())}}throw new Error("Cannot construct Ed25519PublicKey from the provided key.")}static fromRaw(t){return new Gt(t)}static fromDer(t){return new Gt(this.derDecode(t))}static derEncode(t){const r=$c(t,wi).buffer;return r.__derEncodedPublicKey__=void 0,r}static derDecode(t){const r=qc(t,wi);if(r.length!==this.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");return r}get rawKey(){return tr(this,ri,"f")}get derKey(){return tr(this,ni,"f")}toDer(){return this.derKey}toRaw(){return this.rawKey}}ri=new WeakMap,ni=new WeakMap;Gt.RAW_KEY_LENGTH=32;class ar extends Gs{constructor(t,r){super(),Pr.set(this,void 0),kr.set(this,void 0),mi(this,Pr,Gt.from(t),"f"),mi(this,kr,new Uint8Array(r),"f")}static generate(t){if(t&&t.length!==32)throw new Error("Ed25519 Seed needs to be 32 bytes long.");t||(t=Or.utils.randomPrivateKey()),vi(t,new Uint8Array(new Array(32).fill(0)))&&console.warn("Seed is all zeros. This is not a secure seed. Please provide a seed with sufficient entropy if this is a production environment.");const r=new Uint8Array(32);for(let i=0;i<32;i++)r[i]=new Uint8Array(t)[i];const n=Or.getPublicKey(r);return ar.fromKeyPair(n,r)}static fromParsedJson(t){const[r,n]=t;return new ar(Gt.fromDer(Lt(r)),Lt(n))}static fromJSON(t){const r=JSON.parse(t);if(Array.isArray(r)){if(typeof r[0]=="string"&&typeof r[1]=="string")return this.fromParsedJson([r[0],r[1]]);throw new Error("Deserialization error: JSON must have at least 2 items.")}throw new Error(`Deserialization error: Invalid JSON type for string: ${JSON.stringify(t)}`)}static fromKeyPair(t,r){return new ar(Gt.fromRaw(t),r)}static fromSecretKey(t){const r=Or.getPublicKey(new Uint8Array(t));return ar.fromKeyPair(r,t)}toJSON(){return[et(tr(this,Pr,"f").toDer()),et(tr(this,kr,"f"))]}getKeyPair(){return{secretKey:tr(this,kr,"f"),publicKey:tr(this,Pr,"f")}}getPublicKey(){return tr(this,Pr,"f")}async sign(t){const r=new Uint8Array(t),n=sn(Or.sign(r,tr(this,kr,"f").slice(0,32)));return Object.defineProperty(n,"__signature__",{enumerable:!1,value:void 0}),n}static verify(t,r,n){const[i,o,d]=[t,r,n].map(c=>(typeof c=="string"&&(c=Lt(c)),c instanceof Uint8Array&&(c=c.buffer),new Uint8Array(c)));return Or.verify(o,i,d)}}Pr=new WeakMap,kr=new WeakMap;class Zs extends Error{constructor(t){super(t),this.message=t,Object.setPrototypeOf(this,Zs.prototype)}}function La(e){if(typeof global<"u"&&global.crypto&&global.crypto.subtle)return global.crypto.subtle;if(e)return e;if(typeof crypto<"u"&&crypto.subtle)return crypto.subtle;throw new Zs("Global crypto was not available and none was provided. Please inlcude a SubtleCrypto implementation. See https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto")}class bi extends Gs{constructor(t,r,n){super(),this._keyPair=t,this._derKey=r,this._subtleCrypto=n}static async generate(t){const{extractable:r=!1,keyUsages:n=["sign","verify"],subtleCrypto:i}=t??{},o=La(i),d=await o.generateKey({name:"ECDSA",namedCurve:"P-256"},r,n),c=await o.exportKey("spki",d.publicKey);return new this(d,c,o)}static async fromKeyPair(t,r){const n=La(r),i=await n.exportKey("spki",t.publicKey);return new bi(t,i,n)}getKeyPair(){return this._keyPair}getPublicKey(){const t=this._derKey,r=Object.create(this._keyPair.publicKey);return r.toDer=function(){return t},r}async sign(t){const r={name:"ECDSA",hash:{name:"SHA-256"}};return await this._subtleCrypto.sign(r,this._keyPair.privateKey,t)}}var mh=function(e,t,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,r):i?i.value=r:t.set(e,r),r},Yr=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},Xt;class bh{constructor(t){Xt.set(this,void 0),mh(this,Xt,t,"f")}get rawKey(){return Yr(this,Xt,"f").rawKey}get derKey(){return Yr(this,Xt,"f").derKey}toDer(){return Yr(this,Xt,"f").toDer()}getPublicKey(){return Yr(this,Xt,"f")}getPrincipal(){return ve.from(Yr(this,Xt,"f").rawKey)}transformRequest(){return Promise.reject("Not implemented. You are attempting to use a partial identity to sign calls, but this identity only has access to the public key.To sign calls, use a DelegationIdentity instead.")}}Xt=new WeakMap;var _h=function(e,t,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,r):i?i.value=r:t.set(e,r),r},Eh=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},xh=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r},ii;const Th=new TextEncoder().encode("ic-request-auth-delegation"),vh=new TextEncoder().encode(`
ic-request`);function ns(e){if(typeof e!="string"||e.length<64)throw new Error("Invalid public key.");return Lt(e)}class Xs{constructor(t,r,n){this.pubkey=t,this.expiration=r,this.targets=n}toCBOR(){return lt.value.map(Object.assign({pubkey:lt.value.bytes(this.pubkey),expiration:lt.value.u64(this.expiration.toString(16),16)},this.targets&&{targets:lt.value.array(this.targets.map(t=>lt.value.bytes(t.toUint8Array())))}))}toJSON(){return Object.assign({expiration:this.expiration.toString(16),pubkey:et(this.pubkey)},this.targets&&{targets:this.targets.map(t=>t.toHex())})}}async function Bh(e,t,r,n){const i=new Xs(t.toDer(),BigInt(+r)*BigInt(1e6),n),o=new Uint8Array([...Th,...new Uint8Array(ln(Object.assign({},i)))]),d=await e.sign(o);return{delegation:i,signature:d}}class _i{constructor(t,r){this.delegations=t,this.publicKey=r}static async create(t,r,n=new Date(Date.now()+15*60*1e3),i={}){var o,d;const c=await Bh(t,r,n,i.targets);return new _i([...((o=i.previous)===null||o===void 0?void 0:o.delegations)||[],c],((d=i.previous)===null||d===void 0?void 0:d.publicKey)||t.getPublicKey().toDer())}static fromJSON(t){const{publicKey:r,delegations:n}=typeof t=="string"?JSON.parse(t):t;if(!Array.isArray(n))throw new Error("Invalid delegations.");const i=n.map(o=>{const{delegation:d,signature:c}=o,{pubkey:w,expiration:E,targets:A}=d;if(A!==void 0&&!Array.isArray(A))throw new Error("Invalid targets.");return{delegation:new Xs(ns(w),BigInt("0x"+E),A&&A.map(I=>{if(typeof I!="string")throw new Error("Invalid target.");return ve.fromHex(I)})),signature:ns(c)}});return new this(i,ns(r))}static fromDelegations(t,r){return new this(t,r)}toJSON(){return{delegations:this.delegations.map(t=>{const{delegation:r,signature:n}=t,{targets:i}=r;return{delegation:Object.assign({expiration:r.expiration.toString(16),pubkey:et(r.pubkey)},i&&{targets:i.map(o=>o.toHex())}),signature:et(n)}}),publicKey:et(this.publicKey)}}}class Ha extends Gs{constructor(t,r){super(),this._inner=t,this._delegation=r}static fromDelegation(t,r){return new this(t,r)}getDelegation(){return this._delegation}getPublicKey(){return{derKey:this._delegation.publicKey,toDer:()=>this._delegation.publicKey}}sign(t){return this._inner.sign(t)}async transformRequest(t){const{body:r}=t,n=xh(t,["body"]),i=await ln(r);return Object.assign(Object.assign({},n),{body:{content:r,sender_sig:await this.sign(new Uint8Array([...vh,...new Uint8Array(i)])),sender_delegation:this._delegation.delegations,sender_pubkey:this._delegation.publicKey}})}}class Ei extends bh{constructor(t,r){super(t),ii.set(this,void 0),_h(this,ii,r,"f")}get delegation(){return Eh(this,ii,"f")}static fromDelegation(t,r){return new Ei(t,r)}}ii=new WeakMap;function Ah(e,t){for(const{delegation:n}of e.delegations)if(+new Date(Number(n.expiration/BigInt(1e6)))<=+Date.now())return!1;const r=[];for(const n of r){const i=n.toText();for(const{delegation:o}of e.delegations){if(o.targets===void 0)continue;let d=!0;for(const c of o.targets)if(c.toText()===i){d=!1;break}if(d)return!1}}return!0}var Da;(function(e){e[e.ECDSA_WITH_SHA256=-7]="ECDSA_WITH_SHA256"})(Da||(Da={}));const Ka=["mousedown","mousemove","keydown","touchstart","wheel"];class za{constructor(t={}){var r;this.callbacks=[],this.idleTimeout=10*60*1e3,this.timeoutID=void 0;const{onIdle:n,idleTimeout:i=10*60*1e3}=t||{};this.callbacks=n?[n]:[],this.idleTimeout=i;const o=this._resetTimer.bind(this);window.addEventListener("load",o,!0),Ka.forEach(function(c){document.addEventListener(c,o,!0)});const d=(c,w)=>{let E;return(...A)=>{const I=this,S=function(){E=void 0,c.apply(I,A)};clearTimeout(E),E=window.setTimeout(S,w)}};if(t?.captureScroll){const c=d(o,(r=t?.scrollDebounce)!==null&&r!==void 0?r:100);window.addEventListener("scroll",c,!0)}o()}static create(t={}){return new this(t)}registerCallback(t){this.callbacks.push(t)}exit(){clearTimeout(this.timeoutID),window.removeEventListener("load",this._resetTimer,!0);const t=this._resetTimer.bind(this);Ka.forEach(function(r){document.removeEventListener(r,t,!0)}),this.callbacks.forEach(r=>r())}_resetTimer(){const t=this.exit.bind(this);window.clearTimeout(this.timeoutID),this.timeoutID=window.setTimeout(t,this.idleTimeout)}}const Nh=(e,t)=>t.some(r=>e instanceof r);let Wa,Ya;function Sh(){return Wa||(Wa=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Ih(){return Ya||(Ya=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const tu=new WeakMap,Os=new WeakMap,ru=new WeakMap,is=new WeakMap,Js=new WeakMap;function Oh(e){const t=new Promise((r,n)=>{const i=()=>{e.removeEventListener("success",o),e.removeEventListener("error",d)},o=()=>{r(cr(e.result)),i()},d=()=>{n(e.error),i()};e.addEventListener("success",o),e.addEventListener("error",d)});return t.then(r=>{r instanceof IDBCursor&&tu.set(r,e)}).catch(()=>{}),Js.set(t,e),t}function Rh(e){if(Os.has(e))return;const t=new Promise((r,n)=>{const i=()=>{e.removeEventListener("complete",o),e.removeEventListener("error",d),e.removeEventListener("abort",d)},o=()=>{r(),i()},d=()=>{n(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",o),e.addEventListener("error",d),e.addEventListener("abort",d)});Os.set(e,t)}let Rs={get(e,t,r){if(e instanceof IDBTransaction){if(t==="done")return Os.get(e);if(t==="objectStoreNames")return e.objectStoreNames||ru.get(e);if(t==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return cr(e[t])},set(e,t,r){return e[t]=r,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function Uh(e){Rs=e(Rs)}function Fh(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...r){const n=e.call(ss(this),t,...r);return ru.set(n,t.sort?t.sort():[t]),cr(n)}:Ih().includes(e)?function(...t){return e.apply(ss(this),t),cr(tu.get(this))}:function(...t){return cr(e.apply(ss(this),t))}}function Ph(e){return typeof e=="function"?Fh(e):(e instanceof IDBTransaction&&Rh(e),Nh(e,Sh())?new Proxy(e,Rs):e)}function cr(e){if(e instanceof IDBRequest)return Oh(e);if(is.has(e))return is.get(e);const t=Ph(e);return t!==e&&(is.set(e,t),Js.set(t,e)),t}const ss=e=>Js.get(e);function kh(e,t,{blocked:r,upgrade:n,blocking:i,terminated:o}={}){const d=indexedDB.open(e,t),c=cr(d);return n&&d.addEventListener("upgradeneeded",w=>{n(cr(d.result),w.oldVersion,w.newVersion,cr(d.transaction),w)}),r&&d.addEventListener("blocked",w=>r(w.oldVersion,w.newVersion,w)),c.then(w=>{o&&w.addEventListener("close",()=>o()),i&&w.addEventListener("versionchange",E=>i(E.oldVersion,E.newVersion,E))}).catch(()=>{}),c}const Ch=["get","getKey","getAll","getAllKeys","count"],Mh=["put","add","delete","clear"],as=new Map;function Za(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(as.get(t))return as.get(t);const r=t.replace(/FromIndex$/,""),n=t!==r,i=Mh.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||Ch.includes(r)))return;const o=async function(d,...c){const w=this.transaction(d,i?"readwrite":"readonly");let E=w.store;return n&&(E=E.index(c.shift())),(await Promise.all([E[r](...c),i&&w.done]))[0]};return as.set(t,o),o}Uh(e=>({...e,get:(t,r,n)=>Za(t,r)||e.get(t,r,n),has:(t,r)=>!!Za(t,r)||e.has(t,r)}));const nu="auth-client-db",iu="ic-keyval",Vh=async(e=nu,t=iu,r)=>(su&&(localStorage!=null&&localStorage.getItem(sr))&&(localStorage.removeItem(sr),localStorage.removeItem(rr)),await kh(e,r,{upgrade:n=>{n.objectStoreNames.contains(t)&&n.clear(t),n.createObjectStore(t)}}));async function $h(e,t,r){return await e.get(t,r)}async function qh(e,t,r,n){return await e.put(t,n,r)}async function jh(e,t,r){return await e.delete(t,r)}class Qs{constructor(t,r){this._db=t,this._storeName=r}static async create(t){const{dbName:r=nu,storeName:n=iu,version:i=Dh}=t??{},o=await Vh(r,n,i);return new Qs(o,n)}async set(t,r){return await qh(this._db,this._storeName,t,r)}async get(t){var r;return(r=await $h(this._db,this._storeName,t))!==null&&r!==void 0?r:null}async remove(t){return await jh(this._db,this._storeName,t)}}var Gh=function(e,t,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,r):i?i.value=r:t.set(e,r),r},Lh=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},si;const rr="identity",sr="delegation",Hh="iv",Dh=1,su=typeof window<"u";class Kh{constructor(t="ic-",r){this.prefix=t,this._localStorage=r}get(t){return Promise.resolve(this._getLocalStorage().getItem(this.prefix+t))}set(t,r){return this._getLocalStorage().setItem(this.prefix+t,r),Promise.resolve()}remove(t){return this._getLocalStorage().removeItem(this.prefix+t),Promise.resolve()}_getLocalStorage(){if(this._localStorage)return this._localStorage;const t=typeof window>"u"?typeof global>"u"?typeof self>"u"?void 0:self.localStorage:global.localStorage:window.localStorage;if(!t)throw new Error("Could not find local storage.");return t}}class zh{constructor(t){si.set(this,void 0),Gh(this,si,t??{},"f")}get _db(){return new Promise(t=>{if(this.initializedDb){t(this.initializedDb);return}Qs.create(Lh(this,si,"f")).then(r=>{this.initializedDb=r,t(r)})})}async get(t){return await(await this._db).get(t)}async set(t,r){await(await this._db).set(t,r)}async remove(t){await(await this._db).remove(t)}}si=new WeakMap;const Wh="https://identity.ic0.app",Yh="#authorize",os="ECDSA",cs="Ed25519",Zh=500,Xh="UserInterrupt";class H0{constructor(t,r,n,i,o,d,c,w){this._identity=t,this._key=r,this._chain=n,this._storage=i,this.idleManager=o,this._createOptions=d,this._idpWindow=c,this._eventHandler=w,this._registerDefaultIdleCallback()}static async create(t={}){var r,n,i;const o=(r=t.storage)!==null&&r!==void 0?r:new zh,d=(n=t.keyType)!==null&&n!==void 0?n:os;let c=null;if(t.identity)c=t.identity;else{let I=await o.get(rr);if(!I&&su)try{const S=new Kh,N=await S.get(sr),b=await S.get(rr);N&&b&&d===os&&(console.log("Discovered an identity stored in localstorage. Migrating to IndexedDB"),await o.set(sr,N),await o.set(rr,b),I=N,await S.remove(sr),await S.remove(rr))}catch(S){console.error("error while attempting to recover localstorage: "+S)}if(I)try{typeof I=="object"?d===cs&&typeof I=="string"?c=await ar.fromJSON(I):c=await bi.fromKeyPair(I):typeof I=="string"&&(c=ar.fromJSON(I))}catch{}}let w=new di,E=null;if(c)try{const I=await o.get(sr);if(typeof I=="object"&&I!==null)throw new Error("Delegation chain is incorrectly stored. A delegation chain should be stored as a string.");t.identity?w=t.identity:I&&(E=_i.fromJSON(I),Ah(E)?"toDer"in c?w=Ei.fromDelegation(c,E):w=Ha.fromDelegation(c,E):(await us(o),c=null))}catch(I){console.error(I),await us(o),c=null}let A;return!((i=t.idleOptions)===null||i===void 0)&&i.disableIdle?A=void 0:(E||t.identity)&&(A=za.create(t.idleOptions)),c||(d===cs?(c=await ar.generate(),await o.set(rr,JSON.stringify(c.toJSON()))):(t.storage&&d===os&&console.warn(`You are using a custom storage provider that may not support CryptoKey storage. If you are using a custom storage provider that does not support CryptoKey storage, you should use '${cs}' as the key type, as it can serialize to a string`),c=await bi.generate(),await o.set(rr,c.getKeyPair()))),new this(w,c,E,o,A,t)}_registerDefaultIdleCallback(){var t,r;const n=(t=this._createOptions)===null||t===void 0?void 0:t.idleOptions;!n?.onIdle&&!n?.disableDefaultIdleCallback&&((r=this.idleManager)===null||r===void 0||r.registerCallback(()=>{this.logout(),location.reload()}))}async _handleSuccess(t,r){var n,i;const o=t.delegations.map(E=>({delegation:new Xs(E.delegation.pubkey,E.delegation.expiration,E.delegation.targets),signature:E.signature.buffer})),d=_i.fromDelegations(o,t.userPublicKey.buffer),c=this._key;if(!c)return;this._chain=d,"toDer"in c?this._identity=Ei.fromDelegation(c,this._chain):this._identity=Ha.fromDelegation(c,this._chain),(n=this._idpWindow)===null||n===void 0||n.close();const w=(i=this._createOptions)===null||i===void 0?void 0:i.idleOptions;!this.idleManager&&!w?.disableIdle&&(this.idleManager=za.create(w),this._registerDefaultIdleCallback()),this._removeEventListener(),delete this._idpWindow,this._chain&&await this._storage.set(sr,JSON.stringify(this._chain.toJSON())),r?.(t)}getIdentity(){return this._identity}async isAuthenticated(){return!this.getIdentity().getPrincipal().isAnonymous()&&this._chain!==null}async login(t){var r,n,i,o;const d=BigInt(8)*BigInt(36e11),c=new URL(((r=t?.identityProvider)===null||r===void 0?void 0:r.toString())||Wh);c.hash=Yh,(n=this._idpWindow)===null||n===void 0||n.close(),this._removeEventListener(),this._eventHandler=this._getEventHandler(c,Object.assign({maxTimeToLive:(i=t?.maxTimeToLive)!==null&&i!==void 0?i:d},t)),window.addEventListener("message",this._eventHandler),this._idpWindow=(o=window.open(c.toString(),"idpWindow",t?.windowOpenerFeatures))!==null&&o!==void 0?o:void 0;const w=()=>{this._idpWindow&&(this._idpWindow.closed?this._handleFailure(Xh,t?.onError):setTimeout(w,Zh))};w()}_getEventHandler(t,r){return async n=>{var i,o,d;if(n.origin!==t.origin)return;const c=n.data;switch(c.kind){case"authorize-ready":{const w=Object.assign({kind:"authorize-client",sessionPublicKey:new Uint8Array((i=this._key)===null||i===void 0?void 0:i.getPublicKey().toDer()),maxTimeToLive:r?.maxTimeToLive,allowPinAuthentication:r?.allowPinAuthentication,derivationOrigin:(o=r?.derivationOrigin)===null||o===void 0?void 0:o.toString()},r?.customValues);(d=this._idpWindow)===null||d===void 0||d.postMessage(w,t.origin);break}case"authorize-client-success":try{await this._handleSuccess(c,r?.onSuccess)}catch(w){this._handleFailure(w.message,r?.onError)}break;case"authorize-client-failure":this._handleFailure(c.text,r?.onError);break}}}_handleFailure(t,r){var n;(n=this._idpWindow)===null||n===void 0||n.close(),r?.(t),this._removeEventListener(),delete this._idpWindow}_removeEventListener(){this._eventHandler&&window.removeEventListener("message",this._eventHandler),this._eventHandler=void 0}async logout(t={}){if(await us(this._storage),this._identity=new di,this._chain=null,t.returnTo)try{window.history.pushState({},"",t.returnTo)}catch{window.location.href=t.returnTo}}}async function us(e){await e.remove(rr),await e.remove(sr),await e.remove(Hh)}var Jh=(e=>(e[e.FractionalMoreThan8Decimals=0]="FractionalMoreThan8Decimals",e[e.InvalidFormat=1]="InvalidFormat",e[e.FractionalTooManyDecimals=2]="FractionalTooManyDecimals",e))(Jh||{});BigInt(1e8);var Qh=class{constructor(e,t,r){this.id=e,this.service=t,this.certifiedService=r,this.caller=({certified:n=!0})=>n?this.certifiedService:this.service}get canisterId(){return this.id}},au=e=>e==null,Us=e=>!au(e),e0=()=>$r.createSync({host:"https://icp-api.io",identity:new di}),D0=async({identity:e,host:t,fetchRootKey:r=!1,verifyQuerySignatures:n=!1,retryTimes:i})=>await $r.create({identity:e,...Us(t)&&{host:t},verifyQuerySignatures:n,...Us(i)&&{retryTimes:i},shouldFetchRootKey:r}),t0=({options:{canisterId:e,serviceOverride:t,certifiedServiceOverride:r,agent:n,callTransform:i,queryTransform:o},idlFactory:d,certifiedIdlFactory:c})=>{let w=n??e0(),E=t??yn.createActor(d,{agent:w,canisterId:e,callTransform:i,queryTransform:o}),A=r??yn.createActor(c,{agent:w,canisterId:e,callTransform:i,queryTransform:o});return{service:E,certifiedService:A,agent:w,canisterId:e}},Xa="abcdefghijklmnopqrstuvwxyz234567",gn=Object.create(null);for(let e=0;e<Xa.length;e++)gn[Xa[e]]=e;gn[0]=gn.o;gn[1]=gn.i;var Xe=e=>Us(e)?[e]:[],r0=({IDL:e})=>{let t=e.Rec(),r=e.Rec(),n=e.Rec(),i=e.Record({num_blocks_to_archive:e.Opt(e.Nat64),max_transactions_per_response:e.Opt(e.Nat64),trigger_threshold:e.Opt(e.Nat64),more_controller_ids:e.Opt(e.Vec(e.Principal)),max_message_size_bytes:e.Opt(e.Nat64),cycles_for_archive_creation:e.Opt(e.Nat64),node_max_memory_size_bytes:e.Opt(e.Nat64),controller_id:e.Opt(e.Principal)}),o=e.Variant({Int:e.Int,Nat:e.Nat,Blob:e.Vec(e.Nat8),Text:e.Text}),d=e.Vec(e.Nat8),c=e.Record({owner:e.Principal,subaccount:e.Opt(d)}),w=e.Variant({SetTo:c,Unset:e.Null}),E=e.Record({icrc2:e.Bool}),A=e.Record({change_archive_options:e.Opt(i),token_symbol:e.Opt(e.Text),transfer_fee:e.Opt(e.Nat),metadata:e.Opt(e.Vec(e.Tuple(e.Text,o))),change_fee_collector:e.Opt(w),max_memo_length:e.Opt(e.Nat16),token_name:e.Opt(e.Text),feature_flags:e.Opt(E)}),I=e.Record({decimals:e.Opt(e.Nat8),token_symbol:e.Text,transfer_fee:e.Nat,metadata:e.Vec(e.Tuple(e.Text,o)),minting_account:c,initial_balances:e.Vec(e.Tuple(c,e.Nat)),fee_collector_account:e.Opt(c),archive_options:e.Record({num_blocks_to_archive:e.Nat64,max_transactions_per_response:e.Opt(e.Nat64),trigger_threshold:e.Nat64,more_controller_ids:e.Opt(e.Vec(e.Principal)),max_message_size_bytes:e.Opt(e.Nat64),cycles_for_archive_creation:e.Opt(e.Nat64),node_max_memory_size_bytes:e.Opt(e.Nat64),controller_id:e.Principal}),max_memo_length:e.Opt(e.Nat16),token_name:e.Text,feature_flags:e.Opt(E)});e.Variant({Upgrade:e.Opt(A),Init:I});let S=e.Nat,N=e.Record({block_range_end:S,canister_id:e.Principal,block_range_start:S}),b=e.Record({start:S,length:e.Nat}),j=e.Vec(e.Tuple(e.Text,n));n.fill(e.Variant({Int:e.Int,Map:j,Nat:e.Nat,Nat64:e.Nat64,Blob:e.Vec(e.Nat8),Text:e.Text,Array:e.Vec(n)}));let V=n,W=e.Record({blocks:e.Vec(V)}),K=e.Func([b],[W],[]),$=e.Record({certificate:e.Opt(e.Vec(e.Nat8)),first_index:S,blocks:e.Vec(V),chain_length:e.Nat64,archived_blocks:e.Vec(e.Record({callback:K,start:S,length:e.Nat}))}),ie=e.Record({certificate:e.Opt(e.Vec(e.Nat8)),hash_tree:e.Vec(e.Nat8)}),C=e.Nat,Z=e.Record({start:C,length:e.Nat}),q=e.Nat64,Q=e.Record({from:c,memo:e.Opt(e.Vec(e.Nat8)),created_at_time:e.Opt(q),amount:e.Nat,spender:e.Opt(c)}),re=e.Record({to:c,memo:e.Opt(e.Vec(e.Nat8)),created_at_time:e.Opt(q),amount:e.Nat}),X=e.Record({fee:e.Opt(e.Nat),from:c,memo:e.Opt(e.Vec(e.Nat8)),created_at_time:e.Opt(q),amount:e.Nat,expected_allowance:e.Opt(e.Nat),expires_at:e.Opt(q),spender:c}),de=e.Record({to:c,fee:e.Opt(e.Nat),from:c,memo:e.Opt(e.Vec(e.Nat8)),created_at_time:e.Opt(q),amount:e.Nat,spender:e.Opt(c)}),fe=e.Record({burn:e.Opt(Q),kind:e.Text,mint:e.Opt(re),approve:e.Opt(X),timestamp:q,transfer:e.Opt(de)}),R=e.Record({transactions:e.Vec(fe)}),P=e.Func([Z],[R],[]),z=e.Record({first_index:C,log_length:e.Nat,transactions:e.Vec(fe),archived_transactions:e.Vec(e.Record({callback:P,start:C,length:e.Nat}))}),M=e.Nat,G=e.Record({url:e.Text,name:e.Text}),J=e.Record({to:c,fee:e.Opt(M),memo:e.Opt(e.Vec(e.Nat8)),from_subaccount:e.Opt(d),created_at_time:e.Opt(q),amount:M}),ee=e.Variant({GenericError:e.Record({message:e.Text,error_code:e.Nat}),TemporarilyUnavailable:e.Null,BadBurn:e.Record({min_burn_amount:M}),Duplicate:e.Record({duplicate_of:S}),BadFee:e.Record({expected_fee:M}),CreatedInFuture:e.Record({ledger_time:q}),TooOld:e.Null,InsufficientFunds:e.Record({balance:M})}),ge=e.Variant({Ok:S,Err:ee}),ae=e.Record({utc_offset_minutes:e.Opt(e.Int16),language:e.Text}),le=e.Record({metadata:ae,device_spec:e.Opt(e.Variant({GenericDisplay:e.Null,LineDisplay:e.Record({characters_per_line:e.Nat16,lines_per_page:e.Nat16})}))}),te=e.Record({arg:e.Vec(e.Nat8),method:e.Text,user_preferences:le}),_=e.Variant({LineDisplayMessage:e.Record({pages:e.Vec(e.Record({lines:e.Vec(e.Text)}))}),GenericDisplayMessage:e.Text}),se=e.Record({metadata:ae,consent_message:_}),ue=e.Record({description:e.Text}),he=e.Variant({GenericError:e.Record({description:e.Text,error_code:e.Nat}),InsufficientPayment:ue,UnsupportedCanisterCall:ue,ConsentMessageUnavailable:ue}),ne=e.Variant({Ok:se,Err:he}),ce=e.Record({account:c,spender:c}),m=e.Record({allowance:e.Nat,expires_at:e.Opt(q)}),s=e.Record({fee:e.Opt(e.Nat),memo:e.Opt(e.Vec(e.Nat8)),from_subaccount:e.Opt(e.Vec(e.Nat8)),created_at_time:e.Opt(q),amount:e.Nat,expected_allowance:e.Opt(e.Nat),expires_at:e.Opt(q),spender:c}),h=e.Variant({GenericError:e.Record({message:e.Text,error_code:e.Nat}),TemporarilyUnavailable:e.Null,Duplicate:e.Record({duplicate_of:S}),BadFee:e.Record({expected_fee:e.Nat}),AllowanceChanged:e.Record({current_allowance:e.Nat}),CreatedInFuture:e.Record({ledger_time:q}),TooOld:e.Null,Expired:e.Record({ledger_time:q}),InsufficientFunds:e.Record({balance:e.Nat})}),x=e.Variant({Ok:S,Err:h}),v=e.Record({to:c,fee:e.Opt(M),spender_subaccount:e.Opt(d),from:c,memo:e.Opt(e.Vec(e.Nat8)),created_at_time:e.Opt(q),amount:M}),U=e.Variant({GenericError:e.Record({message:e.Text,error_code:e.Nat}),TemporarilyUnavailable:e.Null,InsufficientAllowance:e.Record({allowance:M}),BadBurn:e.Record({min_burn_amount:M}),Duplicate:e.Record({duplicate_of:S}),BadFee:e.Record({expected_fee:M}),CreatedInFuture:e.Record({ledger_time:q}),TooOld:e.Null,InsufficientFunds:e.Record({balance:M})}),p=e.Variant({Ok:S,Err:U}),a=e.Record({from:e.Opt(e.Principal)}),u=e.Vec(e.Record({end:e.Nat,canister_id:e.Principal,start:e.Nat}));r.fill(e.Variant({Int:e.Int,Map:e.Vec(e.Tuple(e.Text,r)),Nat:e.Nat,Blob:e.Vec(e.Nat8),Text:e.Text,Array:e.Vec(r)})),t.fill(e.Record({log_length:e.Nat,blocks:e.Vec(e.Record({id:e.Nat,block:r})),archived_blocks:e.Vec(e.Record({args:e.Vec(b),callback:e.Func([e.Vec(b)],[t],[])}))}));let g=e.Record({certificate:e.Vec(e.Nat8),hash_tree:e.Vec(e.Nat8)});return e.Service({archives:e.Func([],[e.Vec(N)],[]),get_blocks:e.Func([b],[$],[]),get_data_certificate:e.Func([],[ie],[]),get_transactions:e.Func([Z],[z],[]),icrc10_supported_standards:e.Func([],[e.Vec(e.Record({url:e.Text,name:e.Text}))],[]),icrc1_balance_of:e.Func([c],[M],[]),icrc1_decimals:e.Func([],[e.Nat8],[]),icrc1_fee:e.Func([],[M],[]),icrc1_metadata:e.Func([],[e.Vec(e.Tuple(e.Text,o))],[]),icrc1_minting_account:e.Func([],[e.Opt(c)],[]),icrc1_name:e.Func([],[e.Text],[]),icrc1_supported_standards:e.Func([],[e.Vec(G)],[]),icrc1_symbol:e.Func([],[e.Text],[]),icrc1_total_supply:e.Func([],[M],[]),icrc1_transfer:e.Func([J],[ge],[]),icrc21_canister_call_consent_message:e.Func([te],[ne],[]),icrc2_allowance:e.Func([ce],[m],[]),icrc2_approve:e.Func([s],[x],[]),icrc2_transfer_from:e.Func([v],[p],[]),icrc3_get_archives:e.Func([a],[u],[]),icrc3_get_blocks:e.Func([e.Vec(b)],[t],[]),icrc3_get_tip_certificate:e.Func([],[e.Opt(g)],[]),icrc3_supported_block_types:e.Func([],[e.Vec(e.Record({url:e.Text,block_type:e.Text}))],[]),is_ledger_ready:e.Func([],[e.Bool],[])})},n0=({IDL:e})=>{let t=e.Rec(),r=e.Rec(),n=e.Rec(),i=e.Record({num_blocks_to_archive:e.Opt(e.Nat64),max_transactions_per_response:e.Opt(e.Nat64),trigger_threshold:e.Opt(e.Nat64),more_controller_ids:e.Opt(e.Vec(e.Principal)),max_message_size_bytes:e.Opt(e.Nat64),cycles_for_archive_creation:e.Opt(e.Nat64),node_max_memory_size_bytes:e.Opt(e.Nat64),controller_id:e.Opt(e.Principal)}),o=e.Variant({Int:e.Int,Nat:e.Nat,Blob:e.Vec(e.Nat8),Text:e.Text}),d=e.Vec(e.Nat8),c=e.Record({owner:e.Principal,subaccount:e.Opt(d)}),w=e.Variant({SetTo:c,Unset:e.Null}),E=e.Record({icrc2:e.Bool}),A=e.Record({change_archive_options:e.Opt(i),token_symbol:e.Opt(e.Text),transfer_fee:e.Opt(e.Nat),metadata:e.Opt(e.Vec(e.Tuple(e.Text,o))),change_fee_collector:e.Opt(w),max_memo_length:e.Opt(e.Nat16),token_name:e.Opt(e.Text),feature_flags:e.Opt(E)}),I=e.Record({decimals:e.Opt(e.Nat8),token_symbol:e.Text,transfer_fee:e.Nat,metadata:e.Vec(e.Tuple(e.Text,o)),minting_account:c,initial_balances:e.Vec(e.Tuple(c,e.Nat)),fee_collector_account:e.Opt(c),archive_options:e.Record({num_blocks_to_archive:e.Nat64,max_transactions_per_response:e.Opt(e.Nat64),trigger_threshold:e.Nat64,more_controller_ids:e.Opt(e.Vec(e.Principal)),max_message_size_bytes:e.Opt(e.Nat64),cycles_for_archive_creation:e.Opt(e.Nat64),node_max_memory_size_bytes:e.Opt(e.Nat64),controller_id:e.Principal}),max_memo_length:e.Opt(e.Nat16),token_name:e.Text,feature_flags:e.Opt(E)});e.Variant({Upgrade:e.Opt(A),Init:I});let S=e.Nat,N=e.Record({block_range_end:S,canister_id:e.Principal,block_range_start:S}),b=e.Record({start:S,length:e.Nat}),j=e.Vec(e.Tuple(e.Text,n));n.fill(e.Variant({Int:e.Int,Map:j,Nat:e.Nat,Nat64:e.Nat64,Blob:e.Vec(e.Nat8),Text:e.Text,Array:e.Vec(n)}));let V=n,W=e.Record({blocks:e.Vec(V)}),K=e.Func([b],[W],["query"]),$=e.Record({certificate:e.Opt(e.Vec(e.Nat8)),first_index:S,blocks:e.Vec(V),chain_length:e.Nat64,archived_blocks:e.Vec(e.Record({callback:K,start:S,length:e.Nat}))}),ie=e.Record({certificate:e.Opt(e.Vec(e.Nat8)),hash_tree:e.Vec(e.Nat8)}),C=e.Nat,Z=e.Record({start:C,length:e.Nat}),q=e.Nat64,Q=e.Record({from:c,memo:e.Opt(e.Vec(e.Nat8)),created_at_time:e.Opt(q),amount:e.Nat,spender:e.Opt(c)}),re=e.Record({to:c,memo:e.Opt(e.Vec(e.Nat8)),created_at_time:e.Opt(q),amount:e.Nat}),X=e.Record({fee:e.Opt(e.Nat),from:c,memo:e.Opt(e.Vec(e.Nat8)),created_at_time:e.Opt(q),amount:e.Nat,expected_allowance:e.Opt(e.Nat),expires_at:e.Opt(q),spender:c}),de=e.Record({to:c,fee:e.Opt(e.Nat),from:c,memo:e.Opt(e.Vec(e.Nat8)),created_at_time:e.Opt(q),amount:e.Nat,spender:e.Opt(c)}),fe=e.Record({burn:e.Opt(Q),kind:e.Text,mint:e.Opt(re),approve:e.Opt(X),timestamp:q,transfer:e.Opt(de)}),R=e.Record({transactions:e.Vec(fe)}),P=e.Func([Z],[R],["query"]),z=e.Record({first_index:C,log_length:e.Nat,transactions:e.Vec(fe),archived_transactions:e.Vec(e.Record({callback:P,start:C,length:e.Nat}))}),M=e.Nat,G=e.Record({url:e.Text,name:e.Text}),J=e.Record({to:c,fee:e.Opt(M),memo:e.Opt(e.Vec(e.Nat8)),from_subaccount:e.Opt(d),created_at_time:e.Opt(q),amount:M}),ee=e.Variant({GenericError:e.Record({message:e.Text,error_code:e.Nat}),TemporarilyUnavailable:e.Null,BadBurn:e.Record({min_burn_amount:M}),Duplicate:e.Record({duplicate_of:S}),BadFee:e.Record({expected_fee:M}),CreatedInFuture:e.Record({ledger_time:q}),TooOld:e.Null,InsufficientFunds:e.Record({balance:M})}),ge=e.Variant({Ok:S,Err:ee}),ae=e.Record({utc_offset_minutes:e.Opt(e.Int16),language:e.Text}),le=e.Record({metadata:ae,device_spec:e.Opt(e.Variant({GenericDisplay:e.Null,LineDisplay:e.Record({characters_per_line:e.Nat16,lines_per_page:e.Nat16})}))}),te=e.Record({arg:e.Vec(e.Nat8),method:e.Text,user_preferences:le}),_=e.Variant({LineDisplayMessage:e.Record({pages:e.Vec(e.Record({lines:e.Vec(e.Text)}))}),GenericDisplayMessage:e.Text}),se=e.Record({metadata:ae,consent_message:_}),ue=e.Record({description:e.Text}),he=e.Variant({GenericError:e.Record({description:e.Text,error_code:e.Nat}),InsufficientPayment:ue,UnsupportedCanisterCall:ue,ConsentMessageUnavailable:ue}),ne=e.Variant({Ok:se,Err:he}),ce=e.Record({account:c,spender:c}),m=e.Record({allowance:e.Nat,expires_at:e.Opt(q)}),s=e.Record({fee:e.Opt(e.Nat),memo:e.Opt(e.Vec(e.Nat8)),from_subaccount:e.Opt(e.Vec(e.Nat8)),created_at_time:e.Opt(q),amount:e.Nat,expected_allowance:e.Opt(e.Nat),expires_at:e.Opt(q),spender:c}),h=e.Variant({GenericError:e.Record({message:e.Text,error_code:e.Nat}),TemporarilyUnavailable:e.Null,Duplicate:e.Record({duplicate_of:S}),BadFee:e.Record({expected_fee:e.Nat}),AllowanceChanged:e.Record({current_allowance:e.Nat}),CreatedInFuture:e.Record({ledger_time:q}),TooOld:e.Null,Expired:e.Record({ledger_time:q}),InsufficientFunds:e.Record({balance:e.Nat})}),x=e.Variant({Ok:S,Err:h}),v=e.Record({to:c,fee:e.Opt(M),spender_subaccount:e.Opt(d),from:c,memo:e.Opt(e.Vec(e.Nat8)),created_at_time:e.Opt(q),amount:M}),U=e.Variant({GenericError:e.Record({message:e.Text,error_code:e.Nat}),TemporarilyUnavailable:e.Null,InsufficientAllowance:e.Record({allowance:M}),BadBurn:e.Record({min_burn_amount:M}),Duplicate:e.Record({duplicate_of:S}),BadFee:e.Record({expected_fee:M}),CreatedInFuture:e.Record({ledger_time:q}),TooOld:e.Null,InsufficientFunds:e.Record({balance:M})}),p=e.Variant({Ok:S,Err:U}),a=e.Record({from:e.Opt(e.Principal)}),u=e.Vec(e.Record({end:e.Nat,canister_id:e.Principal,start:e.Nat}));r.fill(e.Variant({Int:e.Int,Map:e.Vec(e.Tuple(e.Text,r)),Nat:e.Nat,Blob:e.Vec(e.Nat8),Text:e.Text,Array:e.Vec(r)})),t.fill(e.Record({log_length:e.Nat,blocks:e.Vec(e.Record({id:e.Nat,block:r})),archived_blocks:e.Vec(e.Record({args:e.Vec(b),callback:e.Func([e.Vec(b)],[t],["query"])}))}));let g=e.Record({certificate:e.Vec(e.Nat8),hash_tree:e.Vec(e.Nat8)});return e.Service({archives:e.Func([],[e.Vec(N)],["query"]),get_blocks:e.Func([b],[$],["query"]),get_data_certificate:e.Func([],[ie],["query"]),get_transactions:e.Func([Z],[z],["query"]),icrc10_supported_standards:e.Func([],[e.Vec(e.Record({url:e.Text,name:e.Text}))],["query"]),icrc1_balance_of:e.Func([c],[M],["query"]),icrc1_decimals:e.Func([],[e.Nat8],["query"]),icrc1_fee:e.Func([],[M],["query"]),icrc1_metadata:e.Func([],[e.Vec(e.Tuple(e.Text,o))],["query"]),icrc1_minting_account:e.Func([],[e.Opt(c)],["query"]),icrc1_name:e.Func([],[e.Text],["query"]),icrc1_supported_standards:e.Func([],[e.Vec(G)],["query"]),icrc1_symbol:e.Func([],[e.Text],["query"]),icrc1_total_supply:e.Func([],[M],["query"]),icrc1_transfer:e.Func([J],[ge],[]),icrc21_canister_call_consent_message:e.Func([te],[ne],[]),icrc2_allowance:e.Func([ce],[m],["query"]),icrc2_approve:e.Func([s],[x],[]),icrc2_transfer_from:e.Func([v],[p],[]),icrc3_get_archives:e.Func([a],[u],["query"]),icrc3_get_blocks:e.Func([e.Vec(b)],[t],["query"]),icrc3_get_tip_certificate:e.Func([],[e.Opt(g)],["query"]),icrc3_supported_block_types:e.Func([],[e.Vec(e.Record({url:e.Text,block_type:e.Text}))],["query"]),is_ledger_ready:e.Func([],[e.Bool],["query"])})},i0=({from_subaccount:e,fee:t,created_at_time:r,memo:n,...i})=>({...i,fee:Xe(t),memo:Xe(n),from_subaccount:Xe(e),created_at_time:Xe(r)}),s0=({spender_subaccount:e,fee:t,created_at_time:r,memo:n,...i})=>({...i,fee:Xe(t),memo:Xe(n),spender_subaccount:Xe(e),created_at_time:Xe(r)}),a0=({fee:e,created_at_time:t,memo:r,from_subaccount:n,expected_allowance:i,expires_at:o,...d})=>({...d,fee:Xe(e),memo:Xe(r),from_subaccount:Xe(n),created_at_time:Xe(t),expected_allowance:Xe(i),expires_at:Xe(o)}),o0=({userPreferences:{metadata:{utcOffsetMinutes:e,language:t},deriveSpec:r},...n})=>({...n,user_preferences:{metadata:{language:t,utc_offset_minutes:Xe(e)},device_spec:au(r)?Xe():Xe("GenericDisplay"in r?{GenericDisplay:null}:{LineDisplay:{characters_per_line:r.LineDisplay.charactersPerLine,lines_per_page:r.LineDisplay.linesPerPage}})}}),fs=class extends Error{constructor({msg:e,errorType:t}){super(e),this.errorType=t}},c0=class extends Error{constructor(e,t){super(),this.message=e,this.error_code=t}},ki=class extends Error{},u0=class extends ki{},f0=class extends ki{},l0=class extends ki{},d0=e=>"GenericError"in e?new c0(e.GenericError.description,e.GenericError.error_code):"InsufficientPayment"in e?new u0(e.InsufficientPayment.description):"UnsupportedCanisterCall"in e?new f0(e.UnsupportedCanisterCall.description):"ConsentMessageUnavailable"in e?new l0(e.ConsentMessageUnavailable.description):new ki(`Unknown error type ${JSON.stringify(e)}`),K0=class ou extends Qh{constructor(){super(...arguments),this.metadata=t=>this.caller(t).icrc1_metadata(),this.transactionFee=t=>this.caller(t).icrc1_fee(),this.balance=t=>this.caller({certified:t.certified}).icrc1_balance_of({owner:t.owner,subaccount:Xe(t.subaccount)}),this.transfer=async t=>{let r=await this.caller({certified:!0}).icrc1_transfer(i0(t));if("Err"in r)throw new fs({errorType:r.Err,msg:"Failed to transfer"});return r.Ok},this.totalTokensSupply=t=>this.caller(t).icrc1_total_supply(),this.transferFrom=async t=>{let r=await this.caller({certified:!0}).icrc2_transfer_from(s0(t));if("Err"in r)throw new fs({errorType:r.Err,msg:"Failed to transfer from"});return r.Ok},this.approve=async t=>{let r=await this.caller({certified:!0}).icrc2_approve(a0(t));if("Err"in r)throw new fs({errorType:r.Err,msg:"Failed to entitle the spender to transfer the amount"});return r.Ok},this.allowance=async t=>{let{certified:r,...n}=t;return this.caller({certified:r}).icrc2_allowance({...n})},this.consentMessage=async t=>{let{icrc21_canister_call_consent_message:r}=this.caller({certified:!0}),n=await r(o0(t));if("Err"in n)throw d0(n.Err);return n.Ok}}static create(t){let{service:r,certifiedService:n,canisterId:i}=t0({options:t,idlFactory:n0,certifiedIdlFactory:r0});return new ou(i,r,n)}},h0=(e=>(e.SYMBOL="icrc1:symbol",e.NAME="icrc1:name",e.DECIMALS="icrc1:decimals",e.FEE="icrc1:fee",e.LOGO="icrc1:logo",e))(h0||{}),p0={};const y0=Ru(pf);var ut={};Object.defineProperty(ut,"__esModule",{value:!0});ut.bufFromBufLike=ut.uint8ToBuf=ut.PipeArrayBuffer=ut.fromHexString=ut.toHexString=ut.concat=void 0;function g0(...e){const t=new Uint8Array(e.reduce((n,i)=>n+i.byteLength,0));let r=0;for(const n of e)t.set(new Uint8Array(n),r),r+=n.byteLength;return t}ut.concat=g0;function w0(e){return new Uint8Array(e).reduce((t,r)=>t+r.toString(16).padStart(2,"0"),"")}ut.toHexString=w0;function m0(e){var t;return new Uint8Array(((t=e.match(/.{1,2}/g))!==null&&t!==void 0?t:[]).map(r=>parseInt(r,16)))}ut.fromHexString=m0;class b0{constructor(t,r=t?.byteLength||0){this._buffer=xi(t||new ArrayBuffer(0)),this._view=new Uint8Array(this._buffer,0,r)}get buffer(){return xi(this._view.slice())}get byteLength(){return this._view.byteLength}read(t){const r=this._view.subarray(0,t);return this._view=this._view.subarray(t),r.slice().buffer}readUint8(){const t=this._view[0];return this._view=this._view.subarray(1),t}write(t){const r=new Uint8Array(t),n=this._view.byteLength;this._view.byteOffset+this._view.byteLength+r.byteLength>=this._buffer.byteLength?this.alloc(r.byteLength):this._view=new Uint8Array(this._buffer,this._view.byteOffset,this._view.byteLength+r.byteLength),this._view.set(r,n)}get end(){return this._view.byteLength===0}alloc(t){const r=new ArrayBuffer((this._buffer.byteLength+t)*1.2|0),n=new Uint8Array(r,0,this._view.byteLength+t);n.set(this._view),this._buffer=r,this._view=n}}ut.PipeArrayBuffer=b0;function ai(e){return new DataView(e.buffer,e.byteOffset,e.byteLength).buffer}ut.uint8ToBuf=ai;function xi(e){return e instanceof Uint8Array?ai(e):e instanceof ArrayBuffer?e:Array.isArray(e)?ai(new Uint8Array(e)):"buffer"in e?xi(e.buffer):ai(new Uint8Array(e))}ut.bufFromBufLike=xi;var Ci={};Object.defineProperty(Ci,"__esModule",{value:!0});Ci.idlLabelToId=void 0;function _0(e){const r=new TextEncoder().encode(e);let n=0;for(const i of r)n=(n*223+i)%2**32;return n}function E0(e){if(/^_\d+_$/.test(e)||/^_0x[0-9a-fA-F]+_$/.test(e)){const t=+e.slice(1,-1);if(Number.isSafeInteger(t)&&t>=0&&t<2**32)return t}return _0(e)}Ci.idlLabelToId=E0;var Me={};Object.defineProperty(Me,"__esModule",{value:!0});Me.readIntLE=Me.readUIntLE=Me.writeIntLE=Me.writeUIntLE=Me.slebDecode=Me.slebEncode=Me.lebDecode=Me.lebEncode=Me.safeReadUint8=Me.safeRead=void 0;const ea=ut;function cu(){throw new Error("unexpected end of buffer")}function uu(e,t){return e.byteLength<t&&cu(),e.read(t)}Me.safeRead=uu;function Ti(e){const t=e.readUint8();return t===void 0&&cu(),t}Me.safeReadUint8=Ti;function x0(e){if(typeof e=="number"&&(e=BigInt(e)),e<BigInt(0))throw new Error("Cannot leb encode negative values.");const t=(e===BigInt(0)?0:Math.ceil(Math.log2(Number(e))))+1,r=new ea.PipeArrayBuffer(new ArrayBuffer(t),0);for(;;){const n=Number(e&BigInt(127));if(e/=BigInt(128),e===BigInt(0)){r.write(new Uint8Array([n]));break}else r.write(new Uint8Array([n|128]))}return r.buffer}Me.lebEncode=x0;function fu(e){let t=BigInt(1),r=BigInt(0),n;do n=Ti(e),r+=BigInt(n&127).valueOf()*t,t*=BigInt(128);while(n>=128);return r}Me.lebDecode=fu;function T0(e){typeof e=="number"&&(e=BigInt(e));const t=e<BigInt(0);t&&(e=-e-BigInt(1));const r=(e===BigInt(0)?0:Math.ceil(Math.log2(Number(e))))+1,n=new ea.PipeArrayBuffer(new ArrayBuffer(r),0);for(;;){const o=i(e);if(e/=BigInt(128),t&&e===BigInt(0)&&o&64||!t&&e===BigInt(0)&&!(o&64)){n.write(new Uint8Array([o]));break}else n.write(new Uint8Array([o|128]))}function i(o){const d=o%BigInt(128);return Number(t?BigInt(128)-d-BigInt(1):d)}return n.buffer}Me.slebEncode=T0;function v0(e){const t=new Uint8Array(e.buffer);let r=0;for(;r<t.byteLength;r++)if(t[r]<128){if(!(t[r]&64))return fu(e);break}const n=new Uint8Array(uu(e,r+1));let i=BigInt(0);for(let o=n.byteLength-1;o>=0;o--)i=i*BigInt(128)+BigInt(128-(n[o]&127)-1);return-i-BigInt(1)}Me.slebDecode=v0;function B0(e,t){if(BigInt(e)<BigInt(0))throw new Error("Cannot write negative values.");return lu(e,t)}Me.writeUIntLE=B0;function lu(e,t){e=BigInt(e);const r=new ea.PipeArrayBuffer(new ArrayBuffer(Math.min(1,t)),0);let n=0,i=BigInt(256),o=BigInt(0),d=Number(e%i);for(r.write(new Uint8Array([d]));++n<t;)e<0&&o===BigInt(0)&&d!==0&&(o=BigInt(1)),d=Number((e/i-o)%BigInt(256)),r.write(new Uint8Array([d])),i*=BigInt(256);return r.buffer}Me.writeIntLE=lu;function du(e,t){let r=BigInt(Ti(e)),n=BigInt(1),i=0;for(;++i<t;){n*=BigInt(256);const o=BigInt(Ti(e));r=r+n*o}return r}Me.readUIntLE=du;function A0(e,t){let r=du(e,t);const n=BigInt(2)**(BigInt(8)*BigInt(t-1)+BigInt(7));return r>=n&&(r-=n*BigInt(2)),r}Me.readIntLE=A0;var Hr={};Object.defineProperty(Hr,"__esModule",{value:!0});Hr.iexp2=Hr.ilog2=void 0;function N0(e){const t=BigInt(e);if(e<=0)throw new RangeError("Input must be positive");return t.toString(2).length-1}Hr.ilog2=N0;function S0(e){const t=BigInt(e);if(e<0)throw new RangeError("Input must be non-negative");return BigInt(1)<<t}Hr.iexp2=S0;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Variant=e.Record=e.Opt=e.Vec=e.Tuple=e.Principal=e.Nat64=e.Nat32=e.Nat16=e.Nat8=e.Int64=e.Int32=e.Int16=e.Int8=e.Float64=e.Float32=e.Nat=e.Int=e.Text=e.Null=e.Bool=e.Unknown=e.Reserved=e.Empty=e.decode=e.encode=e.ServiceClass=e.FuncClass=e.PrincipalClass=e.RecClass=e.VariantClass=e.TupleClass=e.RecordClass=e.OptClass=e.VecClass=e.FixedNatClass=e.FixedIntClass=e.FloatClass=e.NatClass=e.IntClass=e.TextClass=e.ReservedClass=e.NullClass=e.BoolClass=e.UnknownClass=e.EmptyClass=e.ConstructType=e.PrimitiveType=e.Type=e.Visitor=void 0,e.Service=e.Func=e.Rec=void 0;const t=y0,r=ut,n=Ci,i=Me,o=Hr,d="DIDL",c=400;function w(m,s,h){return m.map((x,v)=>h(x,s[v]))}class E{constructor(){this._typs=[],this._idx=new Map}has(s){return this._idx.has(s.name)}add(s,h){const x=this._typs.length;this._idx.set(s.name,x),this._typs.push(h)}merge(s,h){const x=this._idx.get(s.name),v=this._idx.get(h);if(x===void 0)throw new Error("Missing type index for "+s);if(v===void 0)throw new Error("Missing type index for "+h);this._typs[x]=this._typs[v],this._typs.splice(v,1),this._idx.delete(h)}encode(){const s=(0,i.lebEncode)(this._typs.length),h=(0,r.concat)(...this._typs);return(0,r.concat)(s,h)}indexOf(s){if(!this._idx.has(s))throw new Error("Missing type index for "+s);return(0,i.slebEncode)(this._idx.get(s)||0)}}class A{visitType(s,h){throw new Error("Not implemented")}visitPrimitive(s,h){return this.visitType(s,h)}visitEmpty(s,h){return this.visitPrimitive(s,h)}visitBool(s,h){return this.visitPrimitive(s,h)}visitNull(s,h){return this.visitPrimitive(s,h)}visitReserved(s,h){return this.visitPrimitive(s,h)}visitText(s,h){return this.visitPrimitive(s,h)}visitNumber(s,h){return this.visitPrimitive(s,h)}visitInt(s,h){return this.visitNumber(s,h)}visitNat(s,h){return this.visitNumber(s,h)}visitFloat(s,h){return this.visitPrimitive(s,h)}visitFixedInt(s,h){return this.visitNumber(s,h)}visitFixedNat(s,h){return this.visitNumber(s,h)}visitPrincipal(s,h){return this.visitPrimitive(s,h)}visitConstruct(s,h){return this.visitType(s,h)}visitVec(s,h,x){return this.visitConstruct(s,x)}visitOpt(s,h,x){return this.visitConstruct(s,x)}visitRecord(s,h,x){return this.visitConstruct(s,x)}visitTuple(s,h,x){const v=h.map((U,p)=>[`_${p}_`,U]);return this.visitRecord(s,v,x)}visitVariant(s,h,x){return this.visitConstruct(s,x)}visitRec(s,h,x){return this.visitConstruct(h,x)}visitFunc(s,h){return this.visitConstruct(s,h)}visitService(s,h){return this.visitConstruct(s,h)}}e.Visitor=A;class I{display(){return this.name}valueToString(s){return ee(s)}buildTypeTable(s){s.has(this)||this._buildTypeTableImpl(s)}}e.Type=I;class S extends I{checkType(s){if(this.name!==s.name)throw new Error(`type mismatch: type on the wire ${s.name}, expect type ${this.name}`);return s}_buildTypeTableImpl(s){}}e.PrimitiveType=S;class N extends I{checkType(s){if(s instanceof P){const h=s.getType();if(typeof h>"u")throw new Error("type mismatch with uninitialized type");return h}throw new Error(`type mismatch: type on the wire ${s.name}, expect type ${this.name}`)}encodeType(s){return s.indexOf(this.name)}}e.ConstructType=N;class b extends S{accept(s,h){return s.visitEmpty(this,h)}covariant(s){throw new Error(`Invalid ${this.display()} argument: ${ee(s)}`)}encodeValue(){throw new Error("Empty cannot appear as a function argument")}valueToString(){throw new Error("Empty cannot appear as a value")}encodeType(){return(0,i.slebEncode)(-17)}decodeValue(){throw new Error("Empty cannot appear as an output")}get name(){return"empty"}}e.EmptyClass=b;class j extends I{checkType(s){throw new Error("Method not implemented for unknown.")}accept(s,h){throw s.visitType(this,h)}covariant(s){throw new Error(`Invalid ${this.display()} argument: ${ee(s)}`)}encodeValue(){throw new Error("Unknown cannot appear as a function argument")}valueToString(){throw new Error("Unknown cannot appear as a value")}encodeType(){throw new Error("Unknown cannot be serialized")}decodeValue(s,h){let x=h.decodeValue(s,h);Object(x)!==x&&(x=Object(x));let v;return h instanceof P?v=()=>h.getType():v=()=>h,Object.defineProperty(x,"type",{value:v,writable:!0,enumerable:!1,configurable:!0}),x}_buildTypeTableImpl(){throw new Error("Unknown cannot be serialized")}get name(){return"Unknown"}}e.UnknownClass=j;class V extends S{accept(s,h){return s.visitBool(this,h)}covariant(s){if(typeof s=="boolean")return!0;throw new Error(`Invalid ${this.display()} argument: ${ee(s)}`)}encodeValue(s){return new Uint8Array([s?1:0])}encodeType(){return(0,i.slebEncode)(-2)}decodeValue(s,h){switch(this.checkType(h),(0,i.safeReadUint8)(s)){case 0:return!1;case 1:return!0;default:throw new Error("Boolean value out of range")}}get name(){return"bool"}}e.BoolClass=V;class W extends S{accept(s,h){return s.visitNull(this,h)}covariant(s){if(s===null)return!0;throw new Error(`Invalid ${this.display()} argument: ${ee(s)}`)}encodeValue(){return new ArrayBuffer(0)}encodeType(){return(0,i.slebEncode)(-1)}decodeValue(s,h){return this.checkType(h),null}get name(){return"null"}}e.NullClass=W;class K extends S{accept(s,h){return s.visitReserved(this,h)}covariant(s){return!0}encodeValue(){return new ArrayBuffer(0)}encodeType(){return(0,i.slebEncode)(-16)}decodeValue(s,h){return h.name!==this.name&&h.decodeValue(s,h),null}get name(){return"reserved"}}e.ReservedClass=K;class $ extends S{accept(s,h){return s.visitText(this,h)}covariant(s){if(typeof s=="string")return!0;throw new Error(`Invalid ${this.display()} argument: ${ee(s)}`)}encodeValue(s){const h=new TextEncoder().encode(s),x=(0,i.lebEncode)(h.byteLength);return(0,r.concat)(x,h)}encodeType(){return(0,i.slebEncode)(-15)}decodeValue(s,h){this.checkType(h);const x=(0,i.lebDecode)(s),v=(0,i.safeRead)(s,Number(x));return new TextDecoder("utf8",{fatal:!0}).decode(v)}get name(){return"text"}valueToString(s){return'"'+s+'"'}}e.TextClass=$;class ie extends S{accept(s,h){return s.visitInt(this,h)}covariant(s){if(typeof s=="bigint"||Number.isInteger(s))return!0;throw new Error(`Invalid ${this.display()} argument: ${ee(s)}`)}encodeValue(s){return(0,i.slebEncode)(s)}encodeType(){return(0,i.slebEncode)(-4)}decodeValue(s,h){return this.checkType(h),(0,i.slebDecode)(s)}get name(){return"int"}valueToString(s){return s.toString()}}e.IntClass=ie;class C extends S{accept(s,h){return s.visitNat(this,h)}covariant(s){if(typeof s=="bigint"&&s>=BigInt(0)||Number.isInteger(s)&&s>=0)return!0;throw new Error(`Invalid ${this.display()} argument: ${ee(s)}`)}encodeValue(s){return(0,i.lebEncode)(s)}encodeType(){return(0,i.slebEncode)(-3)}decodeValue(s,h){return this.checkType(h),(0,i.lebDecode)(s)}get name(){return"nat"}valueToString(s){return s.toString()}}e.NatClass=C;class Z extends S{constructor(s){if(super(),this._bits=s,s!==32&&s!==64)throw new Error("not a valid float type")}accept(s,h){return s.visitFloat(this,h)}covariant(s){if(typeof s=="number"||s instanceof Number)return!0;throw new Error(`Invalid ${this.display()} argument: ${ee(s)}`)}encodeValue(s){const h=new ArrayBuffer(this._bits/8),x=new DataView(h);return this._bits===32?x.setFloat32(0,s,!0):x.setFloat64(0,s,!0),h}encodeType(){const s=this._bits===32?-13:-14;return(0,i.slebEncode)(s)}decodeValue(s,h){this.checkType(h);const x=(0,i.safeRead)(s,this._bits/8),v=new DataView(x);return this._bits===32?v.getFloat32(0,!0):v.getFloat64(0,!0)}get name(){return"float"+this._bits}valueToString(s){return s.toString()}}e.FloatClass=Z;class q extends S{constructor(s){super(),this._bits=s}accept(s,h){return s.visitFixedInt(this,h)}covariant(s){const h=(0,o.iexp2)(this._bits-1)*BigInt(-1),x=(0,o.iexp2)(this._bits-1)-BigInt(1);let v=!1;if(typeof s=="bigint")v=s>=h&&s<=x;else if(Number.isInteger(s)){const U=BigInt(s);v=U>=h&&U<=x}else v=!1;if(v)return!0;throw new Error(`Invalid ${this.display()} argument: ${ee(s)}`)}encodeValue(s){return(0,i.writeIntLE)(s,this._bits/8)}encodeType(){const s=Math.log2(this._bits)-3;return(0,i.slebEncode)(-9-s)}decodeValue(s,h){this.checkType(h);const x=(0,i.readIntLE)(s,this._bits/8);return this._bits<=32?Number(x):x}get name(){return`int${this._bits}`}valueToString(s){return s.toString()}}e.FixedIntClass=q;class Q extends S{constructor(s){super(),this._bits=s}accept(s,h){return s.visitFixedNat(this,h)}covariant(s){const h=(0,o.iexp2)(this._bits);let x=!1;if(typeof s=="bigint"&&s>=BigInt(0)?x=s<h:Number.isInteger(s)&&s>=0?x=BigInt(s)<h:x=!1,x)return!0;throw new Error(`Invalid ${this.display()} argument: ${ee(s)}`)}encodeValue(s){return(0,i.writeUIntLE)(s,this._bits/8)}encodeType(){const s=Math.log2(this._bits)-3;return(0,i.slebEncode)(-5-s)}decodeValue(s,h){this.checkType(h);const x=(0,i.readUIntLE)(s,this._bits/8);return this._bits<=32?Number(x):x}get name(){return`nat${this._bits}`}valueToString(s){return s.toString()}}e.FixedNatClass=Q;class re extends N{constructor(s){super(),this._type=s,this._blobOptimization=!1,s instanceof Q&&s._bits===8&&(this._blobOptimization=!0)}accept(s,h){return s.visitVec(this,this._type,h)}covariant(s){const h=this._type instanceof Q?this._type._bits:this._type instanceof q?this._type._bits:0;if(ArrayBuffer.isView(s)&&h==s.BYTES_PER_ELEMENT*8||Array.isArray(s)&&s.every((x,v)=>{try{return this._type.covariant(x)}catch(U){throw new Error(`Invalid ${this.display()} argument: 

index ${v} -> ${U.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${ee(s)}`)}encodeValue(s){const h=(0,i.lebEncode)(s.length);if(this._blobOptimization)return(0,r.concat)(h,new Uint8Array(s));if(ArrayBuffer.isView(s))return(0,r.concat)(h,new Uint8Array(s.buffer));const x=new r.PipeArrayBuffer(new ArrayBuffer(h.byteLength+s.length),0);x.write(h);for(const v of s){const U=this._type.encodeValue(v);x.write(new Uint8Array(U))}return x.buffer}_buildTypeTableImpl(s){this._type.buildTypeTable(s);const h=(0,i.slebEncode)(-19),x=this._type.encodeType(s);s.add(this,(0,r.concat)(h,x))}decodeValue(s,h){const x=this.checkType(h);if(!(x instanceof re))throw new Error("Not a vector type");const v=Number((0,i.lebDecode)(s));if(this._type instanceof Q){if(this._type._bits==8)return new Uint8Array(s.read(v));if(this._type._bits==16)return new Uint16Array(s.read(v*2));if(this._type._bits==32)return new Uint32Array(s.read(v*4));if(this._type._bits==64)return new BigUint64Array(s.read(v*8))}if(this._type instanceof q){if(this._type._bits==8)return new Int8Array(s.read(v));if(this._type._bits==16)return new Int16Array(s.read(v*2));if(this._type._bits==32)return new Int32Array(s.read(v*4));if(this._type._bits==64)return new BigInt64Array(s.read(v*8))}const U=[];for(let p=0;p<v;p++)U.push(this._type.decodeValue(s,x._type));return U}get name(){return`vec ${this._type.name}`}display(){return`vec ${this._type.display()}`}valueToString(s){return"vec {"+s.map(x=>this._type.valueToString(x)).join("; ")+"}"}}e.VecClass=re;class X extends N{constructor(s){super(),this._type=s}accept(s,h){return s.visitOpt(this,this._type,h)}covariant(s){try{if(Array.isArray(s)&&(s.length===0||s.length===1&&this._type.covariant(s[0])))return!0}catch(h){throw new Error(`Invalid ${this.display()} argument: ${ee(s)} 

-> ${h.message}`)}throw new Error(`Invalid ${this.display()} argument: ${ee(s)}`)}encodeValue(s){return s.length===0?new Uint8Array([0]):(0,r.concat)(new Uint8Array([1]),this._type.encodeValue(s[0]))}_buildTypeTableImpl(s){this._type.buildTypeTable(s);const h=(0,i.slebEncode)(-18),x=this._type.encodeType(s);s.add(this,(0,r.concat)(h,x))}decodeValue(s,h){const x=this.checkType(h);if(!(x instanceof X))throw new Error("Not an option type");switch((0,i.safeReadUint8)(s)){case 0:return[];case 1:return[this._type.decodeValue(s,x._type)];default:throw new Error("Not an option value")}}get name(){return`opt ${this._type.name}`}display(){return`opt ${this._type.display()}`}valueToString(s){return s.length===0?"null":`opt ${this._type.valueToString(s[0])}`}}e.OptClass=X;class de extends N{constructor(s={}){super(),this._fields=Object.entries(s).sort((h,x)=>(0,n.idlLabelToId)(h[0])-(0,n.idlLabelToId)(x[0]))}accept(s,h){return s.visitRecord(this,this._fields,h)}tryAsTuple(){const s=[];for(let h=0;h<this._fields.length;h++){const[x,v]=this._fields[h];if(x!==`_${h}_`)return null;s.push(v)}return s}covariant(s){if(typeof s=="object"&&this._fields.every(([h,x])=>{if(!s.hasOwnProperty(h))throw new Error(`Record is missing key "${h}".`);try{return x.covariant(s[h])}catch(v){throw new Error(`Invalid ${this.display()} argument: 

field ${h} -> ${v.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${ee(s)}`)}encodeValue(s){const h=this._fields.map(([v])=>s[v]),x=w(this._fields,h,([,v],U)=>v.encodeValue(U));return(0,r.concat)(...x)}_buildTypeTableImpl(s){this._fields.forEach(([U,p])=>p.buildTypeTable(s));const h=(0,i.slebEncode)(-20),x=(0,i.lebEncode)(this._fields.length),v=this._fields.map(([U,p])=>(0,r.concat)((0,i.lebEncode)((0,n.idlLabelToId)(U)),p.encodeType(s)));s.add(this,(0,r.concat)(h,x,(0,r.concat)(...v)))}decodeValue(s,h){const x=this.checkType(h);if(!(x instanceof de))throw new Error("Not a record type");const v={};let U=0,p=0;for(;p<x._fields.length;){const[a,u]=x._fields[p];if(U>=this._fields.length){u.decodeValue(s,u),p++;continue}const[g,T]=this._fields[U],O=(0,n.idlLabelToId)(this._fields[U][0]),L=(0,n.idlLabelToId)(a);if(O===L)v[g]=T.decodeValue(s,u),U++,p++;else if(L>O)if(T instanceof X||T instanceof K)v[g]=[],U++;else throw new Error("Cannot find required field "+g);else u.decodeValue(s,u),p++}for(const[a,u]of this._fields.slice(U))if(u instanceof X||u instanceof K)v[a]=[];else throw new Error("Cannot find required field "+a);return v}get name(){return`record {${this._fields.map(([h,x])=>h+":"+x.name).join("; ")}}`}display(){return`record {${this._fields.map(([h,x])=>h+":"+x.display()).join("; ")}}`}valueToString(s){const h=this._fields.map(([v])=>s[v]);return`record {${w(this._fields,h,([v,U],p)=>v+"="+U.valueToString(p)).join("; ")}}`}}e.RecordClass=de;class fe extends de{constructor(s){const h={};s.forEach((x,v)=>h["_"+v+"_"]=x),super(h),this._components=s}accept(s,h){return s.visitTuple(this,this._components,h)}covariant(s){if(Array.isArray(s)&&s.length>=this._fields.length&&this._components.every((h,x)=>{try{return h.covariant(s[x])}catch(v){throw new Error(`Invalid ${this.display()} argument: 

index ${x} -> ${v.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${ee(s)}`)}encodeValue(s){const h=w(this._components,s,(x,v)=>x.encodeValue(v));return(0,r.concat)(...h)}decodeValue(s,h){const x=this.checkType(h);if(!(x instanceof fe))throw new Error("not a tuple type");if(x._components.length<this._components.length)throw new Error("tuple mismatch");const v=[];for(const[U,p]of x._components.entries())U>=this._components.length?p.decodeValue(s,p):v.push(this._components[U].decodeValue(s,p));return v}display(){return`record {${this._components.map(h=>h.display()).join("; ")}}`}valueToString(s){return`record {${w(this._components,s,(x,v)=>x.valueToString(v)).join("; ")}}`}}e.TupleClass=fe;class R extends N{constructor(s={}){super(),this._fields=Object.entries(s).sort((h,x)=>(0,n.idlLabelToId)(h[0])-(0,n.idlLabelToId)(x[0]))}accept(s,h){return s.visitVariant(this,this._fields,h)}covariant(s){if(typeof s=="object"&&Object.entries(s).length===1&&this._fields.every(([h,x])=>{try{return!s.hasOwnProperty(h)||x.covariant(s[h])}catch(v){throw new Error(`Invalid ${this.display()} argument: 

variant ${h} -> ${v.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${ee(s)}`)}encodeValue(s){for(let h=0;h<this._fields.length;h++){const[x,v]=this._fields[h];if(s.hasOwnProperty(x)){const U=(0,i.lebEncode)(h),p=v.encodeValue(s[x]);return(0,r.concat)(U,p)}}throw Error("Variant has no data: "+s)}_buildTypeTableImpl(s){this._fields.forEach(([,U])=>{U.buildTypeTable(s)});const h=(0,i.slebEncode)(-21),x=(0,i.lebEncode)(this._fields.length),v=this._fields.map(([U,p])=>(0,r.concat)((0,i.lebEncode)((0,n.idlLabelToId)(U)),p.encodeType(s)));s.add(this,(0,r.concat)(h,x,...v))}decodeValue(s,h){const x=this.checkType(h);if(!(x instanceof R))throw new Error("Not a variant type");const v=Number((0,i.lebDecode)(s));if(v>=x._fields.length)throw Error("Invalid variant index: "+v);const[U,p]=x._fields[v];for(const[a,u]of this._fields)if((0,n.idlLabelToId)(U)===(0,n.idlLabelToId)(a)){const g=u.decodeValue(s,p);return{[a]:g}}throw new Error("Cannot find field hash "+U)}get name(){return`variant {${this._fields.map(([h,x])=>h+":"+x.name).join("; ")}}`}display(){return`variant {${this._fields.map(([h,x])=>h+(x.name==="null"?"":`:${x.display()}`)).join("; ")}}`}valueToString(s){for(const[h,x]of this._fields)if(s.hasOwnProperty(h)){const v=x.valueToString(s[h]);return v==="null"?`variant {${h}}`:`variant {${h}=${v}}`}throw new Error("Variant has no data: "+s)}}e.VariantClass=R;class P extends N{constructor(){super(...arguments),this._id=P._counter++,this._type=void 0}accept(s,h){if(!this._type)throw Error("Recursive type uninitialized.");return s.visitRec(this,this._type,h)}fill(s){this._type=s}getType(){return this._type}covariant(s){if(this._type&&this._type.covariant(s))return!0;throw new Error(`Invalid ${this.display()} argument: ${ee(s)}`)}encodeValue(s){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.encodeValue(s)}_buildTypeTableImpl(s){if(!this._type)throw Error("Recursive type uninitialized.");s.add(this,new Uint8Array([])),this._type.buildTypeTable(s),s.merge(this,this._type.name)}decodeValue(s,h){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.decodeValue(s,h)}get name(){return`rec_${this._id}`}display(){if(!this._type)throw Error("Recursive type uninitialized.");return`${this.name}.${this._type.name}`}valueToString(s){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.valueToString(s)}}e.RecClass=P,P._counter=0;function z(m){if((0,i.safeReadUint8)(m)!==1)throw new Error("Cannot decode principal");const h=Number((0,i.lebDecode)(m));return t.Principal.fromUint8Array(new Uint8Array((0,i.safeRead)(m,h)))}class M extends S{accept(s,h){return s.visitPrincipal(this,h)}covariant(s){if(s&&s._isPrincipal)return!0;throw new Error(`Invalid ${this.display()} argument: ${ee(s)}`)}encodeValue(s){const h=s.toUint8Array(),x=(0,i.lebEncode)(h.byteLength);return(0,r.concat)(new Uint8Array([1]),x,h)}encodeType(){return(0,i.slebEncode)(-24)}decodeValue(s,h){return this.checkType(h),z(s)}get name(){return"principal"}valueToString(s){return`${this.name} "${s.toText()}"`}}e.PrincipalClass=M;class G extends N{constructor(s,h,x=[]){super(),this.argTypes=s,this.retTypes=h,this.annotations=x}static argsToString(s,h){if(s.length!==h.length)throw new Error("arity mismatch");return"("+s.map((x,v)=>x.valueToString(h[v])).join(", ")+")"}accept(s,h){return s.visitFunc(this,h)}covariant(s){if(Array.isArray(s)&&s.length===2&&s[0]&&s[0]._isPrincipal&&typeof s[1]=="string")return!0;throw new Error(`Invalid ${this.display()} argument: ${ee(s)}`)}encodeValue([s,h]){const x=s.toUint8Array(),v=(0,i.lebEncode)(x.byteLength),U=(0,r.concat)(new Uint8Array([1]),v,x),p=new TextEncoder().encode(h),a=(0,i.lebEncode)(p.byteLength);return(0,r.concat)(new Uint8Array([1]),U,a,p)}_buildTypeTableImpl(s){this.argTypes.forEach(g=>g.buildTypeTable(s)),this.retTypes.forEach(g=>g.buildTypeTable(s));const h=(0,i.slebEncode)(-22),x=(0,i.lebEncode)(this.argTypes.length),v=(0,r.concat)(...this.argTypes.map(g=>g.encodeType(s))),U=(0,i.lebEncode)(this.retTypes.length),p=(0,r.concat)(...this.retTypes.map(g=>g.encodeType(s))),a=(0,i.lebEncode)(this.annotations.length),u=(0,r.concat)(...this.annotations.map(g=>this.encodeAnnotation(g)));s.add(this,(0,r.concat)(h,x,v,U,p,a,u))}decodeValue(s){if((0,i.safeReadUint8)(s)!==1)throw new Error("Cannot decode function reference");const x=z(s),v=Number((0,i.lebDecode)(s)),U=(0,i.safeRead)(s,v),a=new TextDecoder("utf8",{fatal:!0}).decode(U);return[x,a]}get name(){const s=this.argTypes.map(v=>v.name).join(", "),h=this.retTypes.map(v=>v.name).join(", "),x=" "+this.annotations.join(" ");return`(${s}) -> (${h})${x}`}valueToString([s,h]){return`func "${s.toText()}".${h}`}display(){const s=this.argTypes.map(v=>v.display()).join(", "),h=this.retTypes.map(v=>v.display()).join(", "),x=" "+this.annotations.join(" ");return`(${s})  (${h})${x}`}encodeAnnotation(s){if(s==="query")return new Uint8Array([1]);if(s==="oneway")return new Uint8Array([2]);if(s==="composite_query")return new Uint8Array([3]);throw new Error("Illegal function annotation")}}e.FuncClass=G;class J extends N{constructor(s){super(),this._fields=Object.entries(s).sort((h,x)=>h[0]<x[0]?-1:h[0]>x[0]?1:0)}accept(s,h){return s.visitService(this,h)}covariant(s){if(s&&s._isPrincipal)return!0;throw new Error(`Invalid ${this.display()} argument: ${ee(s)}`)}encodeValue(s){const h=s.toUint8Array(),x=(0,i.lebEncode)(h.length);return(0,r.concat)(new Uint8Array([1]),x,h)}_buildTypeTableImpl(s){this._fields.forEach(([U,p])=>p.buildTypeTable(s));const h=(0,i.slebEncode)(-23),x=(0,i.lebEncode)(this._fields.length),v=this._fields.map(([U,p])=>{const a=new TextEncoder().encode(U),u=(0,i.lebEncode)(a.length);return(0,r.concat)(u,a,p.encodeType(s))});s.add(this,(0,r.concat)(h,x,...v))}decodeValue(s){return z(s)}get name(){return`service {${this._fields.map(([h,x])=>h+":"+x.name).join("; ")}}`}valueToString(s){return`service "${s.toText()}"`}}e.ServiceClass=J;function ee(m){const s=JSON.stringify(m,(h,x)=>typeof x=="bigint"?`BigInt(${x})`:x);return s&&s.length>c?s.substring(0,c-3)+"...":s}function ge(m,s){if(s.length<m.length)throw Error("Wrong number of message arguments");const h=new E;m.forEach(u=>u.buildTypeTable(h));const x=new TextEncoder().encode(d),v=h.encode(),U=(0,i.lebEncode)(s.length),p=(0,r.concat)(...m.map(u=>u.encodeType(h))),a=(0,r.concat)(...w(m,s,(u,g)=>{try{u.covariant(g)}catch(T){throw new Error(T.message+`

`)}return u.encodeValue(g)}));return(0,r.concat)(x,v,U,p,a)}e.encode=ge;function ae(m,s){const h=new r.PipeArrayBuffer(s);if(s.byteLength<d.length)throw new Error("Message length smaller than magic number");const x=(0,i.safeRead)(h,d.length),v=new TextDecoder().decode(x);if(v!==d)throw new Error("Wrong magic number: "+JSON.stringify(v));function U(Y){const oe=[],pe=Number((0,i.lebDecode)(Y));for(let f=0;f<pe;f++){const l=Number((0,i.slebDecode)(Y));switch(l){case-18:case-19:{const B=Number((0,i.slebDecode)(Y));oe.push([l,B]);break}case-20:case-21:{const B=[];let k=Number((0,i.lebDecode)(Y)),D;for(;k--;){const H=Number((0,i.lebDecode)(Y));if(H>=Math.pow(2,32))throw new Error("field id out of 32-bit range");if(typeof D=="number"&&D>=H)throw new Error("field id collision or not sorted");D=H;const _e=Number((0,i.slebDecode)(Y));B.push([H,_e])}oe.push([l,B]);break}case-22:{const B=[];let k=Number((0,i.lebDecode)(Y));for(;k--;)B.push(Number((0,i.slebDecode)(Y)));const D=[];let H=Number((0,i.lebDecode)(Y));for(;H--;)D.push(Number((0,i.slebDecode)(Y)));const _e=[];let Te=Number((0,i.lebDecode)(Y));for(;Te--;)switch(Number((0,i.lebDecode)(Y))){case 1:{_e.push("query");break}case 2:{_e.push("oneway");break}case 3:{_e.push("composite_query");break}default:throw new Error("unknown annotation")}oe.push([l,[B,D,_e]]);break}case-23:{let B=Number((0,i.lebDecode)(Y));const k=[];for(;B--;){const D=Number((0,i.lebDecode)(Y)),H=new TextDecoder().decode((0,i.safeRead)(Y,D)),_e=(0,i.slebDecode)(Y);k.push([H,_e])}oe.push([l,k]);break}default:throw new Error("Illegal op_code: "+l)}}const me=[],y=Number((0,i.lebDecode)(Y));for(let f=0;f<y;f++)me.push(Number((0,i.slebDecode)(Y)));return[oe,me]}const[p,a]=U(h);if(a.length<m.length)throw new Error("Wrong number of return values");const u=p.map(Y=>he());function g(Y){if(Y<-24)throw new Error("future value not supported");if(Y<0)switch(Y){case-1:return e.Null;case-2:return e.Bool;case-3:return e.Nat;case-4:return e.Int;case-5:return e.Nat8;case-6:return e.Nat16;case-7:return e.Nat32;case-8:return e.Nat64;case-9:return e.Int8;case-10:return e.Int16;case-11:return e.Int32;case-12:return e.Int64;case-13:return e.Float32;case-14:return e.Float64;case-15:return e.Text;case-16:return e.Reserved;case-17:return e.Empty;case-24:return e.Principal;default:throw new Error("Illegal op_code: "+Y)}if(Y>=p.length)throw new Error("type index out of range");return u[Y]}function T(Y){switch(Y[0]){case-19:{const oe=g(Y[1]);return te(oe)}case-18:{const oe=g(Y[1]);return _(oe)}case-20:{const oe={};for(const[y,f]of Y[1]){const l=`_${y}_`;oe[l]=g(f)}const pe=se(oe),me=pe.tryAsTuple();return Array.isArray(me)?le(...me):pe}case-21:{const oe={};for(const[pe,me]of Y[1]){const y=`_${pe}_`;oe[y]=g(me)}return ue(oe)}case-22:{const[oe,pe,me]=Y[1];return ne(oe.map(y=>g(y)),pe.map(y=>g(y)),me)}case-23:{const oe={},pe=Y[1];for(const[me,y]of pe){let f=g(y);if(f instanceof P&&(f=f.getType()),!(f instanceof G))throw new Error("Illegal service definition: services can only contain functions");oe[me]=f}return ce(oe)}default:throw new Error("Illegal op_code: "+Y[0])}}p.forEach((Y,oe)=>{if(Y[0]===-22){const pe=T(Y);u[oe].fill(pe)}}),p.forEach((Y,oe)=>{if(Y[0]!==-22){const pe=T(Y);u[oe].fill(pe)}});const O=a.map(Y=>g(Y)),L=m.map((Y,oe)=>Y.decodeValue(h,O[oe]));for(let Y=m.length;Y<O.length;Y++)O[Y].decodeValue(h,O[Y]);if(h.byteLength>0)throw new Error("decode: Left-over bytes");return L}e.decode=ae,e.Empty=new b,e.Reserved=new K,e.Unknown=new j,e.Bool=new V,e.Null=new W,e.Text=new $,e.Int=new ie,e.Nat=new C,e.Float32=new Z(32),e.Float64=new Z(64),e.Int8=new q(8),e.Int16=new q(16),e.Int32=new q(32),e.Int64=new q(64),e.Nat8=new Q(8),e.Nat16=new Q(16),e.Nat32=new Q(32),e.Nat64=new Q(64),e.Principal=new M;function le(...m){return new fe(m)}e.Tuple=le;function te(m){return new re(m)}e.Vec=te;function _(m){return new X(m)}e.Opt=_;function se(m){return new de(m)}e.Record=se;function ue(m){return new R(m)}e.Variant=ue;function he(){return new P}e.Rec=he;function ne(m,s,h=[]){return new G(m,s,h)}e.Func=ne;function ce(m){return new J(m)}e.Service=ce})(p0);export{H0 as A,V0 as D,$r as H,ve as P,D0 as Y,yn as a,au as b,$0 as c,K0 as f,p0 as i,j0 as u};
